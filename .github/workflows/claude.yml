name: Claude

on:
  pull_request:

jobs:
  claude-code-action:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    timeout-minutes: 10
    services:
      claude-code-proxy:
        image: ghcr.io/kiyo-e/claude-code-proxy:latest
        ports:
          - 3000:3000
        env:
          CLAUDE_CODE_PROXY_API_KEY: ${{ secrets.GITHUB_TOKEN }}
          REASONING_MODEL: openai/gpt-4o
          COMPLETION_MODEL: openai/gpt-4o
          DEBUG: "true"
    steps:
      - uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # v4.2.2

      - name: Install Claude Code
        run: |
          npm install -g @anthropic-ai/claude-code

      - name: Run Claude Code
        env:
          ANTHROPIC_BASE_URL: http://localhost:3000
          ANTHROPIC_AUTH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          claude -p "what is the capital of France?"
