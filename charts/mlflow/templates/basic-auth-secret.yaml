{{- /* 
When basic authentication is enabled and no existing secret is specified,
then a new secret will be created to hold the basic auth configutaion.
*/ -}}
{{- if .Values.trackingServer.basicAuth.enabled -}}
{{- if not .Values.trackingServer.basicAuth.existingSecret -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "mlflow.basicAuthSecretName" . }}
stringData:
  {{- with .Values.trackingServer.basicAuth.createSecret }}
  basic_auth.ini: |
    [mlflow]
    default_permission = {{ .defaultPermission }}
    database_uri = {{ .databaseUri }}
    admin_username = {{ .adminUsername }}
    admin_password = {{ .adminPassword }}
    authorization_function = {{ .authorizationFunction }}
  {{- end }}
{{- end }}
{{- end }}
