suite: Test basic auth secret

templates:
  - basic-auth-secret.yaml

tests:
  - it: Should contain `basic_auth.ini` if basic authentication is enabled and no existing secret is specified
    set:
      trackingServer:
        enabled: true
        basicAuth:
          enabled: true
          existingSecret: ""
          createSecret:
            defaultPermission: READ
            databaseUri: sqlite:///basic_auth.db
            adminUsername: admin
            adminPassword: password
            authorizationFunction: mlflow.server.auth:authenticate_request_basic_auth
    asserts:
      - equal:
          path: stringData["basic_auth.ini"]
          value: |
            [mlflow]
            default_permission = READ
            database_uri = sqlite:///basic_auth.db
            admin_username = admin
            admin_password = password
            authorization_function = mlflow.server.auth:authenticate_request_basic_auth
