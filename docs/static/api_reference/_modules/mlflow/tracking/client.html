

<!DOCTYPE html>
<!-- source: docs/source/_modules/mlflow/tracking/client -->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mlflow.tracking.client</title>
  
   
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="canonical" href="https://mlflow.org/docs/latest/_modules/mlflow/tracking/client.html">
  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    

    

  
    

  

  
  
    

  

  
  
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600" rel="stylesheet">
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/cards.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/grids.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/mobile.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/simple-cards.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/tabs.css" type="text/css" />
    
  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="MLflow 2.17.1.dev0 documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>
<script type="text/javascript" src="../../../_static/jquery.js"></script>
<script type="text/javascript" src="../../../_static/underscore.js"></script>
<script type="text/javascript" src="../../../_static/doctools.js"></script>
<script type="text/javascript" src="../../../_static/tabs.js"></script>
<script type="text/javascript" src="../../../_static/languagesections.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script type="text/javascript" src="../../../_static/runllm.js"></script>

<body class="wy-body-for-nav" role="document">
  

  
  <nav class="wy-nav-top header" role="navigation" aria-label="top navigation">
    <ul>
  <li class="menu-toggle">
    <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
    <a href="../../../index.html" class="wy-nav-top-logo"
      ><img src="../../../_static/MLflow-logo-final-black.png" alt="MLflow"
    /></a>
    <span class="version">2.17.1.dev0</span>
  </li>
</ul>
  </nav>
  <page>
    

    <nav data-toggle="wy-nav-shift" class="wy-nav-side relative">
      <div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
  </form>
</div>


    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../../index.html" class="main-navigation-home"><img src="../../../_static/icons/nav-home.svg"> MLflow</a>
    

    
      

      
        <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../python_api/index.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cli.html">Command-Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../R-api.html">R API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../java_api/index.html">Java API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rest-api.html">REST API</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    

    <p>
      <a id='feedbacklink' href="https://github.com/mlflow/mlflow/blob/master/CONTRIBUTING.md" target="_blank">Contribute</a>
    </p>
  </div>
</div>
    </nav>

    <main class="wy-grid-for-nav">
      <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
        <div class="wy-nav-content">
          <div class="rst-content">
            










<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
        <li><a href="../../index.html">Module code</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>mlflow.tracking.client</li>
    
    
    <!-- <li class="wy-breadcrumbs-aside">
      <a href="https://github.com/mlflow/mlflow/blob/master/docs/source/_modules/mlflow/tracking/client" class="fa fa-github"> Edit on GitHub</a>
    </li> -->
    
  </ul>
</div>
            <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
              <div itemprop="articleBody">
                
  <h1>Source code for mlflow.tracking.client</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Internal package providing a Python CRUD interface to MLflow experiments, runs, registered models,</span>
<span class="sd">and model versions. This is a lower level API than the :py:mod:`mlflow.tracking.fluent` module,</span>
<span class="sd">and is exposed in the :py:mod:`mlflow.tracking` module.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">contextlib</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">posixpath</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">yaml</span>

<span class="kn">import</span> <span class="nn">mlflow</span>
<span class="kn">from</span> <span class="nn">mlflow.entities</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DatasetInput</span><span class="p">,</span>
    <span class="n">Experiment</span><span class="p">,</span>
    <span class="n">FileInfo</span><span class="p">,</span>
    <span class="n">Metric</span><span class="p">,</span>
    <span class="n">Param</span><span class="p">,</span>
    <span class="n">Run</span><span class="p">,</span>
    <span class="n">RunTag</span><span class="p">,</span>
    <span class="n">Span</span><span class="p">,</span>
    <span class="n">SpanStatus</span><span class="p">,</span>
    <span class="n">SpanType</span><span class="p">,</span>
    <span class="n">Trace</span><span class="p">,</span>
    <span class="n">TraceData</span><span class="p">,</span>
    <span class="n">TraceInfo</span><span class="p">,</span>
    <span class="n">ViewType</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">mlflow.entities.model_registry</span> <span class="kn">import</span> <span class="n">ModelVersion</span><span class="p">,</span> <span class="n">RegisteredModel</span>
<span class="kn">from</span> <span class="nn">mlflow.entities.model_registry.model_version_stages</span> <span class="kn">import</span> <span class="n">ALL_STAGES</span>
<span class="kn">from</span> <span class="nn">mlflow.entities.span</span> <span class="kn">import</span> <span class="n">NO_OP_SPAN_REQUEST_ID</span><span class="p">,</span> <span class="n">NoOpSpan</span><span class="p">,</span> <span class="n">create_mlflow_span</span>
<span class="kn">from</span> <span class="nn">mlflow.entities.trace_status</span> <span class="kn">import</span> <span class="n">TraceStatus</span>
<span class="kn">from</span> <span class="nn">mlflow.environment_variables</span> <span class="kn">import</span> <span class="n">MLFLOW_ENABLE_ASYNC_LOGGING</span>
<span class="kn">from</span> <span class="nn">mlflow.exceptions</span> <span class="kn">import</span> <span class="n">MlflowException</span>
<span class="kn">from</span> <span class="nn">mlflow.protos.databricks_pb2</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BAD_REQUEST</span><span class="p">,</span>
    <span class="n">FEATURE_DISABLED</span><span class="p">,</span>
    <span class="n">INVALID_PARAMETER_VALUE</span><span class="p">,</span>
    <span class="n">RESOURCE_DOES_NOT_EXIST</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">mlflow.store.artifact.utils.models</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">get_model_name_and_version</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">mlflow.store.entities.paged_list</span> <span class="kn">import</span> <span class="n">PagedList</span>
<span class="kn">from</span> <span class="nn">mlflow.store.model_registry</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SEARCH_MODEL_VERSION_MAX_RESULTS_DEFAULT</span><span class="p">,</span>
    <span class="n">SEARCH_REGISTERED_MODEL_MAX_RESULTS_DEFAULT</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">mlflow.store.tracking</span> <span class="kn">import</span> <span class="n">SEARCH_MAX_RESULTS_DEFAULT</span><span class="p">,</span> <span class="n">SEARCH_TRACES_DEFAULT_MAX_RESULTS</span>
<span class="kn">from</span> <span class="nn">mlflow.tracing.constant</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TRACE_REQUEST_ID_PREFIX</span><span class="p">,</span>
    <span class="n">SpanAttributeKey</span><span class="p">,</span>
    <span class="n">TraceTagKey</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">mlflow.tracing.display</span> <span class="kn">import</span> <span class="n">get_display_handler</span>
<span class="kn">from</span> <span class="nn">mlflow.tracing.trace_manager</span> <span class="kn">import</span> <span class="n">InMemoryTraceManager</span>
<span class="kn">from</span> <span class="nn">mlflow.tracing.utils</span> <span class="kn">import</span> <span class="n">exclude_immutable_tags</span><span class="p">,</span> <span class="n">get_otel_attribute</span>
<span class="kn">from</span> <span class="nn">mlflow.tracking._model_registry</span> <span class="kn">import</span> <span class="n">DEFAULT_AWAIT_MAX_SLEEP_SECONDS</span>
<span class="kn">from</span> <span class="nn">mlflow.tracking._model_registry</span> <span class="kn">import</span> <span class="n">utils</span> <span class="k">as</span> <span class="n">registry_utils</span>
<span class="kn">from</span> <span class="nn">mlflow.tracking._model_registry.client</span> <span class="kn">import</span> <span class="n">ModelRegistryClient</span>
<span class="kn">from</span> <span class="nn">mlflow.tracking._tracking_service</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">mlflow.tracking._tracking_service.client</span> <span class="kn">import</span> <span class="n">TrackingServiceClient</span>
<span class="kn">from</span> <span class="nn">mlflow.tracking.artifact_utils</span> <span class="kn">import</span> <span class="n">_upload_artifacts_to_databricks</span>
<span class="kn">from</span> <span class="nn">mlflow.tracking.multimedia</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">compress_image_size</span><span class="p">,</span> <span class="n">convert_to_pil_image</span>
<span class="kn">from</span> <span class="nn">mlflow.tracking.registry</span> <span class="kn">import</span> <span class="n">UnsupportedModelRegistryStoreURIException</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.annotations</span> <span class="kn">import</span> <span class="n">deprecated</span><span class="p">,</span> <span class="n">experimental</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.async_logging.run_operations</span> <span class="kn">import</span> <span class="n">RunOperations</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.databricks_utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">get_databricks_run_url</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.logging_utils</span> <span class="kn">import</span> <span class="n">eprint</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.mlflow_tags</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">MLFLOW_LOGGED_ARTIFACTS</span><span class="p">,</span>
    <span class="n">MLFLOW_LOGGED_IMAGES</span><span class="p">,</span>
    <span class="n">MLFLOW_PARENT_RUN_ID</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.time</span> <span class="kn">import</span> <span class="n">get_current_time_millis</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.uri</span> <span class="kn">import</span> <span class="n">is_databricks_unity_catalog_uri</span><span class="p">,</span> <span class="n">is_databricks_uri</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.validation</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">_validate_model_alias_name</span><span class="p">,</span>
    <span class="n">_validate_model_name</span><span class="p">,</span>
    <span class="n">_validate_model_version</span><span class="p">,</span>
    <span class="n">_validate_model_version_or_stage_exists</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span>
    <span class="kn">import</span> <span class="nn">numpy</span>
    <span class="kn">import</span> <span class="nn">pandas</span>
    <span class="kn">import</span> <span class="nn">PIL</span>
    <span class="kn">import</span> <span class="nn">plotly</span>


<span class="n">_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">_STAGES_DEPRECATION_WARNING</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;Model registry stages will be removed in a future major release. To learn more about the &quot;</span>
    <span class="s2">&quot;deprecation of model registry stages, see our migration guide here: https://mlflow.org/docs/&quot;</span>
    <span class="s2">&quot;latest/model-registry.html#migrating-from-stages&quot;</span>
<span class="p">)</span>


<div class="viewcode-block" id="MlflowClient"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient">[docs]</a><span class="k">class</span> <span class="nc">MlflowClient</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Client of an MLflow Tracking Server that creates and manages experiments and runs, and of an</span>
<span class="sd">    MLflow Registry Server that creates and manages registered models and model versions. It&#39;s a</span>
<span class="sd">    thin wrapper around TrackingServiceClient and RegistryClient so there is a unified API but we</span>
<span class="sd">    can keep the implementation of the tracking and registry clients independent from each other.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tracking_uri</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">registry_uri</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            tracking_uri: Address of local or remote tracking server. If not provided, defaults</span>
<span class="sd">                to the service set by ``mlflow.tracking.set_tracking_uri``. See</span>
<span class="sd">                `Where Runs Get Recorded &lt;../tracking.html#where-runs-get-recorded&gt;`_</span>
<span class="sd">                for more info.</span>
<span class="sd">            registry_uri: Address of local or remote model registry server. If not provided,</span>
<span class="sd">                defaults to the service set by ``mlflow.tracking.set_registry_uri``. If</span>
<span class="sd">                no such service was set, defaults to the tracking uri of the client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">final_tracking_uri</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">_resolve_tracking_uri</span><span class="p">(</span><span class="n">tracking_uri</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_registry_uri</span> <span class="o">=</span> <span class="n">registry_utils</span><span class="o">.</span><span class="n">_resolve_registry_uri</span><span class="p">(</span><span class="n">registry_uri</span><span class="p">,</span> <span class="n">tracking_uri</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span> <span class="o">=</span> <span class="n">TrackingServiceClient</span><span class="p">(</span><span class="n">final_tracking_uri</span><span class="p">)</span>
        <span class="c1"># `MlflowClient` also references a `ModelRegistryClient` instance that is provided by the</span>
        <span class="c1"># `MlflowClient._get_registry_client()` method. This `ModelRegistryClient` is not explicitly</span>
        <span class="c1"># defined as an instance variable in the `MlflowClient` constructor; an instance variable</span>
        <span class="c1"># is assigned lazily by `MlflowClient._get_registry_client()` and should not be referenced</span>
        <span class="c1"># outside of the `MlflowClient._get_registry_client()` method</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tracking_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">tracking_uri</span>

    <span class="k">def</span> <span class="nf">_get_registry_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Attempts to create a ModelRegistryClient if one does not already exist.</span>

<span class="sd">        Raises:</span>
<span class="sd">            MlflowException: If the ModelRegistryClient cannot be created. This may occur, for</span>
<span class="sd">            example, when the registry URI refers to an unsupported store type (e.g., the</span>
<span class="sd">            FileStore).</span>

<span class="sd">        Returns:</span>
<span class="sd">            A ModelRegistryClient instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Attempt to fetch a `ModelRegistryClient` that is lazily instantiated and defined as</span>
        <span class="c1"># an instance variable on this `MlflowClient` instance. Because the instance variable</span>
        <span class="c1"># is undefined until the first invocation of _get_registry_client(), the `getattr()`</span>
        <span class="c1"># function is used to safely fetch the variable (if it is defined) or a NoneType</span>
        <span class="c1"># (if it is not defined)</span>
        <span class="n">registry_client_attr</span> <span class="o">=</span> <span class="s2">&quot;_registry_client_lazy&quot;</span>
        <span class="n">registry_client</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">registry_client_attr</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">registry_client</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">registry_client</span> <span class="o">=</span> <span class="n">ModelRegistryClient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_registry_uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracking_uri</span><span class="p">)</span>
                <span class="c1"># Define an instance variable on this `MlflowClient` instance to reference the</span>
                <span class="c1"># `ModelRegistryClient` that was just constructed. `setattr()` is used to ensure</span>
                <span class="c1"># that the variable name is consistent with the variable name specified in the</span>
                <span class="c1"># preceding call to `getattr()`</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">registry_client_attr</span><span class="p">,</span> <span class="n">registry_client</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">UnsupportedModelRegistryStoreURIException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                    <span class="s2">&quot;Model Registry features are not supported by the store with URI:&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot; &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_registry_uri</span><span class="si">}</span><span class="s2">&#39;. Stores with the following URI schemes are supported:&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">exc</span><span class="o">.</span><span class="n">supported_uri_schemes</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
                    <span class="n">FEATURE_DISABLED</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">registry_client</span>

    <span class="c1"># Tracking API</span>

<div class="viewcode-block" id="MlflowClient.get_run"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.get_run">[docs]</a>    <span class="k">def</span> <span class="nf">get_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Run</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fetch the run from backend store. The resulting :py:class:`Run &lt;mlflow.entities.Run&gt;`</span>
<span class="sd">        contains a collection of run metadata -- :py:class:`RunInfo &lt;mlflow.entities.RunInfo&gt;`,</span>
<span class="sd">        as well as a collection of run parameters, tags, and metrics --</span>
<span class="sd">        :py:class:`RunData &lt;mlflow.entities.RunData&gt;`. It also contains a collection of run</span>
<span class="sd">        inputs (experimental), including information about datasets used by the run --</span>
<span class="sd">        :py:class:`RunInputs &lt;mlflow.entities.RunInputs&gt;`. In the case where multiple metrics with</span>
<span class="sd">        the same key are logged for the run, the :py:class:`RunData &lt;mlflow.entities.RunData&gt;`</span>
<span class="sd">        contains the most recently logged value at the largest step for each metric.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: Unique identifier for the run.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A single :py:class:`mlflow.entities.Run` object, if the run exists. Otherwise,</span>
<span class="sd">            raises an exception.</span>


<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                mlflow.log_param(&quot;p&quot;, 0)</span>

<span class="sd">            # The run has finished since we have exited the with block</span>
<span class="sd">            # Fetch the run</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            run = client.get_run(run.info.run_id)</span>
<span class="sd">            print(f&quot;run_id: {run.info.run_id}&quot;)</span>
<span class="sd">            print(f&quot;params: {run.data.params}&quot;)</span>
<span class="sd">            print(f&quot;status: {run.info.status}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            run_id: e36b42c587a1413ead7c3b6764120618</span>
<span class="sd">            params: {&#39;p&#39;: &#39;0&#39;}</span>
<span class="sd">            status: FINISHED</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">get_run</span><span class="p">(</span><span class="n">run_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.get_parent_run"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.get_parent_run">[docs]</a>    <span class="k">def</span> <span class="nf">get_parent_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Run</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the parent run for the given run id if one exists.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: Unique identifier for the child run.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A single :py:class:`mlflow.entities.Run` object, if the parent run exists. Otherwise,</span>
<span class="sd">            returns None.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :test:</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            # Create nested runs</span>
<span class="sd">            with mlflow.start_run():</span>
<span class="sd">                with mlflow.start_run(nested=True) as child_run:</span>
<span class="sd">                    child_run_id = child_run.info.run_id</span>

<span class="sd">            client = MlflowClient()</span>
<span class="sd">            parent_run = client.get_parent_run(child_run_id)</span>

<span class="sd">            print(f&quot;child_run_id: {child_run_id}&quot;)</span>
<span class="sd">            print(f&quot;parent_run_id: {parent_run.info.run_id}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            child_run_id: 7d175204675e40328e46d9a6a5a7ee6a</span>
<span class="sd">            parent_run_id: 8979459433a24a52ab3be87a229a9cdf</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">child_run</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">get_run</span><span class="p">(</span><span class="n">run_id</span><span class="p">)</span>
        <span class="n">parent_run_id</span> <span class="o">=</span> <span class="n">child_run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">MLFLOW_PARENT_RUN_ID</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent_run_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">get_run</span><span class="p">(</span><span class="n">parent_run_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.get_metric_history"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.get_metric_history">[docs]</a>    <span class="k">def</span> <span class="nf">get_metric_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Metric</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of metric objects corresponding to all values logged for a given metric.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: Unique identifier for run.</span>
<span class="sd">            key: Metric name within the run.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of :py:class:`mlflow.entities.Metric` entities if logged, else empty list.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_metric_info(history):</span>
<span class="sd">                for m in history:</span>
<span class="sd">                    print(f&quot;name: {m.key}&quot;)</span>
<span class="sd">                    print(f&quot;value: {m.value}&quot;)</span>
<span class="sd">                    print(f&quot;step: {m.step}&quot;)</span>
<span class="sd">                    print(f&quot;timestamp: {m.timestamp}&quot;)</span>
<span class="sd">                    print(&quot;--&quot;)</span>


<span class="sd">            # Create a run under the default experiment (whose id is &quot;0&quot;). Since this is low-level</span>
<span class="sd">            # CRUD operation, the method will create a run. To end the run, you&#39;ll have</span>
<span class="sd">            # to explicitly end it.</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = &quot;0&quot;</span>
<span class="sd">            run = client.create_run(experiment_id)</span>
<span class="sd">            print(f&quot;run_id: {run.info.run_id}&quot;)</span>
<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # Log couple of metrics, update their initial value, and fetch each</span>
<span class="sd">            # logged metrics&#39; history.</span>
<span class="sd">            for k, v in [(&quot;m1&quot;, 1.5), (&quot;m2&quot;, 2.5)]:</span>
<span class="sd">                client.log_metric(run.info.run_id, k, v, step=0)</span>
<span class="sd">                client.log_metric(run.info.run_id, k, v + 1, step=1)</span>
<span class="sd">                print_metric_info(client.get_metric_history(run.info.run_id, k))</span>
<span class="sd">            client.set_terminated(run.info.run_id)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            run_id: c360d15714994c388b504fe09ea3c234</span>
<span class="sd">            --</span>
<span class="sd">            name: m1</span>
<span class="sd">            value: 1.5</span>
<span class="sd">            step: 0</span>
<span class="sd">            timestamp: 1603423788607</span>
<span class="sd">            --</span>
<span class="sd">            name: m1</span>
<span class="sd">            value: 2.5</span>
<span class="sd">            step: 1</span>
<span class="sd">            timestamp: 1603423788608</span>
<span class="sd">            --</span>
<span class="sd">            name: m2</span>
<span class="sd">            value: 2.5</span>
<span class="sd">            step: 0</span>
<span class="sd">            timestamp: 1603423788609</span>
<span class="sd">            --</span>
<span class="sd">            name: m2</span>
<span class="sd">            value: 3.5</span>
<span class="sd">            step: 1</span>
<span class="sd">            timestamp: 1603423788610</span>
<span class="sd">            --</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">get_metric_history</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.create_run"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.create_run">[docs]</a>    <span class="k">def</span> <span class="nf">create_run</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">run_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Run</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a :py:class:`mlflow.entities.Run` object that can be associated with</span>
<span class="sd">        metrics, parameters, artifacts, etc.</span>
<span class="sd">        Unlike :py:func:`mlflow.projects.run`, creates objects but does not run code.</span>
<span class="sd">        Unlike :py:func:`mlflow.start_run`, does not change the &quot;active run&quot; used by</span>
<span class="sd">        :py:func:`mlflow.log_param`.</span>

<span class="sd">        Args:</span>
<span class="sd">            experiment_id: The string ID of the experiment to create a run in.</span>
<span class="sd">            start_time: If not provided, use the current timestamp.</span>
<span class="sd">            tags: A dictionary of key-value pairs that are converted into</span>
<span class="sd">                :py:class:`mlflow.entities.RunTag` objects.</span>
<span class="sd">            run_name: The name of this run.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :py:class:`mlflow.entities.Run` that was created.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            # Create a run with a tag under the default experiment (whose id is &#39;0&#39;).</span>
<span class="sd">            tags = {&quot;engineering&quot;: &quot;ML Platform&quot;}</span>
<span class="sd">            name = &quot;platform-run-24&quot;</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = &quot;0&quot;</span>
<span class="sd">            run = client.create_run(experiment_id, tags=tags, run_name=name)</span>

<span class="sd">            # Show newly created run metadata info</span>
<span class="sd">            print(f&quot;Run tags: {run.data.tags}&quot;)</span>
<span class="sd">            print(f&quot;Experiment id: {run.info.experiment_id}&quot;)</span>
<span class="sd">            print(f&quot;Run id: {run.info.run_id}&quot;)</span>
<span class="sd">            print(f&quot;Run name: {run.info.run_name}&quot;)</span>
<span class="sd">            print(f&quot;lifecycle_stage: {run.info.lifecycle_stage}&quot;)</span>
<span class="sd">            print(f&quot;status: {run.info.status}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Run tags: {&#39;engineering&#39;: &#39;ML Platform&#39;}</span>
<span class="sd">            Experiment id: 0</span>
<span class="sd">            Run id: 65fb9e2198764354bab398105f2e70c1</span>
<span class="sd">            Run name: platform-run-24</span>
<span class="sd">            lifecycle_stage: active</span>
<span class="sd">            status: RUNNING</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">create_run</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">run_name</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_upload_trace_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trace_info</span><span class="p">:</span> <span class="n">TraceInfo</span><span class="p">,</span> <span class="n">trace_data</span><span class="p">:</span> <span class="n">TraceData</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">_upload_trace_data</span><span class="p">(</span><span class="n">trace_info</span><span class="p">,</span> <span class="n">trace_data</span><span class="p">)</span>

<div class="viewcode-block" id="MlflowClient.delete_traces"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.delete_traces">[docs]</a>    <span class="nd">@experimental</span>
    <span class="k">def</span> <span class="nf">delete_traces</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">max_timestamp_millis</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_traces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">request_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete traces based on the specified criteria.</span>

<span class="sd">        - Either `max_timestamp_millis` or `request_ids` must be specified, but not both.</span>
<span class="sd">        - `max_traces` can&#39;t be specified if `request_ids` is specified.</span>

<span class="sd">        Args:</span>
<span class="sd">            experiment_id: ID of the associated experiment.</span>
<span class="sd">            max_timestamp_millis: The maximum timestamp in milliseconds since the UNIX epoch for</span>
<span class="sd">                deleting traces. Traces older than or equal to this timestamp will be deleted.</span>
<span class="sd">            max_traces: The maximum number of traces to delete. If max_traces is specified, and</span>
<span class="sd">                it is less than the number of traces that would be deleted based on the</span>
<span class="sd">                max_timestamp_millis, the oldest traces will be deleted first.</span>
<span class="sd">            request_ids: A set of request IDs to delete.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The number of traces deleted.</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :test:</span>

<span class="sd">            import mlflow</span>
<span class="sd">            import time</span>

<span class="sd">            client = mlflow.MlflowClient()</span>

<span class="sd">            # Delete all traces in the experiment</span>
<span class="sd">            client.delete_traces(</span>
<span class="sd">                experiment_id=&quot;0&quot;, max_timestamp_millis=time.time_ns() // 1_000_000</span>
<span class="sd">            )</span>

<span class="sd">            # Delete traces based on max_timestamp_millis and max_traces</span>
<span class="sd">            # Older traces will be deleted first.</span>
<span class="sd">            some_timestamp = time.time_ns() // 1_000_000</span>
<span class="sd">            client.delete_traces(</span>
<span class="sd">                experiment_id=&quot;0&quot;, max_timestamp_millis=some_timestamp, max_traces=2</span>
<span class="sd">            )</span>

<span class="sd">            # Delete traces based on request_ids</span>
<span class="sd">            client.delete_traces(experiment_id=&quot;0&quot;, request_ids=[&quot;id_1&quot;, &quot;id_2&quot;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">delete_traces</span><span class="p">(</span>
            <span class="n">experiment_id</span><span class="o">=</span><span class="n">experiment_id</span><span class="p">,</span>
            <span class="n">max_timestamp_millis</span><span class="o">=</span><span class="n">max_timestamp_millis</span><span class="p">,</span>
            <span class="n">max_traces</span><span class="o">=</span><span class="n">max_traces</span><span class="p">,</span>
            <span class="n">request_ids</span><span class="o">=</span><span class="n">request_ids</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.get_trace"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.get_trace">[docs]</a>    <span class="nd">@experimental</span>
    <span class="k">def</span> <span class="nf">get_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Trace</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the trace matching the specified ``request_id``.</span>

<span class="sd">        Args:</span>
<span class="sd">            request_id: String ID of the trace to fetch.</span>
<span class="sd">            display: If ``True``, display the trace on the notebook.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The retrieved :py:class:`Trace &lt;mlflow.entities.Trace&gt;`.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            client = MlflowClient()</span>
<span class="sd">            request_id = &quot;12345678&quot;</span>
<span class="sd">            trace = client.get_trace(request_id)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="n">request_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">display</span><span class="p">:</span>
            <span class="n">get_display_handler</span><span class="p">()</span><span class="o">.</span><span class="n">display_traces</span><span class="p">([</span><span class="n">trace</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">trace</span></div>

<div class="viewcode-block" id="MlflowClient.search_traces"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.search_traces">[docs]</a>    <span class="nd">@experimental</span>
    <span class="k">def</span> <span class="nf">search_traces</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">experiment_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">filter_string</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">SEARCH_TRACES_DEFAULT_MAX_RESULTS</span><span class="p">,</span>
        <span class="n">order_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">page_token</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PagedList</span><span class="p">[</span><span class="n">Trace</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return traces that match the given list of search expressions within the experiments.</span>

<span class="sd">        Args:</span>
<span class="sd">            experiment_ids: List of experiment ids to scope the search.</span>
<span class="sd">            filter_string: A search filter string.</span>
<span class="sd">            max_results: Maximum number of traces desired.</span>
<span class="sd">            order_by: List of order_by clauses.</span>
<span class="sd">            page_token: Token specifying the next page of results. It should be obtained from</span>
<span class="sd">                a ``search_traces`` call.</span>
<span class="sd">            run_id: A run id to scope the search. When a trace is created under an active run,</span>
<span class="sd">                it will be associated with the run and you can filter on the run id to retrieve</span>
<span class="sd">                the trace.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A :py:class:`PagedList &lt;mlflow.store.entities.PagedList&gt;` of</span>
<span class="sd">            :py:class:`Trace &lt;mlflow.entities.Trace&gt;` objects that satisfy the search</span>
<span class="sd">            expressions. If the underlying tracking store supports pagination, the token for the</span>
<span class="sd">            next page may be obtained via the ``token`` attribute of the returned object; however,</span>
<span class="sd">            some store implementations may not support pagination and thus the returned token would</span>
<span class="sd">            not be meaningful in such cases.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">traces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">search_traces</span><span class="p">(</span>
            <span class="n">experiment_ids</span><span class="o">=</span><span class="n">experiment_ids</span><span class="p">,</span>
            <span class="n">filter_string</span><span class="o">=</span><span class="n">filter_string</span><span class="p">,</span>
            <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
            <span class="n">order_by</span><span class="o">=</span><span class="n">order_by</span><span class="p">,</span>
            <span class="n">page_token</span><span class="o">=</span><span class="n">page_token</span><span class="p">,</span>
            <span class="n">run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">get_display_handler</span><span class="p">()</span><span class="o">.</span><span class="n">display_traces</span><span class="p">(</span><span class="n">traces</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">traces</span></div>

<div class="viewcode-block" id="MlflowClient.start_trace"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.start_trace">[docs]</a>    <span class="k">def</span> <span class="nf">start_trace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">span_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">SpanType</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">,</span>
        <span class="n">inputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">experiment_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">start_time_ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Span</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new trace object and start a root span under it.</span>

<span class="sd">        This is an imperative API to manually create a new span under a specific trace id and</span>
<span class="sd">        parent span, unlike the higher-level APIs like :py:func:`@mlflow.trace &lt;mlflow.trace&gt;`</span>
<span class="sd">        and :py:func:`with mlflow.start_span() &lt;mlflow.start_span&gt;`, which automatically manage</span>
<span class="sd">        the span lifecycle and parent-child relationship. You only need to call this method</span>
<span class="sd">        when using the :py:func:`start_span() &lt;start_span&gt;` method of MlflowClient to create</span>
<span class="sd">        spans.</span>

<span class="sd">        .. attention::</span>

<span class="sd">            A trace started with this method must be ended by calling</span>
<span class="sd">            ``MlflowClient().end_trace(request_id)``. Otherwise the trace will be not recorded.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the trace (and the root span).</span>
<span class="sd">            span_type: The type of the span.</span>
<span class="sd">            inputs: Inputs to set on the root span of the trace.</span>
<span class="sd">            attributes: A dictionary of attributes to set on the root span of the trace.</span>
<span class="sd">            tags: A dictionary of tags to set on the trace.</span>
<span class="sd">            experiment_id: The ID of the experiment to create the trace in. If not provided,</span>
<span class="sd">                MLflow will look for valid experiment in the following order: activated using</span>
<span class="sd">                :py:func:`mlflow.set_experiment() &lt;mlflow.set_experiment&gt;`,</span>
<span class="sd">                ``MLFLOW_EXPERIMENT_NAME`` environment variable, ``MLFLOW_EXPERIMENT_ID``</span>
<span class="sd">                environment variable, or the default experiment as defined by the tracking server.</span>
<span class="sd">            start_time_ns: The start time of the trace in nanoseconds since the UNIX epoch.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An :py:class:`Span &lt;mlflow.entities.Span&gt;` object</span>
<span class="sd">            representing the root span of the trace.</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :test:</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            client = MlflowClient()</span>

<span class="sd">            root_span = client.start_trace(&quot;my_trace&quot;)</span>
<span class="sd">            request_id = root_span.request_id</span>

<span class="sd">            # Create a child span</span>
<span class="sd">            child_span = client.start_span(</span>
<span class="sd">                &quot;child_span&quot;, request_id=request_id, parent_id=root_span.span_id</span>
<span class="sd">            )</span>
<span class="sd">            # Do something...</span>
<span class="sd">            client.end_span(request_id=request_id, span_id=child_span.span_id)</span>

<span class="sd">            client.end_trace(request_id)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validate no active trace is set in the global context. If there is an active trace,</span>
        <span class="c1"># the span created by this method will be a child span under the active trace rather than</span>
        <span class="c1"># a root span of a new trace, which is not desired behavior.</span>
        <span class="k">if</span> <span class="n">span</span> <span class="o">:=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">get_current_active_span</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Another trace is already set in the global context with ID </span><span class="si">{</span><span class="n">span</span><span class="o">.</span><span class="n">request_id</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="s2">&quot;It appears that you have already started a trace using fluent APIs like &quot;</span>
                <span class="s2">&quot;`@mlflow.trace()` or `with mlflow.start_span()`. However, it is not allowed &quot;</span>
                <span class="s2">&quot;to call MlflowClient.start_trace() under an active trace created by fluent APIs &quot;</span>
                <span class="s2">&quot;because it may lead to unexpected behavior. To resolve this issue, consider the &quot;</span>
                <span class="s2">&quot;following options:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot; - To create a child span under the active trace, use &quot;</span>
                <span class="s2">&quot;`with mlflow.start_span()` or `MlflowClient.start_span()` instead.</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot; - To start multiple traces in parallel, avoid using fluent APIs &quot;</span>
                <span class="s2">&quot;and create all traces using `MlflowClient.start_trace()`.&quot;</span><span class="p">,</span>
                <span class="n">error_code</span><span class="o">=</span><span class="n">BAD_REQUEST</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Create new trace and a root span</span>
            <span class="c1"># Once OTel span is created, SpanProcessor.on_start is invoked</span>
            <span class="c1"># TraceInfo is created and logged into backend store inside on_start method</span>
            <span class="n">otel_span</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">tracing</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">start_detached_span</span><span class="p">(</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">experiment_id</span><span class="o">=</span><span class="n">experiment_id</span><span class="p">,</span> <span class="n">start_time_ns</span><span class="o">=</span><span class="n">start_time_ns</span>
            <span class="p">)</span>
            <span class="n">request_id</span> <span class="o">=</span> <span class="n">get_otel_attribute</span><span class="p">(</span><span class="n">otel_span</span><span class="p">,</span> <span class="n">SpanAttributeKey</span><span class="o">.</span><span class="n">REQUEST_ID</span><span class="p">)</span>
            <span class="n">mlflow_span</span> <span class="o">=</span> <span class="n">create_mlflow_span</span><span class="p">(</span><span class="n">otel_span</span><span class="p">,</span> <span class="n">request_id</span><span class="p">,</span> <span class="n">span_type</span><span class="p">)</span>

            <span class="c1"># # If the span is a no-op span i.e. tracing is disabled, do nothing</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mlflow_span</span><span class="p">,</span> <span class="n">NoOpSpan</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">mlflow_span</span>

            <span class="k">if</span> <span class="n">inputs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mlflow_span</span><span class="o">.</span><span class="n">set_inputs</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">mlflow_span</span><span class="o">.</span><span class="n">set_attributes</span><span class="p">(</span><span class="n">attributes</span> <span class="ow">or</span> <span class="p">{})</span>

            <span class="n">trace_manager</span> <span class="o">=</span> <span class="n">InMemoryTraceManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span>
            <span class="n">tags</span> <span class="o">=</span> <span class="n">exclude_immutable_tags</span><span class="p">(</span><span class="n">tags</span> <span class="ow">or</span> <span class="p">{})</span>
            <span class="c1"># Update trace tags for trace in in-memory trace manager</span>
            <span class="k">with</span> <span class="n">trace_manager</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="n">request_id</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
                <span class="n">trace</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
            <span class="c1"># Register new span in the in-memory trace manager</span>
            <span class="n">trace_manager</span><span class="o">.</span><span class="n">register_span</span><span class="p">(</span><span class="n">mlflow_span</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">mlflow_span</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Failed to start trace </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="s2">&quot;For full traceback, set logging level to debug.&quot;</span><span class="p">,</span>
                <span class="n">exc_info</span><span class="o">=</span><span class="n">_logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">NoOpSpan</span><span class="p">()</span></div>

<div class="viewcode-block" id="MlflowClient.end_trace"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.end_trace">[docs]</a>    <span class="nd">@experimental</span>
    <span class="k">def</span> <span class="nf">end_trace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">request_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">outputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">status</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SpanStatus</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OK&quot;</span><span class="p">,</span>
        <span class="n">end_time_ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        End the trace with the given trace ID. This will end the root span of the trace and</span>
<span class="sd">        log the trace to the backend if configured.</span>

<span class="sd">        If any of children spans are not ended, they will be ended forcefully with the status</span>
<span class="sd">        ``TRACE_STATUS_UNSPECIFIED``. If the trace is already ended, this method will have</span>
<span class="sd">        no effect.</span>

<span class="sd">        Args:</span>
<span class="sd">            request_id: The ID of the trace to end.</span>
<span class="sd">            outputs: Outputs to set on the trace.</span>
<span class="sd">            attributes: A dictionary of attributes to set on the trace. If the trace already</span>
<span class="sd">                has attributes, the new attributes will be merged with the existing ones.</span>
<span class="sd">                If the same key already exists, the new value will overwrite the old one.</span>
<span class="sd">            status: The status of the trace. This can be a</span>
<span class="sd">                :py:class:`SpanStatus &lt;mlflow.entities.SpanStatus&gt;` object or a string</span>
<span class="sd">                representing the status code defined in</span>
<span class="sd">                :py:class:`SpanStatusCode &lt;mlflow.entities.SpanStatusCode&gt;`</span>
<span class="sd">                e.g. ``&quot;OK&quot;``, ``&quot;ERROR&quot;``. The default status is OK.</span>
<span class="sd">            end_time_ns: The end time of the trace in nanoseconds since the UNIX epoch.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># NB: If the specified request ID is of no-op span, this means something went wrong in</span>
        <span class="c1">#     the span start logic. We should simply ignore it as the upstream should already</span>
        <span class="c1">#     have logged the error.</span>
        <span class="k">if</span> <span class="n">request_id</span> <span class="o">==</span> <span class="n">NO_OP_SPAN_REQUEST_ID</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">trace_manager</span> <span class="o">=</span> <span class="n">InMemoryTraceManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span>
        <span class="n">root_span_id</span> <span class="o">=</span> <span class="n">trace_manager</span><span class="o">.</span><span class="n">get_root_span_id</span><span class="p">(</span><span class="n">request_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">root_span_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="n">request_id</span><span class="o">=</span><span class="n">request_id</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">trace</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Trace with ID </span><span class="si">{</span><span class="n">request_id</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">,</span>
                    <span class="n">error_code</span><span class="o">=</span><span class="n">RESOURCE_DOES_NOT_EXIST</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">trace</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="n">TraceStatus</span><span class="o">.</span><span class="n">end_statuses</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Trace with ID </span><span class="si">{</span><span class="n">request_id</span><span class="si">}</span><span class="s2"> already finished.&quot;</span><span class="p">,</span>
                    <span class="n">error_code</span><span class="o">=</span><span class="n">INVALID_PARAMETER_VALUE</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">end_span</span><span class="p">(</span><span class="n">request_id</span><span class="p">,</span> <span class="n">root_span_id</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">attributes</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">end_time_ns</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_upload_trace_spans_as_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trace_info</span><span class="p">:</span> <span class="n">TraceInfo</span><span class="p">,</span> <span class="n">trace_data</span><span class="p">:</span> <span class="n">TraceData</span><span class="p">):</span>
        <span class="c1"># When a trace is logged, we set a mlflow.traceSpans tag via SetTraceTag API</span>
        <span class="c1"># https://databricks.atlassian.net/browse/ML-40306</span>
        <span class="n">parsed_spans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="n">trace_data</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
            <span class="n">parsed_span</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="n">parsed_span</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="n">name</span>
            <span class="n">parsed_span</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="n">span_type</span>
            <span class="n">span_inputs</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="n">inputs</span>
            <span class="k">if</span> <span class="n">span_inputs</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">span_inputs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">parsed_span</span><span class="p">[</span><span class="s2">&quot;inputs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">span_inputs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">span_outputs</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="n">outputs</span>
            <span class="k">if</span> <span class="n">span_outputs</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">span_outputs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">parsed_span</span><span class="p">[</span><span class="s2">&quot;outputs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">span_outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

            <span class="n">parsed_spans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parsed_span</span><span class="p">)</span>

        <span class="c1"># Directly set the tag on the trace in the backend</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">set_trace_tag</span><span class="p">(</span>
            <span class="n">trace_info</span><span class="o">.</span><span class="n">request_id</span><span class="p">,</span>
            <span class="n">TraceTagKey</span><span class="o">.</span><span class="n">TRACE_SPANS</span><span class="p">,</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">parsed_spans</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="p">)</span>

<div class="viewcode-block" id="MlflowClient.start_span"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.start_span">[docs]</a>    <span class="nd">@experimental</span>
    <span class="k">def</span> <span class="nf">start_span</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">request_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">parent_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">span_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">SpanType</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">,</span>
        <span class="n">inputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">start_time_ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Span</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new span and start it without attaching it to the global trace context.</span>

<span class="sd">        This is an imperative API to manually create a new span under a specific trace id</span>
<span class="sd">        and parent span, unlike the higher-level APIs like</span>
<span class="sd">        :py:func:`@mlflow.trace &lt;mlflow.trace&gt;` decorator and</span>
<span class="sd">        :py:func:`with mlflow.start_span() &lt;mlflow.start_span&gt;` context manager, which</span>
<span class="sd">        automatically manage the span lifecycle and parent-child relationship.</span>

<span class="sd">        This API is useful for the case where the automatic context management is not</span>
<span class="sd">        sufficient, such as callback-based instrumentation where span start and end are</span>
<span class="sd">        not in the same call stack, or multi-threaded applications where the context is</span>
<span class="sd">        not propagated automatically.</span>

<span class="sd">        This API requires a parent span ID to be provided explicitly. If you haven&#39;t</span>
<span class="sd">        started any span yet, use the :py:func:`start_trace() &lt;start_trace&gt;` method to</span>
<span class="sd">        start a new trace and a root span.</span>

<span class="sd">        .. warning::</span>

<span class="sd">            The span created with this method needs to be ended explicitly by calling</span>
<span class="sd">            the :py:func:`end_span() &lt;end_span&gt;` method. Otherwise the span will be</span>
<span class="sd">            recorded with the incorrect end time and status ``TRACE_STATUS_UNSPECIFIED``.</span>

<span class="sd">        .. tip::</span>

<span class="sd">            Instead of creating a root span with the :py:func:`start_trace() &lt;start_trace&gt;`</span>
<span class="sd">            method, you can also use this method within the context of a parent span created</span>
<span class="sd">            by the fluent APIs like :py:func:`@mlflow.trace &lt;mlflow.trace&gt;` and</span>
<span class="sd">            :py:func:`with mlflow.start_span() &lt;mlflow.start_span&gt;`, by passing its span</span>
<span class="sd">            ids the parent. This flexibility allows you to use the imperative APIs in</span>
<span class="sd">            conjunction with the fluent APIs like below:</span>

<span class="sd">            .. code-block:: python</span>
<span class="sd">                :test:</span>

<span class="sd">                import mlflow</span>
<span class="sd">                from mlflow import MlflowClient</span>

<span class="sd">                client = MlflowClient()</span>

<span class="sd">                with mlflow.start_span(&quot;parent_span&quot;) as parent_span:</span>
<span class="sd">                    child_span = client.start_span(</span>
<span class="sd">                        name=&quot;child_span&quot;,</span>
<span class="sd">                        request_id=parent_span.request_id,</span>
<span class="sd">                        parent_id=parent_span.span_id,</span>
<span class="sd">                    )</span>

<span class="sd">                    # Do something...</span>

<span class="sd">                    client.end_span(</span>
<span class="sd">                        request_id=parent_span.request_id,</span>
<span class="sd">                        span_id=child_span.span_id,</span>
<span class="sd">                    )</span>

<span class="sd">            However, **the opposite does not work**. You cannot use the fluent APIs within</span>
<span class="sd">            the span created by this MlflowClient API. This is because the fluent APIs</span>
<span class="sd">            fetches the current span from the managed context, which is not set by the MLflow</span>
<span class="sd">            Client APIs. Once you create a span with the MLflow Client APIs, all children</span>
<span class="sd">            spans must be created with the MLflow Client APIs. Please be cautious when using</span>
<span class="sd">            this mixed approach, as it can lead to unexpected behavior if not used properly.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the span.</span>
<span class="sd">            request_id: The ID of the trace to attach the span to. This is synonym to</span>
<span class="sd">                trace_id` in OpenTelemetry.</span>
<span class="sd">            parent_id: The ID of the parent span. The parent span can be a span created by</span>
<span class="sd">                both fluent APIs like `with mlflow.start_span()`, and imperative APIs like this.</span>
<span class="sd">            span_type: The type of the span. Can be either a string or a</span>
<span class="sd">                :py:class:`SpanType &lt;mlflow.entities.SpanType&gt;` enum value.</span>
<span class="sd">            inputs: Inputs to set on the span.</span>
<span class="sd">            attributes: A dictionary of attributes to set on the span.</span>
<span class="sd">            start_time_ns: The start time of the span in nano seconds since the UNIX epoch.</span>
<span class="sd">                If not provided, the current time will be used.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An :py:class:`mlflow.entities.Span` object representing the span.</span>

<span class="sd">        Example:</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :test:</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            client = MlflowClient()</span>

<span class="sd">            span = client.start_trace(&quot;my_trace&quot;)</span>

<span class="sd">            x = 2</span>

<span class="sd">            # Create a child span</span>
<span class="sd">            child_span = client.start_span(</span>
<span class="sd">                &quot;child_span&quot;,</span>
<span class="sd">                request_id=span.request_id,</span>
<span class="sd">                parent_id=span.span_id,</span>
<span class="sd">                inputs={&quot;x&quot;: x},</span>
<span class="sd">            )</span>

<span class="sd">            y = x**2</span>

<span class="sd">            client.end_span(</span>
<span class="sd">                request_id=child_span.request_id,</span>
<span class="sd">                span_id=child_span.span_id,</span>
<span class="sd">                attributes={&quot;factor&quot;: 2},</span>
<span class="sd">                outputs={&quot;y&quot;: y},</span>
<span class="sd">            )</span>

<span class="sd">            client.end_trace(span.request_id)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If parent span is no-op span, the child should also be no-op too</span>
        <span class="k">if</span> <span class="n">request_id</span> <span class="o">==</span> <span class="n">NO_OP_SPAN_REQUEST_ID</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">NoOpSpan</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">parent_id</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="s2">&quot;start_span() must be called with an explicit parent_id.&quot;</span>
                <span class="s2">&quot;If you haven&#39;t started any span yet, use MLflowClient().start_trace() &quot;</span>
                <span class="s2">&quot;to start a new trace and root span.&quot;</span><span class="p">,</span>
                <span class="n">error_code</span><span class="o">=</span><span class="n">INVALID_PARAMETER_VALUE</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">request_id</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="s2">&quot;Request ID must be provided to start a span.&quot;</span><span class="p">,</span>
                <span class="n">error_code</span><span class="o">=</span><span class="n">INVALID_PARAMETER_VALUE</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">trace_manager</span> <span class="o">=</span> <span class="n">InMemoryTraceManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">parent_span</span> <span class="o">:=</span> <span class="n">trace_manager</span><span class="o">.</span><span class="n">get_span_from_id</span><span class="p">(</span><span class="n">request_id</span><span class="p">,</span> <span class="n">parent_id</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Parent span with ID &#39;</span><span class="si">{</span><span class="n">parent_id</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">,</span>
                <span class="n">error_code</span><span class="o">=</span><span class="n">RESOURCE_DOES_NOT_EXIST</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">otel_span</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">tracing</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">start_detached_span</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">parent</span><span class="o">=</span><span class="n">parent_span</span><span class="o">.</span><span class="n">_span</span><span class="p">,</span>
                <span class="n">start_time_ns</span><span class="o">=</span><span class="n">start_time_ns</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">span</span> <span class="o">=</span> <span class="n">create_mlflow_span</span><span class="p">(</span><span class="n">otel_span</span><span class="p">,</span> <span class="n">request_id</span><span class="p">,</span> <span class="n">span_type</span><span class="p">)</span>
            <span class="n">span</span><span class="o">.</span><span class="n">set_attributes</span><span class="p">(</span><span class="n">attributes</span> <span class="ow">or</span> <span class="p">{})</span>
            <span class="k">if</span> <span class="n">inputs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">span</span><span class="o">.</span><span class="n">set_inputs</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">trace_manager</span><span class="o">.</span><span class="n">register_span</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">span</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Failed to start span </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="s2">&quot;For full traceback, set logging level to debug.&quot;</span><span class="p">,</span>
                <span class="n">exc_info</span><span class="o">=</span><span class="n">_logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">NoOpSpan</span><span class="p">()</span></div>

<div class="viewcode-block" id="MlflowClient.end_span"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.end_span">[docs]</a>    <span class="nd">@experimental</span>
    <span class="k">def</span> <span class="nf">end_span</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">request_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">span_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">outputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">status</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SpanStatus</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OK&quot;</span><span class="p">,</span>
        <span class="n">end_time_ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        End the span with the given trace ID and span ID.</span>

<span class="sd">        Args:</span>
<span class="sd">            request_id: The ID of the trace to end.</span>
<span class="sd">            span_id: The ID of the span to end.</span>
<span class="sd">            outputs: Outputs to set on the span.</span>
<span class="sd">            attributes: A dictionary of attributes to set on the span. If the span already has</span>
<span class="sd">                attributes, the new attributes will be merged with the existing ones. If the same</span>
<span class="sd">                key already exists, the new value will overwrite the old one.</span>
<span class="sd">            status: The status of the span. This can be a</span>
<span class="sd">                :py:class:`SpanStatus &lt;mlflow.entities.SpanStatus&gt;` object or a string</span>
<span class="sd">                representing the status code defined in</span>
<span class="sd">                :py:class:`SpanStatusCode &lt;mlflow.entities.SpanStatusCode&gt;`</span>
<span class="sd">                e.g. ``&quot;OK&quot;``, ``&quot;ERROR&quot;``. The default status is OK.</span>
<span class="sd">            end_time_ns: The end time of the span in nano seconds since the UNIX epoch.</span>
<span class="sd">                If not provided, the current time will be used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">request_id</span> <span class="o">==</span> <span class="n">NO_OP_SPAN_REQUEST_ID</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">trace_manager</span> <span class="o">=</span> <span class="n">InMemoryTraceManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span>
        <span class="n">span</span> <span class="o">=</span> <span class="n">trace_manager</span><span class="o">.</span><span class="n">get_span_from_id</span><span class="p">(</span><span class="n">request_id</span><span class="p">,</span> <span class="n">span_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">span</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Span with ID </span><span class="si">{</span><span class="n">span_id</span><span class="si">}</span><span class="s2"> is not found or already finished.&quot;</span><span class="p">,</span>
                <span class="n">error_code</span><span class="o">=</span><span class="n">RESOURCE_DOES_NOT_EXIST</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">span</span><span class="o">.</span><span class="n">set_attributes</span><span class="p">(</span><span class="n">attributes</span> <span class="ow">or</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">outputs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">span</span><span class="o">.</span><span class="n">set_outputs</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
        <span class="n">span</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">span</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="n">end_time</span><span class="o">=</span><span class="n">end_time_ns</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Failed to end span </span><span class="si">{</span><span class="n">span_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="s2">&quot;For full traceback, set logging level to debug.&quot;</span><span class="p">,</span>
                <span class="n">exc_info</span><span class="o">=</span><span class="n">_logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">),</span>
            <span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_start_tracked_trace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">timestamp_ms</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">request_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TraceInfo</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Start an initial TraceInfo object in the backend store.</span>

<span class="sd">        Args:</span>
<span class="sd">            experiment_id: String id of the experiment for this run.</span>
<span class="sd">            timestamp_ms: Start time of the trace, in milliseconds since the UNIX epoch.</span>
<span class="sd">            request_metadata: Metadata of the trace.</span>
<span class="sd">            tags: Tags of the trace.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The created TraceInfo object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Some tags like mlflow.runName are immutable once logged in tracking server.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">start_trace</span><span class="p">(</span>
            <span class="n">experiment_id</span><span class="o">=</span><span class="n">experiment_id</span><span class="p">,</span>
            <span class="n">timestamp_ms</span><span class="o">=</span><span class="n">timestamp_ms</span><span class="p">,</span>
            <span class="n">request_metadata</span><span class="o">=</span><span class="n">request_metadata</span> <span class="ow">or</span> <span class="p">{},</span>
            <span class="n">tags</span><span class="o">=</span><span class="n">tags</span> <span class="ow">or</span> <span class="p">{},</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_upload_ended_trace_info</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">trace_info</span><span class="p">:</span> <span class="n">TraceInfo</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TraceInfo</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the TraceInfo object in the backend store with the completed trace info.</span>

<span class="sd">        Args:</span>
<span class="sd">            trace_info: Updated TraceInfo object to be stored in the backend store.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The updated TraceInfo object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">end_trace</span><span class="p">(</span>
            <span class="n">request_id</span><span class="o">=</span><span class="n">trace_info</span><span class="o">.</span><span class="n">request_id</span><span class="p">,</span>
            <span class="n">timestamp_ms</span><span class="o">=</span><span class="n">trace_info</span><span class="o">.</span><span class="n">timestamp_ms</span> <span class="o">+</span> <span class="n">trace_info</span><span class="o">.</span><span class="n">execution_time_ms</span><span class="p">,</span>
            <span class="n">status</span><span class="o">=</span><span class="n">trace_info</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
            <span class="n">request_metadata</span><span class="o">=</span><span class="n">trace_info</span><span class="o">.</span><span class="n">request_metadata</span><span class="p">,</span>
            <span class="n">tags</span><span class="o">=</span><span class="n">trace_info</span><span class="o">.</span><span class="n">tags</span> <span class="ow">or</span> <span class="p">{},</span>
        <span class="p">)</span>

<div class="viewcode-block" id="MlflowClient.set_trace_tag"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.set_trace_tag">[docs]</a>    <span class="nd">@experimental</span>
    <span class="k">def</span> <span class="nf">set_trace_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a tag on the trace with the given trace ID.</span>

<span class="sd">        The trace can be an active one or the one that has already ended and recorded in the</span>
<span class="sd">        backend. Below is an example of setting a tag on an active trace. You can replace the</span>
<span class="sd">        ``request_id`` parameter to set a tag on an already ended trace.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :test:</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            client = MlflowClient()</span>

<span class="sd">            root_span = client.start_trace(&quot;my_trace&quot;)</span>
<span class="sd">            client.set_trace_tag(root_span.request_id, &quot;key&quot;, &quot;value&quot;)</span>
<span class="sd">            client.end_trace(root_span.request_id)</span>

<span class="sd">        Args:</span>
<span class="sd">            request_id: The ID of the trace to set the tag on.</span>
<span class="sd">            key: The string key of the tag. Must be at most 250 characters long, otherwise</span>
<span class="sd">                it will be truncated when stored.</span>
<span class="sd">            value: The string value of the tag. Must be at most 250 characters long, otherwise</span>
<span class="sd">                it will be truncated when stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;mlflow.&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Tags starting with &#39;mlflow.&#39; are reserved and cannot be set. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Attempted to set tag with key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; on trace with ID &#39;</span><span class="si">{</span><span class="n">request_id</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">,</span>
                <span class="n">error_code</span><span class="o">=</span><span class="n">INVALID_PARAMETER_VALUE</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Trying to set the tag on the active trace first</span>
        <span class="k">with</span> <span class="n">InMemoryTraceManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="n">request_id</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">trace</span><span class="p">:</span>
                <span class="n">trace</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">tags</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="c1"># If the trace is not active, try to set the tag on the trace in the backend</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">set_trace_tag</span><span class="p">(</span><span class="n">request_id</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.delete_trace_tag"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.delete_trace_tag">[docs]</a>    <span class="nd">@experimental</span>
    <span class="k">def</span> <span class="nf">delete_trace_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete a tag on the trace with the given trace ID.</span>

<span class="sd">        The trace can be an active one or the one that has already ended and recorded in the</span>
<span class="sd">        backend. Below is an example of deleting a tag on an active trace. You can replace the</span>
<span class="sd">        ``request_id`` parameter to delete a tag on an already ended trace.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :test:</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            client = MlflowClient()</span>

<span class="sd">            root_span = client.start_trace(&quot;my_trace&quot;, tags={&quot;key&quot;: &quot;value&quot;})</span>
<span class="sd">            client.delete_trace_tag(root_span.request_id, &quot;key&quot;)</span>
<span class="sd">            client.end_trace(root_span.request_id)</span>

<span class="sd">        Args:</span>
<span class="sd">            request_id: The ID of the trace to delete the tag from.</span>
<span class="sd">            key: The string key of the tag. Must be at most 250 characters long, otherwise</span>
<span class="sd">                it will be truncated when stored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Trying to delete the tag on the active trace first</span>
        <span class="k">with</span> <span class="n">InMemoryTraceManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="n">request_id</span><span class="p">)</span> <span class="k">as</span> <span class="n">trace</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">trace</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">trace</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
                    <span class="n">trace</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Tag with key </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> not found in trace with ID </span><span class="si">{</span><span class="n">request_id</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
                        <span class="n">error_code</span><span class="o">=</span><span class="n">RESOURCE_DOES_NOT_EXIST</span><span class="p">,</span>
                    <span class="p">)</span>

        <span class="c1"># If the trace is not active, try to delete the tag on the trace in the backend</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">delete_trace_tag</span><span class="p">(</span><span class="n">request_id</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.search_experiments"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.search_experiments">[docs]</a>    <span class="k">def</span> <span class="nf">search_experiments</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">view_type</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">ViewType</span><span class="o">.</span><span class="n">ACTIVE_ONLY</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">SEARCH_MAX_RESULTS_DEFAULT</span><span class="p">,</span>
        <span class="n">filter_string</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">order_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">page_token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PagedList</span><span class="p">[</span><span class="n">Experiment</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Search for experiments that match the specified search query.</span>

<span class="sd">        Args:</span>
<span class="sd">            view_type: One of enum values ``ACTIVE_ONLY``, ``DELETED_ONLY``, or ``ALL``</span>
<span class="sd">                defined in :py:class:`mlflow.entities.ViewType`.</span>
<span class="sd">            max_results: Maximum number of experiments desired. Certain server backend may apply</span>
<span class="sd">                its own limit.</span>
<span class="sd">            filter_string: Filter query string (e.g., ``&quot;name = &#39;my_experiment&#39;&quot;``), defaults to</span>
<span class="sd">                searching for all experiments. The following identifiers, comparators, and logical</span>
<span class="sd">                operators are supported.</span>

<span class="sd">                Identifiers</span>
<span class="sd">                  - ``name``: Experiment name</span>
<span class="sd">                  - ``creation_time``: Experiment creation time</span>
<span class="sd">                  - ``last_update_time``: Experiment last update time</span>
<span class="sd">                  - ``tags.&lt;tag_key&gt;``: Experiment tag. If ``tag_key`` contains</span>
<span class="sd">                    spaces, it must be wrapped with backticks (e.g., ``&quot;tags.`extra key`&quot;``).</span>

<span class="sd">                Comparators for string attributes and tags</span>
<span class="sd">                  - ``=``: Equal to</span>
<span class="sd">                  - ``!=``: Not equal to</span>
<span class="sd">                  - ``LIKE``: Case-sensitive pattern match</span>
<span class="sd">                  - ``ILIKE``: Case-insensitive pattern match</span>

<span class="sd">                Comparators for numeric attributes</span>
<span class="sd">                  - ``=``: Equal to</span>
<span class="sd">                  - ``!=``: Not equal to</span>
<span class="sd">                  - ``&lt;``: Less than</span>
<span class="sd">                  - ``&lt;=``: Less than or equal to</span>
<span class="sd">                  - ``&gt;``: Greater than</span>
<span class="sd">                  - ``&gt;=``: Greater than or equal to</span>

<span class="sd">                Logical operators</span>
<span class="sd">                  - ``AND``: Combines two sub-queries and returns True if both of them are True.</span>

<span class="sd">            order_by: List of columns to order by. The ``order_by`` column can contain an optional</span>
<span class="sd">                ``DESC`` or ``ASC`` value (e.g., ``&quot;name DESC&quot;``). The default ordering is ``ASC``,</span>
<span class="sd">                so ``&quot;name&quot;`` is equivalent to ``&quot;name ASC&quot;``. If unspecified, defaults to</span>
<span class="sd">                ``[&quot;last_update_time DESC&quot;]``, which lists experiments updated most recently first.</span>
<span class="sd">                The following fields are supported:</span>

<span class="sd">                - ``experiment_id``: Experiment ID</span>
<span class="sd">                - ``name``: Experiment name</span>
<span class="sd">                - ``creation_time``: Experiment creation time</span>
<span class="sd">                - ``last_update_time``: Experiment last update time</span>

<span class="sd">            page_token: Token specifying the next page of results. It should be obtained from</span>
<span class="sd">                a ``search_experiments`` call.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A :py:class:`PagedList &lt;mlflow.store.entities.PagedList&gt;` of</span>
<span class="sd">            :py:class:`Experiment &lt;mlflow.entities.Experiment&gt;` objects. The pagination token</span>
<span class="sd">            for the next page can be obtained via the ``token`` attribute of the object.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>


<span class="sd">            def assert_experiment_names_equal(experiments, expected_names):</span>
<span class="sd">                actual_names = [e.name for e in experiments if e.name != &quot;Default&quot;]</span>
<span class="sd">                assert actual_names == expected_names, (actual_names, expected_names)</span>


<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///:memory:&quot;)</span>
<span class="sd">            client = mlflow.MlflowClient()</span>

<span class="sd">            # Create experiments</span>
<span class="sd">            for name, tags in [</span>
<span class="sd">                (&quot;a&quot;, None),</span>
<span class="sd">                (&quot;b&quot;, None),</span>
<span class="sd">                (&quot;ab&quot;, {&quot;k&quot;: &quot;v&quot;}),</span>
<span class="sd">                (&quot;bb&quot;, {&quot;k&quot;: &quot;V&quot;}),</span>
<span class="sd">            ]:</span>
<span class="sd">                client.create_experiment(name, tags=tags)</span>

<span class="sd">            # Search for experiments with name &quot;a&quot;</span>
<span class="sd">            experiments = client.search_experiments(filter_string=&quot;name = &#39;a&#39;&quot;)</span>
<span class="sd">            assert_experiment_names_equal(experiments, [&quot;a&quot;])</span>

<span class="sd">            # Search for experiments with name starting with &quot;a&quot;</span>
<span class="sd">            experiments = client.search_experiments(filter_string=&quot;name LIKE &#39;a%&#39;&quot;)</span>
<span class="sd">            assert_experiment_names_equal(experiments, [&quot;ab&quot;, &quot;a&quot;])</span>

<span class="sd">            # Search for experiments with tag key &quot;k&quot; and value ending with &quot;v&quot; or &quot;V&quot;</span>
<span class="sd">            experiments = client.search_experiments(filter_string=&quot;tags.k ILIKE &#39;%v&#39;&quot;)</span>
<span class="sd">            assert_experiment_names_equal(experiments, [&quot;bb&quot;, &quot;ab&quot;])</span>

<span class="sd">            # Search for experiments with name ending with &quot;b&quot; and tag {&quot;k&quot;: &quot;v&quot;}</span>
<span class="sd">            experiments = client.search_experiments(filter_string=&quot;name LIKE &#39;%b&#39; AND tags.k = &#39;v&#39;&quot;)</span>
<span class="sd">            assert_experiment_names_equal(experiments, [&quot;ab&quot;])</span>

<span class="sd">            # Sort experiments by name in ascending order</span>
<span class="sd">            experiments = client.search_experiments(order_by=[&quot;name&quot;])</span>
<span class="sd">            assert_experiment_names_equal(experiments, [&quot;a&quot;, &quot;ab&quot;, &quot;b&quot;, &quot;bb&quot;])</span>

<span class="sd">            # Sort experiments by ID in descending order</span>
<span class="sd">            experiments = client.search_experiments(order_by=[&quot;experiment_id DESC&quot;])</span>
<span class="sd">            assert_experiment_names_equal(experiments, [&quot;bb&quot;, &quot;ab&quot;, &quot;b&quot;, &quot;a&quot;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">search_experiments</span><span class="p">(</span>
            <span class="n">view_type</span><span class="o">=</span><span class="n">view_type</span><span class="p">,</span>
            <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
            <span class="n">filter_string</span><span class="o">=</span><span class="n">filter_string</span><span class="p">,</span>
            <span class="n">order_by</span><span class="o">=</span><span class="n">order_by</span><span class="p">,</span>
            <span class="n">page_token</span><span class="o">=</span><span class="n">page_token</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.get_experiment"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.get_experiment">[docs]</a>    <span class="k">def</span> <span class="nf">get_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Experiment</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve an experiment by experiment_id from the backend store</span>

<span class="sd">        Args:</span>
<span class="sd">            experiment_id: The experiment ID returned from ``create_experiment``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :py:class:`mlflow.entities.Experiment`</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">          :caption: Example</span>

<span class="sd">          from mlflow import MlflowClient</span>

<span class="sd">          client = MlflowClient()</span>
<span class="sd">          exp_id = client.create_experiment(&quot;Experiment&quot;)</span>
<span class="sd">          experiment = client.get_experiment(exp_id)</span>

<span class="sd">          # Show experiment info</span>
<span class="sd">          print(f&quot;Name: {experiment.name}&quot;)</span>
<span class="sd">          print(f&quot;Experiment ID: {experiment.experiment_id}&quot;)</span>
<span class="sd">          print(f&quot;Artifact Location: {experiment.artifact_location}&quot;)</span>
<span class="sd">          print(f&quot;Lifecycle_stage: {experiment.lifecycle_stage}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">          :caption: Output</span>

<span class="sd">          Name: Experiment</span>
<span class="sd">          Experiment ID: 1</span>
<span class="sd">          Artifact Location: file:///.../mlruns/1</span>
<span class="sd">          Lifecycle_stage: active</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.get_experiment_by_name"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.get_experiment_by_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_experiment_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Experiment</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve an experiment by experiment name from the backend store</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The experiment name, which is case sensitive.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of :py:class:`mlflow.entities.Experiment`</span>
<span class="sd">            if an experiment with the specified name exists, otherwise None.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            # Case-sensitive name</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment = client.get_experiment_by_name(&quot;Default&quot;)</span>
<span class="sd">            # Show experiment info</span>
<span class="sd">            print(f&quot;Name: {experiment.name}&quot;)</span>
<span class="sd">            print(f&quot;Experiment ID: {experiment.experiment_id}&quot;)</span>
<span class="sd">            print(f&quot;Artifact Location: {experiment.artifact_location}&quot;)</span>
<span class="sd">            print(f&quot;Lifecycle_stage: {experiment.lifecycle_stage}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Name: Default</span>
<span class="sd">            Experiment ID: 0</span>
<span class="sd">            Artifact Location: file:///.../mlruns/0</span>
<span class="sd">            Lifecycle_stage: active</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">get_experiment_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.create_experiment"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.create_experiment">[docs]</a>    <span class="k">def</span> <span class="nf">create_experiment</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">artifact_location</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an experiment.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The experiment name, which must be a unique string.</span>
<span class="sd">            artifact_location: The location to store run artifacts. If not provided, the server</span>
<span class="sd">                picks anappropriate default.</span>
<span class="sd">            tags: A dictionary of key-value pairs that are converted into</span>
<span class="sd">                :py:class:`mlflow.entities.ExperimentTag` objects, set as</span>
<span class="sd">                experiment tags upon experiment creation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            String as an integer ID of the created experiment.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from pathlib import Path</span>
<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            # Create an experiment with a name that is unique and case sensitive.</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = client.create_experiment(</span>
<span class="sd">                &quot;Social NLP Experiments&quot;,</span>
<span class="sd">                artifact_location=Path.cwd().joinpath(&quot;mlruns&quot;).as_uri(),</span>
<span class="sd">                tags={&quot;version&quot;: &quot;v1&quot;, &quot;priority&quot;: &quot;P1&quot;},</span>
<span class="sd">            )</span>
<span class="sd">            client.set_experiment_tag(experiment_id, &quot;nlp.framework&quot;, &quot;Spark NLP&quot;)</span>

<span class="sd">            # Fetch experiment metadata information</span>
<span class="sd">            experiment = client.get_experiment(experiment_id)</span>
<span class="sd">            print(f&quot;Name: {experiment.name}&quot;)</span>
<span class="sd">            print(f&quot;Experiment_id: {experiment.experiment_id}&quot;)</span>
<span class="sd">            print(f&quot;Artifact Location: {experiment.artifact_location}&quot;)</span>
<span class="sd">            print(f&quot;Tags: {experiment.tags}&quot;)</span>
<span class="sd">            print(f&quot;Lifecycle_stage: {experiment.lifecycle_stage}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Name: Social NLP Experiments</span>
<span class="sd">            Experiment_id: 1</span>
<span class="sd">            Artifact Location: file:///.../mlruns</span>
<span class="sd">            Tags: {&#39;version&#39;: &#39;v1&#39;, &#39;priority&#39;: &#39;P1&#39;, &#39;nlp.framework&#39;: &#39;Spark NLP&#39;}</span>
<span class="sd">            Lifecycle_stage: active</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">create_experiment</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">artifact_location</span><span class="p">,</span> <span class="n">tags</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.delete_experiment"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.delete_experiment">[docs]</a>    <span class="k">def</span> <span class="nf">delete_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete an experiment from the backend store.</span>

<span class="sd">        This deletion is a soft-delete, not a permanent deletion. Experiment names can not be</span>
<span class="sd">        reused, unless the deleted experiment is permanently deleted by a database admin.</span>

<span class="sd">        Args:</span>
<span class="sd">            experiment_id: The experiment ID returned from ``create_experiment``.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            # Create an experiment with a name that is unique and case sensitive</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = client.create_experiment(&quot;New Experiment&quot;)</span>
<span class="sd">            client.delete_experiment(experiment_id)</span>

<span class="sd">            # Examine the deleted experiment details.</span>
<span class="sd">            experiment = client.get_experiment(experiment_id)</span>
<span class="sd">            print(f&quot;Name: {experiment.name}&quot;)</span>
<span class="sd">            print(f&quot;Artifact Location: {experiment.artifact_location}&quot;)</span>
<span class="sd">            print(f&quot;Lifecycle_stage: {experiment.lifecycle_stage}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Name: New Experiment</span>
<span class="sd">            Artifact Location: file:///.../mlruns/1</span>
<span class="sd">            Lifecycle_stage: deleted</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">delete_experiment</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.restore_experiment"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.restore_experiment">[docs]</a>    <span class="k">def</span> <span class="nf">restore_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Restore a deleted experiment unless permanently deleted.</span>

<span class="sd">        Args:</span>
<span class="sd">            experiment_id: The experiment ID returned from ``create_experiment``.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_experiment_info(experiment):</span>
<span class="sd">                print(f&quot;Name: {experiment.name}&quot;)</span>
<span class="sd">                print(f&quot;Experiment Id: {experiment.experiment_id}&quot;)</span>
<span class="sd">                print(f&quot;Lifecycle_stage: {experiment.lifecycle_stage}&quot;)</span>


<span class="sd">            # Create and delete an experiment</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = client.create_experiment(&quot;New Experiment&quot;)</span>
<span class="sd">            client.delete_experiment(experiment_id)</span>

<span class="sd">            # Examine the deleted experiment details.</span>
<span class="sd">            experiment = client.get_experiment(experiment_id)</span>
<span class="sd">            print_experiment_info(experiment)</span>
<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # Restore the experiment and fetch its info</span>
<span class="sd">            client.restore_experiment(experiment_id)</span>
<span class="sd">            experiment = client.get_experiment(experiment_id)</span>
<span class="sd">            print_experiment_info(experiment)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Name: New Experiment</span>
<span class="sd">            Experiment Id: 1</span>
<span class="sd">            Lifecycle_stage: deleted</span>
<span class="sd">            --</span>
<span class="sd">            Name: New Experiment</span>
<span class="sd">            Experiment Id: 1</span>
<span class="sd">            Lifecycle_stage: active</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">restore_experiment</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.rename_experiment"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.rename_experiment">[docs]</a>    <span class="k">def</span> <span class="nf">rename_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update an experiment&#39;s name. The new name must be unique.</span>

<span class="sd">        Args:</span>
<span class="sd">            experiment_id: The experiment ID returned from ``create_experiment``.</span>
<span class="sd">            new_name: The new name for the experiment.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_experiment_info(experiment):</span>
<span class="sd">                print(f&quot;Name: {experiment.name}&quot;)</span>
<span class="sd">                print(f&quot;Experiment_id: {experiment.experiment_id}&quot;)</span>
<span class="sd">                print(f&quot;Lifecycle_stage: {experiment.lifecycle_stage}&quot;)</span>


<span class="sd">            # Create an experiment with a name that is unique and case sensitive</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = client.create_experiment(&quot;Social NLP Experiments&quot;)</span>

<span class="sd">            # Fetch experiment metadata information</span>
<span class="sd">            experiment = client.get_experiment(experiment_id)</span>
<span class="sd">            print_experiment_info(experiment)</span>
<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # Rename and fetch experiment metadata information</span>
<span class="sd">            client.rename_experiment(experiment_id, &quot;Social Media NLP Experiments&quot;)</span>
<span class="sd">            experiment = client.get_experiment(experiment_id)</span>
<span class="sd">            print_experiment_info(experiment)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Name: Social NLP Experiments</span>
<span class="sd">            Experiment_id: 1</span>
<span class="sd">            Lifecycle_stage: active</span>
<span class="sd">            --</span>
<span class="sd">            Name: Social Media NLP Experiments</span>
<span class="sd">            Experiment_id: 1</span>
<span class="sd">            Lifecycle_stage: active</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">rename_experiment</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.log_metric"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.log_metric">[docs]</a>    <span class="k">def</span> <span class="nf">log_metric</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">step</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">synchronous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunOperations</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Log a metric against the run ID.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: The run id to which the metric should be logged.</span>
<span class="sd">            key: Metric name. This string may only contain alphanumerics, underscores</span>
<span class="sd">                (_), dashes (-), periods (.), spaces ( ), and slashes (/).</span>
<span class="sd">                All backend stores will support keys up to length 250, but some may</span>
<span class="sd">                support larger keys.</span>
<span class="sd">            value: Metric value. Note that some special values such</span>
<span class="sd">                as +/- Infinity may be replaced by other values depending on the store. For</span>
<span class="sd">                example, the SQLAlchemy store replaces +/- Inf with max / min float values.</span>
<span class="sd">                All backend stores will support values up to length 5000, but some</span>
<span class="sd">                may support larger values.</span>
<span class="sd">            timestamp: Time when this metric was calculated. Defaults to the current system time.</span>
<span class="sd">            step: Integer training step (iteration) at which was the metric calculated.</span>
<span class="sd">                Defaults to 0.</span>
<span class="sd">            synchronous: *Experimental* If True, blocks until the metric is logged successfully.</span>
<span class="sd">                If False, logs the metric asynchronously and returns a future representing the</span>
<span class="sd">                logging operation. If None, read from environment variable</span>
<span class="sd">                `MLFLOW_ENABLE_ASYNC_LOGGING`, which defaults to False if not set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            When `synchronous=True` or None, returns None. When `synchronous=False`, returns an</span>
<span class="sd">            :py:class:`mlflow.utils.async_logging.run_operations.RunOperations` instance that</span>
<span class="sd">            represents future for logging operation.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_run_info(r):</span>
<span class="sd">                print(f&quot;run_id: {r.info.run_id}&quot;)</span>
<span class="sd">                print(f&quot;metrics: {r.data.metrics}&quot;)</span>
<span class="sd">                print(f&quot;status: {r.info.status}&quot;)</span>


<span class="sd">            # Create a run under the default experiment (whose id is &#39;0&#39;).</span>
<span class="sd">            # Since these are low-level CRUD operations, this method will create a run.</span>
<span class="sd">            # To end the run, you&#39;ll have to explicitly end it.</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = &quot;0&quot;</span>
<span class="sd">            run = client.create_run(experiment_id)</span>
<span class="sd">            print_run_info(run)</span>
<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # Log the metric. Unlike mlflow.log_metric this method</span>
<span class="sd">            # does not start a run if one does not exist. It will log</span>
<span class="sd">            # the metric for the run id in the backend store.</span>
<span class="sd">            client.log_metric(run.info.run_id, &quot;m&quot;, 1.5)</span>
<span class="sd">            client.set_terminated(run.info.run_id)</span>
<span class="sd">            run = client.get_run(run.info.run_id)</span>
<span class="sd">            print_run_info(run)</span>

<span class="sd">            # To log metric in async fashion</span>
<span class="sd">            client.log_metric(run.info.run_id, &quot;m&quot;, 1.5, synchronous=False)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            run_id: 95e79843cb2c463187043d9065185e24</span>
<span class="sd">            metrics: {}</span>
<span class="sd">            status: RUNNING</span>
<span class="sd">            --</span>
<span class="sd">            run_id: 95e79843cb2c463187043d9065185e24</span>
<span class="sd">            metrics: {&#39;m&#39;: 1.5}</span>
<span class="sd">            status: FINISHED</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">synchronous</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">synchronous</span> <span class="k">if</span> <span class="n">synchronous</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="ow">not</span> <span class="n">MLFLOW_ENABLE_ASYNC_LOGGING</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span>
            <span class="n">run_id</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">synchronous</span><span class="o">=</span><span class="n">synchronous</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.log_param"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.log_param">[docs]</a>    <span class="k">def</span> <span class="nf">log_param</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">synchronous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Log a parameter (e.g. model hyperparameter) against the run ID.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: The run id to which the param should be logged.</span>
<span class="sd">            key: Parameter name. This string may only contain alphanumerics, underscores</span>
<span class="sd">                (_), dashes (-), periods (.), spaces ( ), and slashes (/).</span>
<span class="sd">                All backend stores support keys up to length 250, but some may</span>
<span class="sd">                support larger keys.</span>
<span class="sd">            value: Parameter value, but will be string-ified if not.</span>
<span class="sd">                All built-in backend stores support values up to length 6000, but some</span>
<span class="sd">                may support larger values.</span>
<span class="sd">            synchronous: *Experimental* If True, blocks until the metric is logged successfully.</span>
<span class="sd">                If False, logs the metric asynchronously and returns a future representing the</span>
<span class="sd">                logging operation. If None, read from environment variable</span>
<span class="sd">                `MLFLOW_ENABLE_ASYNC_LOGGING`, which defaults to False if not set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            When `synchronous=True` or None, returns parameter value. When `synchronous=False`,</span>
<span class="sd">            returns an :py:class:`mlflow.utils.async_logging.run_operations.RunOperations`</span>
<span class="sd">            instance that represents future for logging operation.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_run_info(r):</span>
<span class="sd">                print(f&quot;run_id: {r.info.run_id}&quot;)</span>
<span class="sd">                print(f&quot;params: {r.data.params}&quot;)</span>
<span class="sd">                print(f&quot;status: {r.info.status}&quot;)</span>


<span class="sd">            # Create a run under the default experiment (whose id is &#39;0&#39;).</span>
<span class="sd">            # Since these are low-level CRUD operations, this method will create a run.</span>
<span class="sd">            # To end the run, you&#39;ll have to explicitly end it.</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = &quot;0&quot;</span>
<span class="sd">            run = client.create_run(experiment_id)</span>
<span class="sd">            print_run_info(run)</span>
<span class="sd">            print(&quot;--&quot;)</span>
<span class="sd">            # Log the parameter. Unlike mlflow.log_param this method</span>
<span class="sd">            # does not start a run if one does not exist. It will log</span>
<span class="sd">            # the parameter in the backend store</span>
<span class="sd">            p_value = client.log_param(run.info.run_id, &quot;p&quot;, 1)</span>
<span class="sd">            assert p_value == 1</span>
<span class="sd">            client.set_terminated(run.info.run_id)</span>
<span class="sd">            run = client.get_run(run.info.run_id)</span>
<span class="sd">            print_run_info(run)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            run_id: e649e49c7b504be48ee3ae33c0e76c93</span>
<span class="sd">            params: {}</span>
<span class="sd">            status: RUNNING</span>
<span class="sd">            --</span>
<span class="sd">            run_id: e649e49c7b504be48ee3ae33c0e76c93</span>
<span class="sd">            params: {&#39;p&#39;: &#39;1&#39;}</span>
<span class="sd">            status: FINISHED</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">synchronous</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">synchronous</span> <span class="k">if</span> <span class="n">synchronous</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="ow">not</span> <span class="n">MLFLOW_ENABLE_ASYNC_LOGGING</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">synchronous</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">log_param</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">synchronous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">log_param</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">synchronous</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.set_experiment_tag"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.set_experiment_tag">[docs]</a>    <span class="k">def</span> <span class="nf">set_experiment_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a tag on the experiment with the specified ID. Value is converted to a string.</span>

<span class="sd">        Args:</span>
<span class="sd">            experiment_id: String ID of the experiment.</span>
<span class="sd">            key: Name of the tag.</span>
<span class="sd">            value: Tag value (converted to a string).</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            # Create an experiment and set its tag</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = client.create_experiment(&quot;Social Media NLP Experiments&quot;)</span>
<span class="sd">            client.set_experiment_tag(experiment_id, &quot;nlp.framework&quot;, &quot;Spark NLP&quot;)</span>

<span class="sd">            # Fetch experiment metadata information</span>
<span class="sd">            experiment = client.get_experiment(experiment_id)</span>
<span class="sd">            print(f&quot;Name: {experiment.name}&quot;)</span>
<span class="sd">            print(f&quot;Tags: {experiment.tags}&quot;)</span>

<span class="sd">        .. code-block:: text</span>

<span class="sd">            Name: Social Media NLP Experiments</span>
<span class="sd">            Tags: {&#39;nlp.framework&#39;: &#39;Spark NLP&#39;}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">set_experiment_tag</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.set_tag"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.set_tag">[docs]</a>    <span class="k">def</span> <span class="nf">set_tag</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">synchronous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunOperations</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a tag on the run with the specified ID. Value is converted to a string.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: String ID of the run.</span>
<span class="sd">            key: Tag name. This string may only contain alphanumerics, underscores (_), dashes (-),</span>
<span class="sd">                periods (.), spaces ( ), and slashes (/). All backend stores will support keys up to</span>
<span class="sd">                length 250, but some may support larger keys.</span>
<span class="sd">            value: Tag value, but will be string-ified if not. All backend stores will support</span>
<span class="sd">                values up to length 5000, but some may support larger values.</span>
<span class="sd">            synchronous: *Experimental* If True, blocks until the metric is logged successfully.</span>
<span class="sd">                If False, logs the metric asynchronously and returns a future representing the</span>
<span class="sd">                logging operation. If None, read from environment variable</span>
<span class="sd">                `MLFLOW_ENABLE_ASYNC_LOGGING`, which defaults to False if not set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            When `synchronous=True` or None, returns None. When `synchronous=False`, returns an</span>
<span class="sd">            `mlflow.utils.async_logging.run_operations.RunOperations` instance that represents</span>
<span class="sd">            future for logging operation.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_run_info(run):</span>
<span class="sd">                print(f&quot;run_id: {run.info.run_id}&quot;)</span>
<span class="sd">                print(f&quot;Tags: {run.data.tags}&quot;)</span>


<span class="sd">            # Create a run under the default experiment (whose id is &#39;0&#39;).</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = &quot;0&quot;</span>
<span class="sd">            run = client.create_run(experiment_id)</span>
<span class="sd">            print_run_info(run)</span>
<span class="sd">            print(&quot;--&quot;)</span>
<span class="sd">            # Set a tag and fetch updated run info</span>
<span class="sd">            client.set_tag(run.info.run_id, &quot;nlp.framework&quot;, &quot;Spark NLP&quot;)</span>
<span class="sd">            run = client.get_run(run.info.run_id)</span>
<span class="sd">            print_run_info(run)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            run_id: 4f226eb5758145e9b28f78514b59a03b</span>
<span class="sd">            Tags: {}</span>
<span class="sd">            --</span>
<span class="sd">            run_id: 4f226eb5758145e9b28f78514b59a03b</span>
<span class="sd">            Tags: {&#39;nlp.framework&#39;: &#39;Spark NLP&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">synchronous</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">synchronous</span> <span class="k">if</span> <span class="n">synchronous</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="ow">not</span> <span class="n">MLFLOW_ENABLE_ASYNC_LOGGING</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">set_tag</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">synchronous</span><span class="o">=</span><span class="n">synchronous</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.delete_tag"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.delete_tag">[docs]</a>    <span class="k">def</span> <span class="nf">delete_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete a tag from a run. This is irreversible.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: String ID of the run.</span>
<span class="sd">            key: Name of the tag.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_run_info(run):</span>
<span class="sd">                print(f&quot;run_id: {run.info.run_id}&quot;)</span>
<span class="sd">                print(f&quot;Tags: {run.data.tags}&quot;)</span>


<span class="sd">            # Create a run under the default experiment (whose id is &#39;0&#39;).</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            tags = {&quot;t1&quot;: 1, &quot;t2&quot;: 2}</span>
<span class="sd">            experiment_id = &quot;0&quot;</span>
<span class="sd">            run = client.create_run(experiment_id, tags=tags)</span>
<span class="sd">            print_run_info(run)</span>
<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # Delete tag and fetch updated info</span>
<span class="sd">            client.delete_tag(run.info.run_id, &quot;t1&quot;)</span>
<span class="sd">            run = client.get_run(run.info.run_id)</span>
<span class="sd">            print_run_info(run)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            run_id: b7077267a59a45d78cd9be0de4bc41f5</span>
<span class="sd">            Tags: {&#39;t2&#39;: &#39;2&#39;, &#39;t1&#39;: &#39;1&#39;}</span>
<span class="sd">            --</span>
<span class="sd">            run_id: b7077267a59a45d78cd9be0de4bc41f5</span>
<span class="sd">            Tags: {&#39;t2&#39;: &#39;2&#39;}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">delete_tag</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.update_run"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.update_run">[docs]</a>    <span class="k">def</span> <span class="nf">update_run</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update a run with the specified ID to a new status or name.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: The ID of the Run to update.</span>
<span class="sd">            status: The new status of the run to set, if specified. At least one of ``status`` or</span>
<span class="sd">                ``name`` should be specified.</span>
<span class="sd">            name: The new name of the run to set, if specified. At least one of ``name`` or</span>
<span class="sd">                ``status`` should be specified.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_run_info(run):</span>
<span class="sd">                print(f&quot;run_id: {run.info.run_id}&quot;)</span>
<span class="sd">                print(f&quot;run_name: {run.info.run_name}&quot;)</span>
<span class="sd">                print(f&quot;status: {run.info.status}&quot;)</span>


<span class="sd">            # Create a run under the default experiment (whose id is &#39;0&#39;).</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = &quot;0&quot;</span>
<span class="sd">            run = client.create_run(experiment_id)</span>
<span class="sd">            print_run_info(run)</span>
<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # Update run and fetch info</span>
<span class="sd">            client.update_run(run.info.run_id, &quot;FINISHED&quot;, &quot;new_name&quot;)</span>
<span class="sd">            run = client.get_run(run.info.run_id)</span>
<span class="sd">            print_run_info(run)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            run_id: 1cf6bf8bf6484dd8a598bd43be367b20</span>
<span class="sd">            run_name: judicious-hog-915</span>
<span class="sd">            status: RUNNING</span>
<span class="sd">            --</span>
<span class="sd">            run_id: 1cf6bf8bf6484dd8a598bd43be367b20</span>
<span class="sd">            run_name: new_name</span>
<span class="sd">            status: FINISHED</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">update_run</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.log_batch"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.log_batch">[docs]</a>    <span class="k">def</span> <span class="nf">log_batch</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">metrics</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Metric</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">params</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Param</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">tags</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">RunTag</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">synchronous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunOperations</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Log multiple metrics, params, and/or tags.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: String ID of the run</span>
<span class="sd">            metrics: If provided, List of Metric(key, value, timestamp) instances.</span>
<span class="sd">            params: If provided, List of Param(key, value) instances.</span>
<span class="sd">            tags: If provided, List of RunTag(key, value) instances.</span>
<span class="sd">            synchronous: *Experimental* If True, blocks until the metric is logged successfully.</span>
<span class="sd">                If False, logs the metric asynchronously and returns a future representing the</span>
<span class="sd">                logging operation. If None, read from environment variable</span>
<span class="sd">                `MLFLOW_ENABLE_ASYNC_LOGGING`, which defaults to False if not set.</span>

<span class="sd">        Raises:</span>
<span class="sd">            mlflow.MlflowException: If any errors occur.</span>

<span class="sd">        Returns:</span>
<span class="sd">            When `synchronous=True` or None, returns None. When `synchronous=False`, returns an</span>
<span class="sd">            :py:class:`mlflow.utils.async_logging.run_operations.RunOperations` instance that</span>
<span class="sd">            represents future for logging operation.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import time</span>

<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.entities import Metric, Param, RunTag</span>


<span class="sd">            def print_run_info(r):</span>
<span class="sd">                print(f&quot;run_id: {r.info.run_id}&quot;)</span>
<span class="sd">                print(f&quot;params: {r.data.params}&quot;)</span>
<span class="sd">                print(f&quot;metrics: {r.data.metrics}&quot;)</span>
<span class="sd">                print(f&quot;tags: {r.data.tags}&quot;)</span>
<span class="sd">                print(f&quot;status: {r.info.status}&quot;)</span>


<span class="sd">            # Create MLflow entities and a run under the default experiment (whose id is &#39;0&#39;).</span>
<span class="sd">            timestamp = int(time.time() * 1000)</span>
<span class="sd">            metrics = [Metric(&quot;m&quot;, 1.5, timestamp, 1)]</span>
<span class="sd">            params = [Param(&quot;p&quot;, &quot;p&quot;)]</span>
<span class="sd">            tags = [RunTag(&quot;t&quot;, &quot;t&quot;)]</span>
<span class="sd">            experiment_id = &quot;0&quot;</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            run = client.create_run(experiment_id)</span>

<span class="sd">            # Log entities, terminate the run, and fetch run status</span>
<span class="sd">            client.log_batch(run.info.run_id, metrics=metrics, params=params, tags=tags)</span>
<span class="sd">            client.set_terminated(run.info.run_id)</span>
<span class="sd">            run = client.get_run(run.info.run_id)</span>
<span class="sd">            print_run_info(run)</span>

<span class="sd">            # To log metric in async fashion</span>
<span class="sd">            client.log_metric(run.info.run_id, &quot;m&quot;, 1.5, synchronous=False)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            run_id: ef0247fa3205410595acc0f30f620871</span>
<span class="sd">            params: {&#39;p&#39;: &#39;p&#39;}</span>
<span class="sd">            metrics: {&#39;m&#39;: 1.5}</span>
<span class="sd">            tags: {&#39;t&#39;: &#39;t&#39;}</span>
<span class="sd">            status: FINISHED</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">synchronous</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">synchronous</span> <span class="k">if</span> <span class="n">synchronous</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="ow">not</span> <span class="n">MLFLOW_ENABLE_ASYNC_LOGGING</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">log_batch</span><span class="p">(</span>
            <span class="n">run_id</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">synchronous</span><span class="o">=</span><span class="n">synchronous</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.log_inputs"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.log_inputs">[docs]</a>    <span class="k">def</span> <span class="nf">log_inputs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">datasets</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">DatasetInput</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Log one or more dataset inputs to a run.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: String ID of the run.</span>
<span class="sd">            datasets: List of :py:class:`mlflow.entities.DatasetInput` instances to log.</span>

<span class="sd">        Raises:</span>
<span class="sd">            mlflow.MlflowException: If any errors occur.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">log_inputs</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">datasets</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.log_artifact"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.log_artifact">[docs]</a>    <span class="k">def</span> <span class="nf">log_artifact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">artifact_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a local file or directory to the remote ``artifact_uri``.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: String ID of run.</span>
<span class="sd">            local_path: Path to the file or directory to write.</span>
<span class="sd">            artifact_path: If provided, the directory in ``artifact_uri`` to write to.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import tempfile</span>
<span class="sd">            from pathlib import Path</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            # Create a run under the default experiment (whose id is &#39;0&#39;).</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = &quot;0&quot;</span>
<span class="sd">            run = client.create_run(experiment_id)</span>

<span class="sd">            # log and fetch the artifact</span>
<span class="sd">            with tempfile.TemporaryDirectory() as tmp_dir:</span>
<span class="sd">                path = Path(tmp_dir, &quot;features.txt&quot;)</span>
<span class="sd">                path.write_text(features)</span>
<span class="sd">                client.log_artifact(run.info.run_id, path)</span>

<span class="sd">            artifacts = client.list_artifacts(run.info.run_id)</span>
<span class="sd">            for artifact in artifacts:</span>
<span class="sd">                print(f&quot;artifact: {artifact.path}&quot;)</span>
<span class="sd">                print(f&quot;is_dir: {artifact.is_dir}&quot;)</span>
<span class="sd">            client.set_terminated(run.info.run_id)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            artifact: features.txt</span>
<span class="sd">            is_dir: False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">run_id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">TRACE_REQUEST_ID_PREFIX</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid run id: </span><span class="si">{</span><span class="n">run_id</span><span class="si">}</span><span class="s2">. `log_artifact` run id must map to a valid run.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">log_artifact</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">artifact_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.log_artifacts"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.log_artifacts">[docs]</a>    <span class="k">def</span> <span class="nf">log_artifacts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">local_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">artifact_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a directory of files to the remote ``artifact_uri``.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: String ID of run.</span>
<span class="sd">            local_dir: Path to the directory of files to write.</span>
<span class="sd">            artifact_path: If provided, the directory in ``artifact_uri`` to write to.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import json</span>
<span class="sd">            import tempfile</span>
<span class="sd">            from pathlib import Path</span>

<span class="sd">            # Create some artifacts data to preserve</span>
<span class="sd">            features = &quot;rooms, zipcode, median_price, school_rating, transport&quot;</span>
<span class="sd">            data = {&quot;state&quot;: &quot;TX&quot;, &quot;Available&quot;: 25, &quot;Type&quot;: &quot;Detached&quot;}</span>
<span class="sd">            with tempfile.TemporaryDirectory() as tmp_dir:</span>
<span class="sd">                tmp_dir = Path(tmp_dir)</span>
<span class="sd">                with (tmp_dir / &quot;data.json&quot;).open(&quot;w&quot;) as f:</span>
<span class="sd">                    json.dump(data, f, indent=2)</span>
<span class="sd">                with (tmp_dir / &quot;features.json&quot;).open(&quot;w&quot;) as f:</span>
<span class="sd">                    f.write(features)</span>

<span class="sd">                # Create a run under the default experiment (whose id is &#39;0&#39;), and log</span>
<span class="sd">                # all files in &quot;data&quot; to root artifact_uri/states</span>
<span class="sd">                client = MlflowClient()</span>
<span class="sd">                experiment_id = &quot;0&quot;</span>
<span class="sd">                run = client.create_run(experiment_id)</span>
<span class="sd">                client.log_artifacts(run.info.run_id, tmp_dir, artifact_path=&quot;states&quot;)</span>

<span class="sd">            artifacts = client.list_artifacts(run.info.run_id)</span>
<span class="sd">            for artifact in artifacts:</span>
<span class="sd">                print(f&quot;artifact: {artifact.path}&quot;)</span>
<span class="sd">                print(f&quot;is_dir: {artifact.is_dir}&quot;)</span>
<span class="sd">            client.set_terminated(run.info.run_id)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            artifact: states</span>
<span class="sd">            is_dir: True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">log_artifacts</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">local_dir</span><span class="p">,</span> <span class="n">artifact_path</span><span class="p">)</span></div>

    <span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
    <span class="k">def</span> <span class="nf">_log_artifact_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Yields a temporary path to store a file, and then calls `log_artifact` against that path.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: String ID of the run.</span>
<span class="sd">            artifact_file: The run-relative artifact file path in posixpath format.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Temporary path to store a file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">norm_path</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">artifact_file</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">norm_path</span><span class="p">)</span>
        <span class="n">artifact_dir</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">norm_path</span><span class="p">)</span>
        <span class="n">artifact_dir</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">artifact_dir</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="n">artifact_dir</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmp_dir</span><span class="p">:</span>
            <span class="n">tmp_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">tmp_path</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log_artifact</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">tmp_path</span><span class="p">,</span> <span class="n">artifact_dir</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_log_artifact_async_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">,</span> <span class="n">artifact</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log artifact asynchronously.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: The unique identifier for the run. This ID is used to associate the</span>
<span class="sd">                artifact with a specific run.</span>
<span class="sd">            artifact_file: The file path of the artifact relative to the run&#39;s directory.</span>
<span class="sd">                The path should be in POSIX format, using forward slashes (/) as directory</span>
<span class="sd">                separators.</span>
<span class="sd">            artifact: The artifact to be logged.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">norm_path</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">artifact_file</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">norm_path</span><span class="p">)</span>
        <span class="n">artifact_dir</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">norm_path</span><span class="p">)</span>
        <span class="n">artifact_dir</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">artifact_dir</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="n">artifact_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">_log_artifact_async</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">artifact_dir</span><span class="p">,</span> <span class="n">artifact</span><span class="p">)</span>

<div class="viewcode-block" id="MlflowClient.log_text"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.log_text">[docs]</a>    <span class="k">def</span> <span class="nf">log_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log text as an artifact.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: String ID of the run.</span>
<span class="sd">            text: String containing text to log.</span>
<span class="sd">            artifact_file: The run-relative artifact file path in posixpath format to which</span>
<span class="sd">                the text is saved (e.g. &quot;dir/file.txt&quot;).</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            client = MlflowClient()</span>
<span class="sd">            run = client.create_run(experiment_id=&quot;0&quot;)</span>

<span class="sd">            # Log text to a file under the run&#39;s root artifact directory</span>
<span class="sd">            client.log_text(run.info.run_id, &quot;text1&quot;, &quot;file1.txt&quot;)</span>

<span class="sd">            # Log text in a subdirectory of the run&#39;s root artifact directory</span>
<span class="sd">            client.log_text(run.info.run_id, &quot;text2&quot;, &quot;dir/file2.txt&quot;)</span>

<span class="sd">            # Log HTML text</span>
<span class="sd">            client.log_text(run.info.run_id, &quot;&lt;h1&gt;header&lt;/h1&gt;&quot;, &quot;index.html&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_artifact_helper</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp_path</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.log_dict"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.log_dict">[docs]</a>    <span class="k">def</span> <span class="nf">log_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">artifact_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log a JSON/YAML-serializable object (e.g. `dict`) as an artifact. The serialization</span>
<span class="sd">        format (JSON or YAML) is automatically inferred from the extension of `artifact_file`.</span>
<span class="sd">        If the file extension doesn&#39;t exist or match any of [&quot;.json&quot;, &quot;.yml&quot;, &quot;.yaml&quot;],</span>
<span class="sd">        JSON format is used, and we stringify objects that can&#39;t be JSON-serialized.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: String ID of the run.</span>
<span class="sd">            dictionary: Dictionary to log.</span>
<span class="sd">            artifact_file: The run-relative artifact file path in posixpath format to which</span>
<span class="sd">                the dictionary is saved (e.g. &quot;dir/data.json&quot;).</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            client = MlflowClient()</span>
<span class="sd">            run = client.create_run(experiment_id=&quot;0&quot;)</span>
<span class="sd">            run_id = run.info.run_id</span>

<span class="sd">            dictionary = {&quot;k&quot;: &quot;v&quot;}</span>

<span class="sd">            # Log a dictionary as a JSON file under the run&#39;s root artifact directory</span>
<span class="sd">            client.log_dict(run_id, dictionary, &quot;data.json&quot;)</span>

<span class="sd">            # Log a dictionary as a YAML file in a subdirectory of the run&#39;s root artifact directory</span>
<span class="sd">            client.log_dict(run_id, dictionary, &quot;dir/data.yml&quot;)</span>

<span class="sd">            # If the file extension doesn&#39;t exist or match any of [&quot;.json&quot;, &quot;.yaml&quot;, &quot;.yml&quot;],</span>
<span class="sd">            # JSON format is used.</span>
<span class="sd">            mlflow.log_dict(run_id, dictionary, &quot;data&quot;)</span>
<span class="sd">            mlflow.log_dict(run_id, dictionary, &quot;data.txt&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">artifact_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_artifact_helper</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp_path</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="c1"># Specify `indent` to prettify the output</span>
                <span class="k">if</span> <span class="n">extension</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.yml&quot;</span><span class="p">,</span> <span class="s2">&quot;.yaml&quot;</span><span class="p">]:</span>
                    <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">dictionary</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Stringify objects that can&#39;t be JSON-serialized</span>
                    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">dictionary</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.log_figure"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.log_figure">[docs]</a>    <span class="k">def</span> <span class="nf">log_figure</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">figure</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;matplotlib.figure.Figure&quot;</span><span class="p">,</span> <span class="s2">&quot;plotly.graph_objects.Figure&quot;</span><span class="p">],</span>
        <span class="n">artifact_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">save_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log a figure as an artifact. The following figure objects are supported:</span>

<span class="sd">        - `matplotlib.figure.Figure`_</span>
<span class="sd">        - `plotly.graph_objects.Figure`_</span>

<span class="sd">        .. _matplotlib.figure.Figure:</span>
<span class="sd">            https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html</span>

<span class="sd">        .. _plotly.graph_objects.Figure:</span>
<span class="sd">            https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: String ID of the run.</span>
<span class="sd">            figure: Figure to log.</span>
<span class="sd">            artifact_file: The run-relative artifact file path in posixpath format to which</span>
<span class="sd">                the figure is saved (e.g. &quot;dir/file.png&quot;).</span>
<span class="sd">            save_kwargs: Additional keyword arguments passed to the method that saves the figure.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Matplotlib Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            import matplotlib.pyplot as plt</span>

<span class="sd">            fig, ax = plt.subplots()</span>
<span class="sd">            ax.plot([0, 1], [2, 3])</span>

<span class="sd">            run = client.create_run(experiment_id=&quot;0&quot;)</span>
<span class="sd">            client.log_figure(run.info.run_id, fig, &quot;figure.png&quot;)</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Plotly Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from plotly import graph_objects as go</span>

<span class="sd">            fig = go.Figure(go.Scatter(x=[0, 1], y=[2, 3]))</span>

<span class="sd">            run = client.create_run(experiment_id=&quot;0&quot;)</span>
<span class="sd">            client.log_figure(run.info.run_id, fig, &quot;figure.html&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_is_matplotlib_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
            <span class="kn">import</span> <span class="nn">matplotlib.figure</span>

            <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_is_plotly_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
            <span class="kn">import</span> <span class="nn">plotly</span>

            <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">plotly</span><span class="o">.</span><span class="n">graph_objects</span><span class="o">.</span><span class="n">Figure</span><span class="p">)</span>

        <span class="n">save_kwargs</span> <span class="o">=</span> <span class="n">save_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_artifact_helper</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp_path</span><span class="p">:</span>
            <span class="c1"># `is_matplotlib_figure` is executed only when `matplotlib` is found in `sys.modules`.</span>
            <span class="c1"># This allows logging a `plotly` figure in an environment where `matplotlib` is not</span>
            <span class="c1"># installed.</span>
            <span class="k">if</span> <span class="s2">&quot;matplotlib&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span> <span class="ow">and</span> <span class="n">_is_matplotlib_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">):</span>
                <span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="o">**</span><span class="n">save_kwargs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s2">&quot;plotly&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span> <span class="ow">and</span> <span class="n">_is_plotly_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">):</span>
                <span class="n">file_extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">artifact_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">file_extension</span> <span class="o">==</span> <span class="s2">&quot;.html&quot;</span><span class="p">:</span>
                    <span class="n">save_kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;include_plotlyjs&quot;</span><span class="p">,</span> <span class="s2">&quot;cdn&quot;</span><span class="p">)</span>
                    <span class="n">save_kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;auto_open&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                    <span class="n">figure</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="o">**</span><span class="n">save_kwargs</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">file_extension</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="s2">&quot;.jpeg&quot;</span><span class="p">,</span> <span class="s2">&quot;.webp&quot;</span><span class="p">,</span> <span class="s2">&quot;.svg&quot;</span><span class="p">,</span> <span class="s2">&quot;.pdf&quot;</span><span class="p">]:</span>
                    <span class="n">figure</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="o">**</span><span class="n">save_kwargs</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Unsupported file extension for plotly figure: &#39;</span><span class="si">{</span><span class="n">file_extension</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported figure object type: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.log_image"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.log_image">[docs]</a>    <span class="k">def</span> <span class="nf">log_image</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;numpy.ndarray&quot;</span><span class="p">,</span> <span class="s2">&quot;PIL.Image.Image&quot;</span><span class="p">,</span> <span class="s2">&quot;mlflow.Image&quot;</span><span class="p">],</span>
        <span class="n">artifact_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">step</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">synchronous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Logs an image in MLflow, supporting two use cases:</span>

<span class="sd">        1. Time-stepped image logging:</span>
<span class="sd">            Ideal for tracking changes or progressions through iterative processes (e.g.,</span>
<span class="sd">            during model training phases).</span>

<span class="sd">            - Usage: :code:`log_image(image, key=key, step=step, timestamp=timestamp)`</span>

<span class="sd">        2. Artifact file image logging:</span>
<span class="sd">            Best suited for static image logging where the image is saved directly as a file</span>
<span class="sd">            artifact.</span>

<span class="sd">            - Usage: :code:`log_image(image, artifact_file)`</span>

<span class="sd">        The following image formats are supported:</span>
<span class="sd">            - `numpy.ndarray`_</span>
<span class="sd">            - `PIL.Image.Image`_</span>

<span class="sd">            .. _numpy.ndarray:</span>
<span class="sd">                https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html</span>

<span class="sd">            .. _PIL.Image.Image:</span>
<span class="sd">                https://pillow.readthedocs.io/en/stable/reference/Image.html#PIL.Image.Image</span>

<span class="sd">            - :class:`mlflow.Image`: An MLflow wrapper around PIL image for convenient image</span>
<span class="sd">              logging.</span>

<span class="sd">        Numpy array support</span>
<span class="sd">            - data types:</span>

<span class="sd">                - bool (useful for logging image masks)</span>
<span class="sd">                - integer [0, 255]</span>
<span class="sd">                - unsigned integer [0, 255]</span>
<span class="sd">                - float [0.0, 1.0]</span>

<span class="sd">                .. warning::</span>

<span class="sd">                    - Out-of-range integer values will raise ValueError.</span>
<span class="sd">                    - Out-of-range float values will auto-scale with min/max and warn.</span>

<span class="sd">            - shape (H: height, W: width):</span>

<span class="sd">                - H x W (Grayscale)</span>
<span class="sd">                - H x W x 1 (Grayscale)</span>
<span class="sd">                - H x W x 3 (an RGB channel order is assumed)</span>
<span class="sd">                - H x W x 4 (an RGBA channel order is assumed)</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: String ID of run.</span>
<span class="sd">            image: The image object to be logged.</span>
<span class="sd">            artifact_file: Specifies the path, in POSIX format, where the image</span>
<span class="sd">                will be stored as an artifact relative to the run&#39;s root directory (for</span>
<span class="sd">                example, &quot;dir/image.png&quot;). This parameter is kept for backward compatibility</span>
<span class="sd">                and should not be used together with `key`, `step`, or `timestamp`.</span>
<span class="sd">            key: Image name for time-stepped image logging. This string may only contain</span>
<span class="sd">                alphanumerics, underscores (_), dashes (-), periods (.), spaces ( ), and</span>
<span class="sd">                slashes (/).</span>
<span class="sd">            step: Integer training step (iteration) at which the image was saved.</span>
<span class="sd">                Defaults to 0.</span>
<span class="sd">            timestamp: Time when this image was saved. Defaults to the current system time.</span>
<span class="sd">            synchronous: *Experimental* If True, blocks until the metric is logged successfully.</span>
<span class="sd">                If False, logs the metric asynchronously and returns a future representing the</span>
<span class="sd">                logging operation. If None, read from environment variable</span>
<span class="sd">                `MLFLOW_ENABLE_ASYNC_LOGGING`, which defaults to False if not set.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Time-stepped image logging numpy example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            import numpy as np</span>

<span class="sd">            image = np.random.randint(0, 256, size=(100, 100, 3), dtype=np.uint8)</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                client = mlflow.MlflowClient()</span>
<span class="sd">                client.log_image(run.info.run_id, image, key=&quot;dogs&quot;, step=3)</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Time-stepped image logging pillow example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from PIL import Image</span>

<span class="sd">            image = Image.new(&quot;RGB&quot;, (100, 100))</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                client = mlflow.MlflowClient()</span>
<span class="sd">                client.log_image(run.info.run_id, image, key=&quot;dogs&quot;, step=3)</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Time-stepped image logging with mlflow.Image example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from PIL import Image</span>

<span class="sd">            # Saving an image to retrieve later.</span>
<span class="sd">            Image.new(&quot;RGB&quot;, (100, 100)).save(&quot;image.png&quot;)</span>

<span class="sd">            image = mlflow.Image(&quot;image.png&quot;)</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                client = mlflow.MlflowClient()</span>
<span class="sd">                client.log_image(run.info.run_id, image, key=&quot;dogs&quot;, step=3)</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Legacy artifact file image logging numpy example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            import numpy as np</span>

<span class="sd">            image = np.random.randint(0, 256, size=(100, 100, 3), dtype=np.uint8)</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                client = mlflow.MlflowClient()</span>
<span class="sd">                client.log_image(run.info.run_id, image, &quot;image.png&quot;)</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Legacy artifact file image logging pillow example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from PIL import Image</span>

<span class="sd">            image = Image.new(&quot;RGB&quot;, (100, 100))</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                client = mlflow.MlflowClient()</span>
<span class="sd">                client.log_image(run.info.run_id, image, &quot;image.png&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">synchronous</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">synchronous</span> <span class="k">if</span> <span class="n">synchronous</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="ow">not</span> <span class="n">MLFLOW_ENABLE_ASYNC_LOGGING</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">artifact_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">arg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">[</span><span class="n">key</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;The `artifact_file` parameter cannot be used in conjunction with `key`, &quot;</span>
                <span class="s2">&quot;`step`, or `timestamp` parameters. Please ensure that `artifact_file` is &quot;</span>
                <span class="s2">&quot;specified alone, without any of these conflicting parameters.&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">artifact_file</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Invalid arguments: Please specify exactly one of `artifact_file` or `key`. Use &quot;</span>
                <span class="s2">&quot;`key` to log dynamic image charts or `artifact_file` for saving static images. &quot;</span>
            <span class="p">)</span>

        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

        <span class="c1"># Convert image type to PIL if its a numpy array</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">convert_to_pil_image</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">Image</span><span class="p">):</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">to_pil</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Import PIL and check if the image is a PIL image</span>
            <span class="kn">import</span> <span class="nn">PIL.Image</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unsupported image object type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="si">}</span><span class="s2">. &quot;</span>
                    <span class="s2">&quot;`image` must be one of numpy.ndarray, &quot;</span>
                    <span class="s2">&quot;PIL.Image.Image, and mlflow.Image.&quot;</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">artifact_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_artifact_helper</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp_path</span><span class="p">:</span>
                <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Check image key for invalid characters</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[a-zA-Z0-9_\-./ ]+$&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;The `key` parameter may only contain alphanumerics, underscores (_), &quot;</span>
                    <span class="s2">&quot;dashes (-), periods (.), spaces ( ), and slashes (/).&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;The provided key `</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">` contains invalid characters.&quot;</span>
                <span class="p">)</span>

            <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="ow">or</span> <span class="mi">0</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">timestamp</span> <span class="ow">or</span> <span class="n">get_current_time_millis</span><span class="p">()</span>

            <span class="c1"># Sanitize key to use in filename (replace / with # to avoid subdirectories)</span>
            <span class="n">sanitized_key</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="n">filename_uuid</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
            <span class="n">uncompressed_filename</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;images/</span><span class="si">{</span><span class="n">sanitized_key</span><span class="si">}</span><span class="s2">%step%</span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s2">%timestamp%</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">%</span><span class="si">{</span><span class="n">filename_uuid</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">compressed_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">uncompressed_filename</span><span class="si">}</span><span class="s2">%compressed&quot;</span>

            <span class="c1"># Save full-resolution image</span>
            <span class="n">image_filepath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">uncompressed_filename</span><span class="si">}</span><span class="s2">.png&quot;</span>
            <span class="n">compressed_image_filepath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">compressed_filename</span><span class="si">}</span><span class="s2">.webp&quot;</span>

            <span class="c1"># Need to make a resize copy before running thread for thread safety</span>
            <span class="c1"># If further optimization is needed, we can move this resize to async queue.</span>
            <span class="n">compressed_image</span> <span class="o">=</span> <span class="n">compress_image_size</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">synchronous</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_artifact_helper</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">image_filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp_path</span><span class="p">:</span>
                    <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log_artifact_async_helper</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">image_filepath</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">synchronous</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_artifact_helper</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">compressed_image_filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp_path</span><span class="p">:</span>
                    <span class="n">compressed_image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log_artifact_async_helper</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">compressed_image_filepath</span><span class="p">,</span> <span class="n">compressed_image</span><span class="p">)</span>

            <span class="c1"># Log tag indicating that the run includes logged image</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_tag</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">MLFLOW_LOGGED_IMAGES</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">synchronous</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_check_artifact_file_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the artifact_file contains any forbidden characters.</span>

<span class="sd">        Args:</span>
<span class="sd">            artifact_file: The run-relative artifact file path in posixpath format to which</span>
<span class="sd">                the table is saved (e.g. &quot;dir/file.json&quot;).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">characters_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;{&quot;</span><span class="p">,</span> <span class="s2">&quot;}&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">characters_to_check</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">artifact_file</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The artifact_file contains forbidden character: </span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artifact_path</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

        <span class="k">if</span> <span class="n">artifact_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">artifact_path</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;split&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">artifact_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.parquet&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">artifact_path</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported file type in </span><span class="si">{</span><span class="n">artifact_path</span><span class="si">}</span><span class="s2">. Expected .json or .parquet&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="MlflowClient.log_table"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.log_table">[docs]</a>    <span class="nd">@experimental</span>
    <span class="k">def</span> <span class="nf">log_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">],</span>
        <span class="n">artifact_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Log a table to MLflow Tracking as a JSON artifact. If the artifact_file already exists</span>
<span class="sd">        in the run, the data would be appended to the existing artifact_file.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: String ID of the run.</span>
<span class="sd">            data: Dictionary or pandas.DataFrame to log.</span>
<span class="sd">            artifact_file: The run-relative artifact file path in posixpath format to which</span>
<span class="sd">                the table is saved (e.g. &quot;dir/file.json&quot;).</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :test:</span>
<span class="sd">            :caption: Dictionary Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            table_dict = {</span>
<span class="sd">                &quot;inputs&quot;: [&quot;What is MLflow?&quot;, &quot;What is Databricks?&quot;],</span>
<span class="sd">                &quot;outputs&quot;: [&quot;MLflow is ...&quot;, &quot;Databricks is ...&quot;],</span>
<span class="sd">                &quot;toxicity&quot;: [0.0, 0.0],</span>
<span class="sd">            }</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                client = MlflowClient()</span>
<span class="sd">                client.log_table(</span>
<span class="sd">                    run.info.run_id, data=table_dict, artifact_file=&quot;qabot_eval_results.json&quot;</span>
<span class="sd">                )</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :test:</span>
<span class="sd">            :caption: Pandas DF Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            import pandas as pd</span>
<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            table_dict = {</span>
<span class="sd">                &quot;inputs&quot;: [&quot;What is MLflow?&quot;, &quot;What is Databricks?&quot;],</span>
<span class="sd">                &quot;outputs&quot;: [&quot;MLflow is ...&quot;, &quot;Databricks is ...&quot;],</span>
<span class="sd">                &quot;toxicity&quot;: [0.0, 0.0],</span>
<span class="sd">            }</span>
<span class="sd">            df = pd.DataFrame.from_dict(table_dict)</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                client = MlflowClient()</span>
<span class="sd">                client.log_table(run.info.run_id, data=df, artifact_file=&quot;qabot_eval_results.json&quot;)</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :test:</span>
<span class="sd">            :caption: Image Column Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            import pandas as pd</span>
<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            image = mlflow.Image([[1, 2, 3]])</span>
<span class="sd">            table_dict = {</span>
<span class="sd">                &quot;inputs&quot;: [&quot;Show me a dog&quot;, &quot;Show me a cat&quot;],</span>
<span class="sd">                &quot;outputs&quot;: [image, image],</span>
<span class="sd">            }</span>
<span class="sd">            df = pd.DataFrame.from_dict(table_dict)</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                client = MlflowClient()</span>
<span class="sd">                client.log_table(run.info.run_id, data=df, artifact_file=&quot;image_gen.json&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_artifact_file_string</span><span class="p">(</span><span class="n">artifact_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">artifact_file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;.parquet&quot;</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid artifact file path &#39;</span><span class="si">{</span><span class="n">artifact_file</span><span class="si">}</span><span class="s2">&#39;. Please ensure the file you are &quot;</span>
                <span class="s2">&quot;trying to log as a table has a file name with either &#39;.json&#39; &quot;</span>
                <span class="s2">&quot;or &#39;.parquet&#39; extension.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="o">.</span><span class="n">invalid_parameter_value</span><span class="p">(</span>
                <span class="s2">&quot;data must be a pandas.DataFrame or a dictionary&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="c1"># catch error `If using all scalar values, you must pass an index`</span>
            <span class="c1"># for data like {&quot;inputs&quot;: &quot;What is MLflow?&quot;}</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>

        <span class="c1"># Check if the column is a `PIL.Image.Image` or `mlflow.Image` object</span>
        <span class="c1"># and save filepath</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">def</span> <span class="nf">process_image</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
                <span class="c1"># remove extension from artifact_file</span>
                <span class="n">table_name</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">artifact_file</span><span class="p">)</span>
                <span class="c1"># save image to path</span>
                <span class="n">filepath</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;table_images&quot;</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()))</span>
                <span class="n">image_filepath</span> <span class="o">=</span> <span class="n">filepath</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span>
                <span class="n">compressed_image_filepath</span> <span class="o">=</span> <span class="n">filepath</span> <span class="o">+</span> <span class="s2">&quot;.webp&quot;</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_artifact_helper</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">image_filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">artifact_path</span><span class="p">:</span>
                    <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">artifact_path</span><span class="p">)</span>

                <span class="c1"># save compressed image to path</span>
                <span class="n">compressed_image</span> <span class="o">=</span> <span class="n">compress_image_size</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_artifact_helper</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">compressed_image_filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">artifact_path</span><span class="p">:</span>
                    <span class="n">compressed_image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">artifact_path</span><span class="p">)</span>

                <span class="c1"># return a dictionary object indicating its an image path</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;image&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;filepath&quot;</span><span class="p">:</span> <span class="n">image_filepath</span><span class="p">,</span>
                    <span class="s2">&quot;compressed_filepath&quot;</span><span class="p">:</span> <span class="n">compressed_image_filepath</span><span class="p">,</span>
                <span class="p">}</span>

            <span class="k">def</span> <span class="nf">check_is_image_object</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;save&quot;</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;save&quot;</span><span class="p">))</span>
                    <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;resize&quot;</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;resize&quot;</span><span class="p">))</span>
                    <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">isImage</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">check_is_image_object</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">isImage</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">isImage</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Column `</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">` contains a mix of images and non-images. &quot;</span>
                        <span class="s2">&quot;Please ensure that all elements in the column are of the same type.&quot;</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="n">isImage</span><span class="p">):</span>
                    <span class="c1"># Save files to artifact storage</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">process_image</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">write_to_file</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">artifact_path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">artifact_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
                <span class="n">data</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">artifact_path</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;split&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s2">&quot;iso&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">artifact_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.parquet&quot;</span><span class="p">):</span>
                <span class="n">data</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">artifact_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">norm_path</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">artifact_file</span><span class="p">)</span>
        <span class="n">artifact_dir</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">norm_path</span><span class="p">)</span>
        <span class="n">artifact_dir</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">artifact_dir</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="n">artifact_dir</span>
        <span class="n">artifacts</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">path</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_artifacts</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">artifact_dir</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">artifact_file</span> <span class="ow">in</span> <span class="n">artifacts</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdir</span><span class="p">:</span>
                <span class="n">downloaded_artifact_path</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">artifacts</span><span class="o">.</span><span class="n">download_artifacts</span><span class="p">(</span>
                    <span class="n">run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">,</span> <span class="n">artifact_path</span><span class="o">=</span><span class="n">artifact_file</span><span class="p">,</span> <span class="n">dst_path</span><span class="o">=</span><span class="n">tmpdir</span>
                <span class="p">)</span>
                <span class="n">existing_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_from_file</span><span class="p">(</span><span class="n">downloaded_artifact_path</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">existing_predictions</span><span class="p">,</span> <span class="n">data</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;Appending new table to already existing artifact &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">artifact_file</span><span class="si">}</span><span class="s2"> for run </span><span class="si">{</span><span class="n">run_id</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_artifact_helper</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">artifact_path</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">write_to_file</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">artifact_path</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Failed to save </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2"> as table as the data is not JSON serializable. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="n">run</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_run</span><span class="p">(</span><span class="n">run_id</span><span class="p">)</span>

        <span class="c1"># Get the current value of the tag</span>
        <span class="n">current_tag_value</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">MLFLOW_LOGGED_ARTIFACTS</span><span class="p">,</span> <span class="s2">&quot;[]&quot;</span><span class="p">))</span>
        <span class="n">tag_value</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">artifact_file</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;table&quot;</span><span class="p">}</span>

        <span class="c1"># Append the new tag value to the list if one doesn&#39;t exists</span>
        <span class="k">if</span> <span class="n">tag_value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_tag_value</span><span class="p">:</span>
            <span class="n">current_tag_value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag_value</span><span class="p">)</span>
            <span class="c1"># Set the tag with the updated list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_tag</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">MLFLOW_LOGGED_ARTIFACTS</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">current_tag_value</span><span class="p">))</span></div>

<div class="viewcode-block" id="MlflowClient.load_table"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.load_table">[docs]</a>    <span class="nd">@experimental</span>
    <span class="k">def</span> <span class="nf">load_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">artifact_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">run_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">extra_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load a table from MLflow Tracking as a pandas.DataFrame. The table is loaded from the</span>
<span class="sd">        specified artifact_file in the specified run_ids. The extra_columns are columns that</span>
<span class="sd">        are not in the table but are augmented with run information and added to the DataFrame.</span>

<span class="sd">        Args:</span>
<span class="sd">            experiment_id: The experiment ID to load the table from.</span>
<span class="sd">            artifact_file: The run-relative artifact file path in posixpath format to which</span>
<span class="sd">                table to load (e.g. &quot;dir/file.json&quot;).</span>
<span class="sd">            run_ids: Optional list of run_ids to load the table from. If no run_ids are</span>
<span class="sd">                specified, the table is loaded from all runs in the current experiment.</span>
<span class="sd">            extra_columns: Optional list of extra columns to add to the returned DataFrame</span>
<span class="sd">                For example, if extra_columns=[&quot;run_id&quot;], then the returned DataFrame</span>
<span class="sd">                will have a column named run_id.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas.DataFrame containing the loaded table if the artifact exists</span>
<span class="sd">            or else throw a MlflowException.</span>

<span class="sd">         .. code-block:: python</span>
<span class="sd">            :test:</span>
<span class="sd">            :caption: Example with passing run_ids</span>

<span class="sd">            import mlflow</span>
<span class="sd">            import pandas as pd</span>
<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            table_dict = {</span>
<span class="sd">                &quot;inputs&quot;: [&quot;What is MLflow?&quot;, &quot;What is Databricks?&quot;],</span>
<span class="sd">                &quot;outputs&quot;: [&quot;MLflow is ...&quot;, &quot;Databricks is ...&quot;],</span>
<span class="sd">                &quot;toxicity&quot;: [0.0, 0.0],</span>
<span class="sd">            }</span>
<span class="sd">            df = pd.DataFrame.from_dict(table_dict)</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            run = client.create_run(experiment_id=&quot;0&quot;)</span>
<span class="sd">            client.log_table(run.info.run_id, data=df, artifact_file=&quot;qabot_eval_results.json&quot;)</span>
<span class="sd">            loaded_table = client.load_table(</span>
<span class="sd">                experiment_id=&quot;0&quot;,</span>
<span class="sd">                artifact_file=&quot;qabot_eval_results.json&quot;,</span>
<span class="sd">                run_ids=[</span>
<span class="sd">                    run.info.run_id,</span>
<span class="sd">                ],</span>
<span class="sd">                # Append a column containing the associated run ID for each row</span>
<span class="sd">                extra_columns=[&quot;run_id&quot;],</span>
<span class="sd">            )</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :test:</span>
<span class="sd">            :caption: Example with passing no run_ids</span>

<span class="sd">            # Loads the table with the specified name for all runs in the given</span>
<span class="sd">            # experiment and joins them together</span>
<span class="sd">            import mlflow</span>
<span class="sd">            import pandas as pd</span>
<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            table_dict = {</span>
<span class="sd">                &quot;inputs&quot;: [&quot;What is MLflow?&quot;, &quot;What is Databricks?&quot;],</span>
<span class="sd">                &quot;outputs&quot;: [&quot;MLflow is ...&quot;, &quot;Databricks is ...&quot;],</span>
<span class="sd">                &quot;toxicity&quot;: [0.0, 0.0],</span>
<span class="sd">            }</span>
<span class="sd">            df = pd.DataFrame.from_dict(table_dict)</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            run = client.create_run(experiment_id=&quot;0&quot;)</span>
<span class="sd">            client.log_table(run.info.run_id, data=df, artifact_file=&quot;qabot_eval_results.json&quot;)</span>
<span class="sd">            loaded_table = client.load_table(</span>
<span class="sd">                experiment_id=&quot;0&quot;,</span>
<span class="sd">                artifact_file=&quot;qabot_eval_results.json&quot;,</span>
<span class="sd">                # Append the run ID and the parent run ID to the table</span>
<span class="sd">                extra_columns=[&quot;run_id&quot;],</span>
<span class="sd">            )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_artifact_file_string</span><span class="p">(</span><span class="n">artifact_file</span><span class="p">)</span>
        <span class="n">subset_tag_value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&quot;path&quot;%:%&quot;</span><span class="si">{</span><span class="n">artifact_file</span><span class="si">}</span><span class="s1">&quot;,%&quot;type&quot;%:%&quot;table&quot;&#39;</span>

        <span class="c1"># Build the filter string</span>
        <span class="n">filter_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;tags.</span><span class="si">{</span><span class="n">MLFLOW_LOGGED_ARTIFACTS</span><span class="si">}</span><span class="s2"> LIKE &#39;%</span><span class="si">{</span><span class="n">subset_tag_value</span><span class="si">}</span><span class="s2">%&#39;&quot;</span>
        <span class="k">if</span> <span class="n">run_ids</span><span class="p">:</span>
            <span class="n">list_run_ids</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">repr</span><span class="p">,</span> <span class="n">run_ids</span><span class="p">))</span>
            <span class="n">filter_string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; and attributes.run_id IN (</span><span class="si">{</span><span class="n">list_run_ids</span><span class="si">}</span><span class="s2">)&quot;</span>

        <span class="n">runs</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">search_runs</span><span class="p">(</span><span class="n">experiment_ids</span><span class="o">=</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">],</span> <span class="n">filter_string</span><span class="o">=</span><span class="n">filter_string</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">run_ids</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">run_ids</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">runs</span><span class="p">):</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Not all runs have the specified table artifact. Some runs will be skipped.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># TODO: Add parallelism support here</span>
        <span class="k">def</span> <span class="nf">get_artifact_data</span><span class="p">(</span><span class="n">run</span><span class="p">):</span>
            <span class="n">run_id</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">run_id</span>
            <span class="n">norm_path</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">artifact_file</span><span class="p">)</span>
            <span class="n">artifact_dir</span> <span class="o">=</span> <span class="n">posixpath</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">norm_path</span><span class="p">)</span>
            <span class="n">artifact_dir</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">artifact_dir</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="n">artifact_dir</span>
            <span class="n">existing_predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

            <span class="n">artifacts</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">f</span><span class="o">.</span><span class="n">path</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_artifacts</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">artifact_dir</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">is_dir</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">artifact_file</span> <span class="ow">in</span> <span class="n">artifacts</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdir</span><span class="p">:</span>
                    <span class="n">downloaded_artifact_path</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">artifacts</span><span class="o">.</span><span class="n">download_artifacts</span><span class="p">(</span>
                        <span class="n">run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">,</span>
                        <span class="n">artifact_path</span><span class="o">=</span><span class="n">artifact_file</span><span class="p">,</span>
                        <span class="n">dst_path</span><span class="o">=</span><span class="n">tmpdir</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">existing_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_from_file</span><span class="p">(</span><span class="n">downloaded_artifact_path</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">extra_columns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">extra_columns</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">existing_predictions</span><span class="p">:</span>
                                <span class="n">column_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">_&quot;</span>
                                <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                    <span class="sa">f</span><span class="s2">&quot;Column name </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2"> already exists in the table. &quot;</span>
                                    <span class="s2">&quot;Resolving the conflict, by appending an underscore &quot;</span>
                                    <span class="s2">&quot;to the column name.&quot;</span>
                                <span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">column_name</span> <span class="o">=</span> <span class="n">column</span>
                            <span class="n">existing_predictions</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Artifact </span><span class="si">{</span><span class="n">artifact_file</span><span class="si">}</span><span class="s2"> not found for run </span><span class="si">{</span><span class="n">run_id</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">RESOURCE_DOES_NOT_EXIST</span>
                <span class="p">)</span>

            <span class="k">return</span> <span class="n">existing_predictions</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">runs</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                <span class="p">[</span><span class="n">get_artifact_data</span><span class="p">(</span><span class="n">run</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">runs</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="s2">&quot;No runs found with the corresponding table artifact.&quot;</span><span class="p">,</span> <span class="n">RESOURCE_DOES_NOT_EXIST</span>
            <span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_record_logged_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="n">mlflow_model</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Record logged model info with the tracking server.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: run_id under which the model has been logged.</span>
<span class="sd">            mlflow_model: Model info to be recorded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">_record_logged_model</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">mlflow_model</span><span class="p">)</span>

<div class="viewcode-block" id="MlflowClient.list_artifacts"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.list_artifacts">[docs]</a>    <span class="k">def</span> <span class="nf">list_artifacts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">FileInfo</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List the artifacts for a run.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: The run to list artifacts from.</span>
<span class="sd">            path: The run&#39;s relative artifact path to list from. By default it is set to None</span>
<span class="sd">                or the root artifact path.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of :py:class:`mlflow.entities.FileInfo`</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_artifact_info(artifact):</span>
<span class="sd">                print(f&quot;artifact: {artifact.path}&quot;)</span>
<span class="sd">                print(f&quot;is_dir: {artifact.is_dir}&quot;)</span>
<span class="sd">                print(f&quot;size: {artifact.file_size}&quot;)</span>


<span class="sd">            features = &quot;rooms zipcode, median_price, school_rating, transport&quot;</span>
<span class="sd">            labels = &quot;price&quot;</span>

<span class="sd">            # Create a run under the default experiment (whose id is &#39;0&#39;).</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = &quot;0&quot;</span>
<span class="sd">            run = client.create_run(experiment_id)</span>

<span class="sd">            # Create some artifacts and log under the above run</span>
<span class="sd">            for file, content in [(&quot;features&quot;, features), (&quot;labels&quot;, labels)]:</span>
<span class="sd">                with open(f&quot;{file}.txt&quot;, &quot;w&quot;) as f:</span>
<span class="sd">                    f.write(content)</span>
<span class="sd">                client.log_artifact(run.info.run_id, f&quot;{file}.txt&quot;)</span>

<span class="sd">            # Fetch the logged artifacts</span>
<span class="sd">            artifacts = client.list_artifacts(run.info.run_id)</span>
<span class="sd">            for artifact in artifacts:</span>
<span class="sd">                print_artifact_info(artifact)</span>
<span class="sd">            client.set_terminated(run.info.run_id)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            artifact: features.txt</span>
<span class="sd">            is_dir: False</span>
<span class="sd">            size: 53</span>
<span class="sd">            artifact: labels.txt</span>
<span class="sd">            is_dir: False</span>
<span class="sd">            size: 5</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">list_artifacts</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.download_artifacts"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.download_artifacts">[docs]</a>    <span class="k">def</span> <span class="nf">download_artifacts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dst_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Download an artifact file or directory from a run to a local directory if applicable,</span>
<span class="sd">        and return a local path for it.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: The run to download artifacts from.</span>
<span class="sd">            path: Relative source path to the desired artifact.</span>
<span class="sd">            dst_path: Absolute path of the local filesystem destination directory to which to</span>
<span class="sd">                download the specified artifacts. This directory must already exist.</span>
<span class="sd">                If unspecified, the artifacts will either be downloaded to a new</span>
<span class="sd">                uniquely-named directory on the local filesystem or will be returned</span>
<span class="sd">                directly in the case of the LocalArtifactRepository.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Local path of desired artifact.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import os</span>
<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            features = &quot;rooms, zipcode, median_price, school_rating, transport&quot;</span>
<span class="sd">            with open(&quot;features.txt&quot;, &quot;w&quot;) as f:</span>
<span class="sd">                f.write(features)</span>

<span class="sd">            # Log artifacts</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                mlflow.log_artifact(&quot;features.txt&quot;, artifact_path=&quot;features&quot;)</span>

<span class="sd">            # Download artifacts</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            local_dir = &quot;/tmp/artifact_downloads&quot;</span>
<span class="sd">            if not os.path.exists(local_dir):</span>
<span class="sd">                os.mkdir(local_dir)</span>
<span class="sd">            local_path = client.download_artifacts(run.info.run_id, &quot;features&quot;, local_dir)</span>
<span class="sd">            print(f&quot;Artifacts downloaded in: {local_path}&quot;)</span>
<span class="sd">            print(f&quot;Artifacts: {os.listdir(local_path)}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Artifacts downloaded in: /tmp/artifact_downloads/features</span>
<span class="sd">            Artifacts: [&#39;features.txt&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">download_artifacts</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">dst_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.set_terminated"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.set_terminated">[docs]</a>    <span class="k">def</span> <span class="nf">set_terminated</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">end_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set a run&#39;s status to terminated.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: The ID of the run to terminate.</span>
<span class="sd">            status: A string value of :py:class:`mlflow.entities.RunStatus`. Defaults to &quot;FINISHED&quot;.</span>
<span class="sd">            end_time: If not provided, defaults to the current time.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_run_info(r):</span>
<span class="sd">                print(f&quot;run_id: {r.info.run_id}&quot;)</span>
<span class="sd">                print(f&quot;status: {r.info.status}&quot;)</span>


<span class="sd">            # Create a run under the default experiment (whose id is &#39;0&#39;).</span>
<span class="sd">            # Since this is low-level CRUD operation, this method will create a run.</span>
<span class="sd">            # To end the run, you&#39;ll have to explicitly terminate it.</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = &quot;0&quot;</span>
<span class="sd">            run = client.create_run(experiment_id)</span>
<span class="sd">            print_run_info(run)</span>
<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # Terminate the run and fetch updated status. By default,</span>
<span class="sd">            # the status is set to &quot;FINISHED&quot;. Other values you can</span>
<span class="sd">            # set are &quot;KILLED&quot;, &quot;FAILED&quot;, &quot;RUNNING&quot;, or &quot;SCHEDULED&quot;.</span>
<span class="sd">            client.set_terminated(run.info.run_id, status=&quot;KILLED&quot;)</span>
<span class="sd">            run = client.get_run(run.info.run_id)</span>
<span class="sd">            print_run_info(run)</span>

<span class="sd">        .. code-block:: text</span>

<span class="sd">            run_id: 575fb62af83f469e84806aee24945973</span>
<span class="sd">            status: RUNNING</span>
<span class="sd">            --</span>
<span class="sd">            run_id: 575fb62af83f469e84806aee24945973</span>
<span class="sd">            status: KILLED</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">set_terminated</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.delete_run"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.delete_run">[docs]</a>    <span class="k">def</span> <span class="nf">delete_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deletes a run with the given ID.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: The unique run id to delete.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            # Create a run under the default experiment (whose id is &#39;0&#39;).</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = &quot;0&quot;</span>
<span class="sd">            run = client.create_run(experiment_id)</span>
<span class="sd">            run_id = run.info.run_id</span>
<span class="sd">            print(f&quot;run_id: {run_id}; lifecycle_stage: {run.info.lifecycle_stage}&quot;)</span>
<span class="sd">            print(&quot;--&quot;)</span>
<span class="sd">            client.delete_run(run_id)</span>
<span class="sd">            del_run = client.get_run(run_id)</span>
<span class="sd">            print(f&quot;run_id: {run_id}; lifecycle_stage: {del_run.info.lifecycle_stage}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            run_id: a61c7a1851324f7094e8d5014c58c8c8; lifecycle_stage: active</span>
<span class="sd">            run_id: a61c7a1851324f7094e8d5014c58c8c8; lifecycle_stage: deleted</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">delete_run</span><span class="p">(</span><span class="n">run_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.restore_run"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.restore_run">[docs]</a>    <span class="k">def</span> <span class="nf">restore_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Restores a deleted run with the given ID.</span>

<span class="sd">        Args:</span>
<span class="sd">            run_id: The unique run id to restore.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            # Create a run under the default experiment (whose id is &#39;0&#39;).</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            experiment_id = &quot;0&quot;</span>
<span class="sd">            run = client.create_run(experiment_id)</span>
<span class="sd">            run_id = run.info.run_id</span>
<span class="sd">            print(f&quot;run_id: {run_id}; lifecycle_stage: {run.info.lifecycle_stage}&quot;)</span>
<span class="sd">            client.delete_run(run_id)</span>
<span class="sd">            del_run = client.get_run(run_id)</span>
<span class="sd">            print(f&quot;run_id: {run_id}; lifecycle_stage: {del_run.info.lifecycle_stage}&quot;)</span>
<span class="sd">            client.restore_run(run_id)</span>
<span class="sd">            rest_run = client.get_run(run_id)</span>
<span class="sd">            print(f&quot;run_id: {run_id}; lifecycle_stage: {rest_run.info.lifecycle_stage}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            run_id: 7bc59754d7e74534a7917d62f2873ac0; lifecycle_stage: active</span>
<span class="sd">            run_id: 7bc59754d7e74534a7917d62f2873ac0; lifecycle_stage: deleted</span>
<span class="sd">            run_id: 7bc59754d7e74534a7917d62f2873ac0; lifecycle_stage: active</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">restore_run</span><span class="p">(</span><span class="n">run_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.search_runs"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.search_runs">[docs]</a>    <span class="k">def</span> <span class="nf">search_runs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">experiment_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">filter_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">run_view_type</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">ViewType</span><span class="o">.</span><span class="n">ACTIVE_ONLY</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">SEARCH_MAX_RESULTS_DEFAULT</span><span class="p">,</span>
        <span class="n">order_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">page_token</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PagedList</span><span class="p">[</span><span class="n">Run</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Search for Runs that fit the specified criteria.</span>

<span class="sd">        Args:</span>
<span class="sd">            experiment_ids: List of experiment IDs, or a single int or string id.</span>
<span class="sd">            filter_string: Filter query string, defaults to searching all runs.</span>
<span class="sd">            run_view_type: one of enum values ACTIVE_ONLY, DELETED_ONLY, or ALL runs</span>
<span class="sd">                defined in :py:class:`mlflow.entities.ViewType`.</span>
<span class="sd">            max_results: Maximum number of runs desired.</span>
<span class="sd">            order_by: List of columns to order by (e.g., &quot;metrics.rmse&quot;). The ``order_by`` column</span>
<span class="sd">                can contain an optional ``DESC`` or ``ASC`` value. The default is ``ASC``.</span>
<span class="sd">                The default ordering is to sort by ``start_time DESC``, then ``run_id``.</span>
<span class="sd">            page_token: Token specifying the next page of results. It should be obtained from</span>
<span class="sd">                a ``search_runs`` call.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A :py:class:`PagedList &lt;mlflow.store.entities.PagedList&gt;` of</span>
<span class="sd">            :py:class:`Run &lt;mlflow.entities.Run&gt;` objects that satisfy the search expressions.</span>
<span class="sd">            If the underlying tracking store supports pagination, the token for the next page may</span>
<span class="sd">            be obtained via the ``token`` attribute of the returned object.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.entities import ViewType</span>


<span class="sd">            def print_run_info(runs):</span>
<span class="sd">                for r in runs:</span>
<span class="sd">                    print(f&quot;run_id: {r.info.run_id}&quot;)</span>
<span class="sd">                    print(f&quot;lifecycle_stage: {r.info.lifecycle_stage}&quot;)</span>
<span class="sd">                    print(f&quot;metrics: {r.data.metrics}&quot;)</span>
<span class="sd">                    # Exclude mlflow system tags</span>
<span class="sd">                    tags = {k: v for k, v in r.data.tags.items() if not k.startswith(&quot;mlflow.&quot;)}</span>
<span class="sd">                    print(f&quot;tags: {tags}&quot;)</span>


<span class="sd">            # Create an experiment and log two runs with metrics and tags under the experiment</span>
<span class="sd">            experiment_id = mlflow.create_experiment(&quot;Social NLP Experiments&quot;)</span>
<span class="sd">            with mlflow.start_run(experiment_id=experiment_id) as run:</span>
<span class="sd">                mlflow.log_metric(&quot;m&quot;, 1.55)</span>
<span class="sd">                mlflow.set_tag(&quot;s.release&quot;, &quot;1.1.0-RC&quot;)</span>
<span class="sd">            with mlflow.start_run(experiment_id=experiment_id):</span>
<span class="sd">                mlflow.log_metric(&quot;m&quot;, 2.50)</span>
<span class="sd">                mlflow.set_tag(&quot;s.release&quot;, &quot;1.2.0-GA&quot;)</span>
<span class="sd">            # Search all runs under experiment id and order them by</span>
<span class="sd">            # descending value of the metric &#39;m&#39;</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            runs = client.search_runs(experiment_id, order_by=[&quot;metrics.m DESC&quot;])</span>
<span class="sd">            print_run_info(runs)</span>
<span class="sd">            print(&quot;--&quot;)</span>
<span class="sd">            # Delete the first run</span>
<span class="sd">            client.delete_run(run_id=run.info.run_id)</span>
<span class="sd">            # Search only deleted runs under the experiment id and use a case insensitive pattern</span>
<span class="sd">            # in the filter_string for the tag.</span>
<span class="sd">            filter_string = &quot;tags.s.release ILIKE &#39;%rc%&#39;&quot;</span>
<span class="sd">            runs = client.search_runs(</span>
<span class="sd">                experiment_id, run_view_type=ViewType.DELETED_ONLY, filter_string=filter_string</span>
<span class="sd">            )</span>
<span class="sd">            print_run_info(runs)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            run_id: 0efb2a68833d4ee7860a964fad31cb3f</span>
<span class="sd">            lifecycle_stage: active</span>
<span class="sd">            metrics: {&#39;m&#39;: 2.5}</span>
<span class="sd">            tags: {&#39;s.release&#39;: &#39;1.2.0-GA&#39;}</span>
<span class="sd">            run_id: 7ab027fd72ee4527a5ec5eafebb923b8</span>
<span class="sd">            lifecycle_stage: active</span>
<span class="sd">            metrics: {&#39;m&#39;: 1.55}</span>
<span class="sd">            tags: {&#39;s.release&#39;: &#39;1.1.0-RC&#39;}</span>
<span class="sd">            --</span>
<span class="sd">            run_id: 7ab027fd72ee4527a5ec5eafebb923b8</span>
<span class="sd">            lifecycle_stage: deleted</span>
<span class="sd">            metrics: {&#39;m&#39;: 1.55}</span>
<span class="sd">            tags: {&#39;s.release&#39;: &#39;1.1.0-RC&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">search_runs</span><span class="p">(</span>
            <span class="n">experiment_ids</span><span class="p">,</span> <span class="n">filter_string</span><span class="p">,</span> <span class="n">run_view_type</span><span class="p">,</span> <span class="n">max_results</span><span class="p">,</span> <span class="n">order_by</span><span class="p">,</span> <span class="n">page_token</span>
        <span class="p">)</span></div>

    <span class="c1"># Registry API</span>

    <span class="c1"># Registered Model Methods</span>

<div class="viewcode-block" id="MlflowClient.create_registered_model"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.create_registered_model">[docs]</a>    <span class="k">def</span> <span class="nf">create_registered_model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RegisteredModel</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new registered model in backend store.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the new model. This is expected to be unique in the backend store.</span>
<span class="sd">            tags: A dictionary of key-value pairs that are converted into</span>
<span class="sd">                :py:class:`mlflow.entities.model_registry.RegisteredModelTag` objects.</span>
<span class="sd">            description: Description of the model.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A single object of :py:class:`mlflow.entities.model_registry.RegisteredModel`</span>
<span class="sd">            created by backend.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_registered_model_info(rm):</span>
<span class="sd">                print(f&quot;name: {rm.name}&quot;)</span>
<span class="sd">                print(f&quot;tags: {rm.tags}&quot;)</span>
<span class="sd">                print(f&quot;description: {rm.description}&quot;)</span>


<span class="sd">            name = &quot;SocialMediaTextAnalyzer&quot;</span>
<span class="sd">            tags = {&quot;nlp.framework&quot;: &quot;Spark NLP&quot;}</span>
<span class="sd">            desc = &quot;This sentiment analysis model classifies the tone-happy, sad, angry.&quot;</span>

<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name, tags, desc)</span>
<span class="sd">            print_registered_model_info(client.get_registered_model(name))</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            name: SocialMediaTextAnalyzer</span>
<span class="sd">            tags: {&#39;nlp.framework&#39;: &#39;Spark NLP&#39;}</span>
<span class="sd">            description: This sentiment analysis model classifies the tone-happy, sad, angry.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">create_registered_model</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.rename_registered_model"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.rename_registered_model">[docs]</a>    <span class="k">def</span> <span class="nf">rename_registered_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RegisteredModel</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update registered model name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the registered model to update.</span>
<span class="sd">            new_name: New proposed name for the registered model.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A single updated :py:class:`mlflow.entities.model_registry.RegisteredModel` object.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_registered_model_info(rm):</span>
<span class="sd">                print(f&quot;name: {rm.name}&quot;)</span>
<span class="sd">                print(f&quot;tags: {rm.tags}&quot;)</span>
<span class="sd">                print(f&quot;description: {rm.description}&quot;)</span>


<span class="sd">            name = &quot;SocialTextAnalyzer&quot;</span>
<span class="sd">            tags = {&quot;nlp.framework&quot;: &quot;Spark NLP&quot;}</span>
<span class="sd">            desc = &quot;This sentiment analysis model classifies the tone-happy, sad, angry.&quot;</span>

<span class="sd">            # create a new registered model name</span>
<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name, tags, desc)</span>
<span class="sd">            print_registered_model_info(client.get_registered_model(name))</span>
<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # rename the model</span>
<span class="sd">            new_name = &quot;SocialMediaTextAnalyzer&quot;</span>
<span class="sd">            client.rename_registered_model(name, new_name)</span>
<span class="sd">            print_registered_model_info(client.get_registered_model(new_name))</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            name: SocialTextAnalyzer</span>
<span class="sd">            tags: {&#39;nlp.framework&#39;: &#39;Spark NLP&#39;}</span>
<span class="sd">            description: This sentiment analysis model classifies the tone-happy, sad, angry.</span>
<span class="sd">            --</span>
<span class="sd">            name: SocialMediaTextAnalyzer</span>
<span class="sd">            tags: {&#39;nlp.framework&#39;: &#39;Spark NLP&#39;}</span>
<span class="sd">            description: This sentiment analysis model classifies the tone-happy, sad, angry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">rename_registered_model</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.update_registered_model"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.update_registered_model">[docs]</a>    <span class="k">def</span> <span class="nf">update_registered_model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RegisteredModel</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates metadata for RegisteredModel entity. Input field ``description`` should be non-None.</span>
<span class="sd">        Backend raises exception if a registered model with given name does not exist.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the registered model to update.</span>
<span class="sd">            description: (Optional) New description.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A single updated :py:class:`mlflow.entities.model_registry.RegisteredModel` object.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            def print_registered_model_info(rm):</span>
<span class="sd">                print(f&quot;name: {rm.name}&quot;)</span>
<span class="sd">                print(f&quot;tags: {rm.tags}&quot;)</span>
<span class="sd">                print(f&quot;description: {rm.description}&quot;)</span>


<span class="sd">            name = &quot;SocialMediaTextAnalyzer&quot;</span>
<span class="sd">            tags = {&quot;nlp.framework&quot;: &quot;Spark NLP&quot;}</span>
<span class="sd">            desc = &quot;This sentiment analysis model classifies the tone-happy, sad, angry.&quot;</span>

<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name, tags, desc)</span>
<span class="sd">            print_registered_model_info(client.get_registered_model(name))</span>
<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # Update the model&#39;s description</span>
<span class="sd">            desc = &quot;This sentiment analysis model classifies tweets&#39; tone: happy, sad, angry.&quot;</span>
<span class="sd">            client.update_registered_model(name, desc)</span>
<span class="sd">            print_registered_model_info(client.get_registered_model(name))</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            name: SocialMediaTextAnalyzer</span>
<span class="sd">            tags: {&#39;nlp.framework&#39;: &#39;Spark NLP&#39;}</span>
<span class="sd">            description: This sentiment analysis model classifies the tone-happy, sad, angry.</span>
<span class="sd">            --</span>
<span class="sd">            name: SocialMediaTextAnalyzer</span>
<span class="sd">            tags: {&#39;nlp.framework&#39;: &#39;Spark NLP&#39;}</span>
<span class="sd">            description: This sentiment analysis model classifies tweets&#39; tone: happy, sad, angry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span><span class="s2">&quot;Attempting to update registered model with no new field values.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">update_registered_model</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.delete_registered_model"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.delete_registered_model">[docs]</a>    <span class="k">def</span> <span class="nf">delete_registered_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete registered model.</span>
<span class="sd">        Backend raises exception if a registered model with given name does not exist.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the registered model to delete.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_registered_models_info(r_models):</span>
<span class="sd">                print(&quot;--&quot;)</span>
<span class="sd">                for rm in r_models:</span>
<span class="sd">                    print(f&quot;name: {rm.name}&quot;)</span>
<span class="sd">                    print(f&quot;tags: {rm.tags}&quot;)</span>
<span class="sd">                    print(f&quot;description: {rm.description}&quot;)</span>


<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            client = MlflowClient()</span>

<span class="sd">            # Register a couple of models with respective names, tags, and descriptions</span>
<span class="sd">            for name, tags, desc in [</span>
<span class="sd">                (&quot;name1&quot;, {&quot;t1&quot;: &quot;t1&quot;}, &quot;description1&quot;),</span>
<span class="sd">                (&quot;name2&quot;, {&quot;t2&quot;: &quot;t2&quot;}, &quot;description2&quot;),</span>
<span class="sd">            ]:</span>
<span class="sd">                client.create_registered_model(name, tags, desc)</span>

<span class="sd">            # Fetch all registered models</span>
<span class="sd">            print_registered_models_info(client.search_registered_models())</span>

<span class="sd">            # Delete one registered model and fetch again</span>
<span class="sd">            client.delete_registered_model(&quot;name1&quot;)</span>
<span class="sd">            print_registered_models_info(client.search_registered_models())</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            --</span>
<span class="sd">            name: name1</span>
<span class="sd">            tags: {&#39;t1&#39;: &#39;t1&#39;}</span>
<span class="sd">            description: description1</span>
<span class="sd">            name: name2</span>
<span class="sd">            tags: {&#39;t2&#39;: &#39;t2&#39;}</span>
<span class="sd">            description: description2</span>
<span class="sd">            --</span>
<span class="sd">            name: name2</span>
<span class="sd">            tags: {&#39;t2&#39;: &#39;t2&#39;}</span>
<span class="sd">            description: description2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">delete_registered_model</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.search_registered_models"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.search_registered_models">[docs]</a>    <span class="k">def</span> <span class="nf">search_registered_models</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filter_string</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">SEARCH_REGISTERED_MODEL_MAX_RESULTS_DEFAULT</span><span class="p">,</span>
        <span class="n">order_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">page_token</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PagedList</span><span class="p">[</span><span class="n">RegisteredModel</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Search for registered models in backend that satisfy the filter criteria.</span>

<span class="sd">        Args:</span>
<span class="sd">            filter_string: Filter query string (e.g., &quot;name = &#39;a_model_name&#39; and tag.key =</span>
<span class="sd">                &#39;value1&#39;&quot;), defaults to searching for all registered models. The following</span>
<span class="sd">                identifiers, comparators, and logical operators are supported.</span>

<span class="sd">                Identifiers</span>
<span class="sd">                  - ``name``: registered model name.</span>
<span class="sd">                  - ``tags.&lt;tag_key&gt;``: registered model tag. If ``tag_key`` contains spaces, it</span>
<span class="sd">                    must be wrapped with backticks (e.g., &quot;tags.`extra key`&quot;).</span>

<span class="sd">                Comparators</span>
<span class="sd">                  - ``=``: Equal to.</span>
<span class="sd">                  - ``!=``: Not equal to.</span>
<span class="sd">                  - ``LIKE``: Case-sensitive pattern match.</span>
<span class="sd">                  - ``ILIKE``: Case-insensitive pattern match.</span>

<span class="sd">                Logical operators</span>
<span class="sd">                  - ``AND``: Combines two sub-queries and returns True if both of them are True.</span>

<span class="sd">            max_results: Maximum number of registered models desired.</span>
<span class="sd">            order_by: List of column names with ASC|DESC annotation, to be used for ordering</span>
<span class="sd">                matching search results.</span>
<span class="sd">            page_token: Token specifying the next page of results. It should be obtained from</span>
<span class="sd">                a ``search_registered_models`` call.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A PagedList of :py:class:`mlflow.entities.model_registry.RegisteredModel` objects</span>
<span class="sd">            that satisfy the search expressions. The pagination token for the next page can be</span>
<span class="sd">            obtained via the ``token`` attribute of the object.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            client = MlflowClient()</span>

<span class="sd">            # Get search results filtered by the registered model name</span>
<span class="sd">            model_name = &quot;CordobaWeatherForecastModel&quot;</span>
<span class="sd">            filter_string = f&quot;name=&#39;{model_name}&#39;&quot;</span>
<span class="sd">            results = client.search_registered_models(filter_string=filter_string)</span>
<span class="sd">            print(&quot;-&quot; * 80)</span>
<span class="sd">            for res in results:</span>
<span class="sd">                for mv in res.latest_versions:</span>
<span class="sd">                    print(f&quot;name={mv.name}; run_id={mv.run_id}; version={mv.version}&quot;)</span>

<span class="sd">            # Get search results filtered by the registered model name that matches</span>
<span class="sd">            # prefix pattern</span>
<span class="sd">            filter_string = &quot;name LIKE &#39;Boston%&#39;&quot;</span>
<span class="sd">            results = client.search_registered_models(filter_string=filter_string)</span>
<span class="sd">            print(&quot;-&quot; * 80)</span>
<span class="sd">            for res in results:</span>
<span class="sd">                for mv in res.latest_versions:</span>
<span class="sd">                    print(f&quot;name={mv.name}; run_id={mv.run_id}; version={mv.version}&quot;)</span>

<span class="sd">            # Get all registered models and order them by ascending order of the names</span>
<span class="sd">            results = client.search_registered_models(order_by=[&quot;name ASC&quot;])</span>
<span class="sd">            print(&quot;-&quot; * 80)</span>
<span class="sd">            for res in results:</span>
<span class="sd">                for mv in res.latest_versions:</span>
<span class="sd">                    print(f&quot;name={mv.name}; run_id={mv.run_id}; version={mv.version}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            ------------------------------------------------------------------------------------</span>
<span class="sd">            name=CordobaWeatherForecastModel; run_id=eaef868ee3d14d10b4299c4c81ba8814; version=1</span>
<span class="sd">            name=CordobaWeatherForecastModel; run_id=e14afa2f47a040728060c1699968fd43; version=2</span>
<span class="sd">            ------------------------------------------------------------------------------------</span>
<span class="sd">            name=BostonWeatherForecastModel; run_id=ddc51b9407a54b2bb795c8d680e63ff6; version=1</span>
<span class="sd">            name=BostonWeatherForecastModel; run_id=48ac94350fba40639a993e1b3d4c185d; version=2</span>
<span class="sd">            -----------------------------------------------------------------------------------</span>
<span class="sd">            name=AzureWeatherForecastModel; run_id=5fcec6c4f1c947fc9295fef3fa21e52d; version=1</span>
<span class="sd">            name=AzureWeatherForecastModel; run_id=8198cb997692417abcdeb62e99052260; version=3</span>
<span class="sd">            name=BostonWeatherForecastModel; run_id=ddc51b9407a54b2bb795c8d680e63ff6; version=1</span>
<span class="sd">            name=BostonWeatherForecastModel; run_id=48ac94350fba40639a993e1b3d4c185d; version=2</span>
<span class="sd">            name=CordobaWeatherForecastModel; run_id=eaef868ee3d14d10b4299c4c81ba8814; version=1</span>
<span class="sd">            name=CordobaWeatherForecastModel; run_id=e14afa2f47a040728060c1699968fd43; version=2</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">search_registered_models</span><span class="p">(</span>
            <span class="n">filter_string</span><span class="p">,</span> <span class="n">max_results</span><span class="p">,</span> <span class="n">order_by</span><span class="p">,</span> <span class="n">page_token</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.get_registered_model"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.get_registered_model">[docs]</a>    <span class="k">def</span> <span class="nf">get_registered_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RegisteredModel</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a registered model.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the registered model to get.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A single :py:class:`mlflow.entities.model_registry.RegisteredModel` object.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_model_info(rm):</span>
<span class="sd">                print(&quot;--&quot;)</span>
<span class="sd">                print(f&quot;name: {rm.name}&quot;)</span>
<span class="sd">                print(f&quot;tags: {rm.tags}&quot;)</span>
<span class="sd">                print(f&quot;description: {rm.description}&quot;)</span>


<span class="sd">            name = &quot;SocialMediaTextAnalyzer&quot;</span>
<span class="sd">            tags = {&quot;nlp.framework&quot;: &quot;Spark NLP&quot;}</span>
<span class="sd">            desc = &quot;This sentiment analysis model classifies the tone-happy, sad, angry.&quot;</span>
<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            # Create and fetch the registered model</span>
<span class="sd">            client.create_registered_model(name, tags, desc)</span>
<span class="sd">            model = client.get_registered_model(name)</span>
<span class="sd">            print_model_info(model)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            --</span>
<span class="sd">            name: SocialMediaTextAnalyzer</span>
<span class="sd">            tags: {&#39;nlp.framework&#39;: &#39;Spark NLP&#39;}</span>
<span class="sd">            description: This sentiment analysis model classifies the tone-happy, sad, angry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">get_registered_model</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.get_latest_versions"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.get_latest_versions">[docs]</a>    <span class="nd">@deprecated</span><span class="p">(</span><span class="n">since</span><span class="o">=</span><span class="s2">&quot;2.9.0&quot;</span><span class="p">,</span> <span class="n">impact</span><span class="o">=</span><span class="n">_STAGES_DEPRECATION_WARNING</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">get_latest_versions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stages</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ModelVersion</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Latest version models for each requests stage. If no ``stages`` provided, returns the</span>
<span class="sd">        latest version for each stage.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the registered model from which to get the latest versions.</span>
<span class="sd">            stages: List of desired stages. If input list is None, return latest versions for</span>
<span class="sd">                for ALL_STAGES.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of :py:class:`mlflow.entities.model_registry.ModelVersion` objects.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow.sklearn</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>


<span class="sd">            def print_models_info(mv):</span>
<span class="sd">                for m in mv:</span>
<span class="sd">                    print(f&quot;name: {m.name}&quot;)</span>
<span class="sd">                    print(f&quot;latest version: {m.version}&quot;)</span>
<span class="sd">                    print(f&quot;run_id: {m.run_id}&quot;)</span>
<span class="sd">                    print(f&quot;current_stage: {m.current_stage}&quot;)</span>


<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>
<span class="sd">            # Create two runs Log MLflow entities</span>
<span class="sd">            with mlflow.start_run() as run1:</span>
<span class="sd">                params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">                rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">                signature = infer_signature(X, rfr.predict(X))</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>
<span class="sd">            with mlflow.start_run() as run2:</span>
<span class="sd">                params = {&quot;n_estimators&quot;: 6, &quot;random_state&quot;: 42}</span>
<span class="sd">                rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">                signature = infer_signature(X, rfr.predict(X))</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>
<span class="sd">            # Register model name in the model registry</span>
<span class="sd">            name = &quot;RandomForestRegression&quot;</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name)</span>
<span class="sd">            # Create a two versions of the rfr model under the registered model name</span>
<span class="sd">            for run_id in [run1.info.run_id, run2.info.run_id]:</span>
<span class="sd">                model_uri = f&quot;runs:/{run_id}/sklearn-model&quot;</span>
<span class="sd">                mv = client.create_model_version(name, model_uri, run_id)</span>
<span class="sd">                print(f&quot;model version {mv.version} created&quot;)</span>
<span class="sd">            # Fetch latest version; this will be version 2</span>
<span class="sd">            print(&quot;--&quot;)</span>
<span class="sd">            print_models_info(client.get_latest_versions(name, stages=[&quot;None&quot;]))</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            model version 1 created</span>
<span class="sd">            model version 2 created</span>
<span class="sd">            --</span>
<span class="sd">            name: RandomForestRegression</span>
<span class="sd">            latest version: 2</span>
<span class="sd">            run_id: 31165664be034dc698c52a4bdeb71663</span>
<span class="sd">            current_stage: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">get_latest_versions</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">stages</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.set_registered_model_tag"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.set_registered_model_tag">[docs]</a>    <span class="k">def</span> <span class="nf">set_registered_model_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set a tag for the registered model.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Registered model name.</span>
<span class="sd">            key: Tag key to log.</span>
<span class="sd">            value: Tag value log.</span>

<span class="sd">        .. code-block:: Python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_model_info(rm):</span>
<span class="sd">                print(&quot;--&quot;)</span>
<span class="sd">                print(&quot;name: {}&quot;.format(rm.name))</span>
<span class="sd">                print(&quot;tags: {}&quot;.format(rm.tags))</span>


<span class="sd">            name = &quot;SocialMediaTextAnalyzer&quot;</span>
<span class="sd">            tags = {&quot;nlp.framework1&quot;: &quot;Spark NLP&quot;}</span>
<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            client = MlflowClient()</span>

<span class="sd">            # Create registered model, set an additional tag, and fetch</span>
<span class="sd">            # update model info</span>
<span class="sd">            client.create_registered_model(name, tags, desc)</span>
<span class="sd">            model = client.get_registered_model(name)</span>
<span class="sd">            print_model_info(model)</span>
<span class="sd">            client.set_registered_model_tag(name, &quot;nlp.framework2&quot;, &quot;VADER&quot;)</span>
<span class="sd">            model = client.get_registered_model(name)</span>
<span class="sd">            print_model_info(model)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            --</span>
<span class="sd">            name: SocialMediaTextAnalyzer</span>
<span class="sd">            tags: {&#39;nlp.framework1&#39;: &#39;Spark NLP&#39;}</span>
<span class="sd">            --</span>
<span class="sd">            name: SocialMediaTextAnalyzer</span>
<span class="sd">            tags: {&#39;nlp.framework1&#39;: &#39;Spark NLP&#39;, &#39;nlp.framework2&#39;: &#39;VADER&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">set_registered_model_tag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.delete_registered_model_tag"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.delete_registered_model_tag">[docs]</a>    <span class="k">def</span> <span class="nf">delete_registered_model_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete a tag associated with the registered model.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Registered model name.</span>
<span class="sd">            key: Registered model tag key.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>


<span class="sd">            def print_registered_models_info(r_models):</span>
<span class="sd">                print(&quot;--&quot;)</span>
<span class="sd">                for rm in r_models:</span>
<span class="sd">                    print(f&quot;name: {rm.name}&quot;)</span>
<span class="sd">                    print(f&quot;tags: {rm.tags}&quot;)</span>


<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            client = MlflowClient()</span>

<span class="sd">            # Register a couple of models with respective names and tags</span>
<span class="sd">            for name, tags in [(&quot;name1&quot;, {&quot;t1&quot;: &quot;t1&quot;}), (&quot;name2&quot;, {&quot;t2&quot;: &quot;t2&quot;})]:</span>
<span class="sd">                client.create_registered_model(name, tags)</span>

<span class="sd">            # Fetch all registered models</span>
<span class="sd">            print_registered_models_info(client.search_registered_models())</span>
<span class="sd">            # Delete a tag from model `name2`</span>
<span class="sd">            client.delete_registered_model_tag(&quot;name2&quot;, &quot;t2&quot;)</span>
<span class="sd">            print_registered_models_info(client.search_registered_models())</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            --</span>
<span class="sd">            name: name1</span>
<span class="sd">            tags: {&#39;t1&#39;: &#39;t1&#39;}</span>
<span class="sd">            name: name2</span>
<span class="sd">            tags: {&#39;t2&#39;: &#39;t2&#39;}</span>
<span class="sd">            --</span>
<span class="sd">            name: name1</span>
<span class="sd">            tags: {&#39;t1&#39;: &#39;t1&#39;}</span>
<span class="sd">            name: name2</span>
<span class="sd">            tags: {}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">delete_registered_model_tag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></div>

    <span class="c1"># Model Version Methods</span>

    <span class="k">def</span> <span class="nf">_create_model_version</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">run_link</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">await_creation_for</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_AWAIT_MAX_SLEEP_SECONDS</span><span class="p">,</span>
        <span class="n">local_model_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModelVersion</span><span class="p">:</span>
        <span class="n">tracking_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracking_client</span><span class="o">.</span><span class="n">tracking_uri</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="n">run_link</span>
            <span class="ow">and</span> <span class="n">is_databricks_uri</span><span class="p">(</span><span class="n">tracking_uri</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">tracking_uri</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_registry_uri</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_databricks_unity_catalog_uri</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_registry_uri</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">run_id</span><span class="p">:</span>
                <span class="n">eprint</span><span class="p">(</span>
                    <span class="s2">&quot;Warning: no run_link will be recorded with the model version &quot;</span>
                    <span class="s2">&quot;because no run_id was given&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">run_link</span> <span class="o">=</span> <span class="n">get_databricks_run_url</span><span class="p">(</span><span class="n">tracking_uri</span><span class="p">,</span> <span class="n">run_id</span><span class="p">)</span>
        <span class="n">new_source</span> <span class="o">=</span> <span class="n">source</span>
        <span class="k">if</span> <span class="n">is_databricks_uri</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_registry_uri</span><span class="p">)</span> <span class="ow">and</span> <span class="n">tracking_uri</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_registry_uri</span><span class="p">:</span>
            <span class="c1"># Print out some info for user since the copy may take a while for large models.</span>
            <span class="n">eprint</span><span class="p">(</span>
                <span class="s2">&quot;=== Copying model files from the source location to the model&quot;</span>
                <span class="o">+</span> <span class="s2">&quot; registry workspace ===&quot;</span>
            <span class="p">)</span>
            <span class="n">new_source</span> <span class="o">=</span> <span class="n">_upload_artifacts_to_databricks</span><span class="p">(</span>
                <span class="n">source</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="n">tracking_uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_registry_uri</span>
            <span class="p">)</span>
            <span class="c1"># NOTE: we can&#39;t easily delete the target temp location due to the async nature</span>
            <span class="c1"># of the model version creation - printing to let the user know.</span>
            <span class="n">eprint</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;=== Source model files were copied to </span><span class="si">{</span><span class="n">new_source</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="o">+</span> <span class="s2">&quot; in the model registry workspace. You may want to delete the files once the&quot;</span>
                <span class="o">+</span> <span class="s2">&quot; model version is in &#39;READY&#39; status. You can also find this location in the&quot;</span>
                <span class="o">+</span> <span class="s2">&quot; `source` field of the created model version. ===&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">create_model_version</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">source</span><span class="o">=</span><span class="n">new_source</span><span class="p">,</span>
            <span class="n">run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">,</span>
            <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
            <span class="n">run_link</span><span class="o">=</span><span class="n">run_link</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">await_creation_for</span><span class="o">=</span><span class="n">await_creation_for</span><span class="p">,</span>
            <span class="n">local_model_path</span><span class="o">=</span><span class="n">local_model_path</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="MlflowClient.create_model_version"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.create_model_version">[docs]</a>    <span class="k">def</span> <span class="nf">create_model_version</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">run_link</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">await_creation_for</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_AWAIT_MAX_SLEEP_SECONDS</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModelVersion</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new model version from given source.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name for the containing registered model.</span>
<span class="sd">            source: URI indicating the location of the model artifacts. The artifact URI can be</span>
<span class="sd">                run relative (e.g. ``runs:/&lt;run_id&gt;/&lt;model_artifact_path&gt;``), a model</span>
<span class="sd">                registry URI (e.g. ``models:/&lt;model_name&gt;/&lt;version&gt;``), or other URIs</span>
<span class="sd">                supported by the model registry backend (e.g. `&quot;s3://my_bucket/my/model&quot;`).</span>
<span class="sd">            run_id: Run ID from MLflow tracking server that generated the model.</span>
<span class="sd">            tags: A dictionary of key-value pairs that are converted into</span>
<span class="sd">                :py:class:`mlflow.entities.model_registry.ModelVersionTag` objects.</span>
<span class="sd">            run_link: Link to the run from an MLflow tracking server that generated this model.</span>
<span class="sd">            description: Description of the version.</span>
<span class="sd">            await_creation_for: Number of seconds to wait for the model version to finish being</span>
<span class="sd">                created and is in ``READY`` status. By default, the function</span>
<span class="sd">                waits for five minutes. Specify 0 or None to skip waiting.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Single :py:class:`mlflow.entities.model_registry.ModelVersion` object created by</span>
<span class="sd">            backend.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow.sklearn</span>
<span class="sd">            from mlflow.store.artifact.runs_artifact_repo import RunsArtifactRepository</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>

<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">            name = &quot;RandomForestRegression&quot;</span>
<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>
<span class="sd">            rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">            signature = infer_signature(X, rfr.predict(X))</span>

<span class="sd">            # Log MLflow entities</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>

<span class="sd">            # Register model name in the model registry</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name)</span>

<span class="sd">            # Create a new version of the rfr model under the registered model name</span>
<span class="sd">            desc = &quot;A new version of the model&quot;</span>
<span class="sd">            runs_uri = f&quot;runs:/{run.info.run_id}/sklearn-model&quot;</span>
<span class="sd">            model_src = RunsArtifactRepository.get_underlying_uri(runs_uri)</span>
<span class="sd">            mv = client.create_model_version(name, model_src, run.info.run_id, description=desc)</span>
<span class="sd">            print(f&quot;Name: {mv.name}&quot;)</span>
<span class="sd">            print(f&quot;Version: {mv.version}&quot;)</span>
<span class="sd">            print(f&quot;Description: {mv.description}&quot;)</span>
<span class="sd">            print(f&quot;Status: {mv.status}&quot;)</span>
<span class="sd">            print(f&quot;Stage: {mv.current_stage}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Description: A new version of the model</span>
<span class="sd">            Status: READY</span>
<span class="sd">            Stage: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_model_version</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
            <span class="n">run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">,</span>
            <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
            <span class="n">run_link</span><span class="o">=</span><span class="n">run_link</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">await_creation_for</span><span class="o">=</span><span class="n">await_creation_for</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.copy_model_version"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.copy_model_version">[docs]</a>    <span class="k">def</span> <span class="nf">copy_model_version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src_model_uri</span><span class="p">,</span> <span class="n">dst_name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModelVersion</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copy a model version from one registered model to another as a new model version.</span>

<span class="sd">        Args:</span>
<span class="sd">            src_model_uri: The model URI of the model version to copy. This must be a model</span>
<span class="sd">                registry URI with a `&quot;models:/&quot;` scheme (e.g., `&quot;models:/iris_model@champion&quot;`).</span>
<span class="sd">            dst_name: The name of the registered model to copy the model version to. If a</span>
<span class="sd">                registered model with this name does not exist, it will be created.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Single :py:class:`mlflow.entities.model_registry.ModelVersion` object representing</span>
<span class="sd">            the copied model version.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow.sklearn</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>


<span class="sd">            def print_model_version_info(mv):</span>
<span class="sd">                print(f&quot;Name: {mv.name}&quot;)</span>
<span class="sd">                print(f&quot;Version: {mv.version}&quot;)</span>
<span class="sd">                print(f&quot;Source: {mv.source}&quot;)</span>


<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>

<span class="sd">            # Log a model</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">                rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">                signature = infer_signature(X, rfr.predict(X))</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>

<span class="sd">            # Create source model version</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            src_name = &quot;RandomForestRegression-staging&quot;</span>
<span class="sd">            client.create_registered_model(src_name)</span>
<span class="sd">            src_uri = f&quot;runs:/{run.info.run_id}/sklearn-model&quot;</span>
<span class="sd">            mv_src = client.create_model_version(src_name, src_uri, run.info.run_id)</span>
<span class="sd">            print_model_version_info(mv_src)</span>
<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # Copy the source model version into a new registered model</span>
<span class="sd">            dst_name = &quot;RandomForestRegression-production&quot;</span>
<span class="sd">            src_model_uri = f&quot;models:/{mv_src.name}/{mv_src.version}&quot;</span>
<span class="sd">            mv_copy = client.copy_model_version(src_model_uri, dst_name)</span>
<span class="sd">            print_model_version_info(mv_copy)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Name: RandomForestRegression-staging</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Source: runs:/53e08bb38f0c487fa36c5872515ed998/sklearn-model</span>
<span class="sd">            --</span>
<span class="sd">            Name: RandomForestRegression-production</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Source: models:/RandomForestRegression-staging/1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">src_model_uri</span><span class="p">)</span><span class="o">.</span><span class="n">scheme</span> <span class="o">!=</span> <span class="s2">&quot;models&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unsupported source model URI: &#39;</span><span class="si">{</span><span class="n">src_model_uri</span><span class="si">}</span><span class="s2">&#39;. The `copy_model_version` API &quot;</span>
                <span class="s2">&quot;only copies models stored in the &#39;models:/&#39; scheme.&quot;</span>
            <span class="p">)</span>
        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">src_name</span><span class="p">,</span> <span class="n">src_version</span> <span class="o">=</span> <span class="n">get_model_name_and_version</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">src_model_uri</span><span class="p">)</span>
            <span class="n">src_mv</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_model_version</span><span class="p">(</span><span class="n">src_name</span><span class="p">,</span> <span class="n">src_version</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">MlflowException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Failed to fetch model version from source model URI: &#39;</span><span class="si">{</span><span class="n">src_model_uri</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
        <span class="k">return</span> <span class="n">client</span><span class="o">.</span><span class="n">copy_model_version</span><span class="p">(</span><span class="n">src_mv</span><span class="o">=</span><span class="n">src_mv</span><span class="p">,</span> <span class="n">dst_name</span><span class="o">=</span><span class="n">dst_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.update_model_version"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.update_model_version">[docs]</a>    <span class="k">def</span> <span class="nf">update_model_version</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModelVersion</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update metadata associated with a model version in backend.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the containing registered model.</span>
<span class="sd">            version: Version number of the model version.</span>
<span class="sd">            description: New description.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A single :py:class:`mlflow.entities.model_registry.ModelVersion` object.</span>

<span class="sd">         .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow.sklearn</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>


<span class="sd">            def print_model_version_info(mv):</span>
<span class="sd">                print(f&quot;Name: {mv.name}&quot;)</span>
<span class="sd">                print(f&quot;Version: {mv.version}&quot;)</span>
<span class="sd">                print(f&quot;Description: {mv.description}&quot;)</span>


<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">            name = &quot;RandomForestRegression&quot;</span>
<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>
<span class="sd">            rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">            signature = infer_signature(X, rfr.predict(X))</span>

<span class="sd">            # Log MLflow entities</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>

<span class="sd">            # Register model name in the model registry</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name)</span>
<span class="sd">            # Create a new version of the rfr model under the registered model name</span>
<span class="sd">            model_uri = f&quot;runs:/{run.info.run_id}/sklearn-model&quot;</span>
<span class="sd">            mv = client.create_model_version(name, model_uri, run.info.run_id)</span>
<span class="sd">            print_model_version_info(mv)</span>
<span class="sd">            print(&quot;--&quot;)</span>
<span class="sd">            # Update model version&#39;s description</span>
<span class="sd">            desc = &quot;A new version of the model using ensemble trees&quot;</span>
<span class="sd">            mv = client.update_model_version(name, mv.version, desc)</span>
<span class="sd">            print_model_version_info(mv)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Description: None</span>
<span class="sd">            --</span>
<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Description: A new version of the model using ensemble trees</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span><span class="s2">&quot;Attempting to update model version with no new field values.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">update_model_version</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.transition_model_version_stage"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.transition_model_version_stage">[docs]</a>    <span class="nd">@deprecated</span><span class="p">(</span><span class="n">since</span><span class="o">=</span><span class="s2">&quot;2.9.0&quot;</span><span class="p">,</span> <span class="n">impact</span><span class="o">=</span><span class="n">_STAGES_DEPRECATION_WARNING</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">transition_model_version_stage</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stage</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">archive_existing_versions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModelVersion</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update model version stage.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Registered model name.</span>
<span class="sd">            version: Registered model version.</span>
<span class="sd">            stage: New desired stage for this model version.</span>
<span class="sd">            archive_existing_versions: If this flag is set to ``True``, all existing model</span>
<span class="sd">                versions in the stage will be automatically moved to the &quot;archived&quot; stage. Only</span>
<span class="sd">                valid when ``stage`` is ``&quot;staging&quot;`` or ``&quot;production&quot;`` otherwise an error will be</span>
<span class="sd">                raised.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A single :py:class:`mlflow.entities.model_registry.ModelVersion` object.</span>

<span class="sd">         .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow.sklearn</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>


<span class="sd">            def print_model_version_info(mv):</span>
<span class="sd">                print(f&quot;Name: {mv.name}&quot;)</span>
<span class="sd">                print(f&quot;Version: {mv.version}&quot;)</span>
<span class="sd">                print(f&quot;Description: {mv.description}&quot;)</span>
<span class="sd">                print(f&quot;Stage: {mv.current_stage}&quot;)</span>


<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">            name = &quot;RandomForestRegression&quot;</span>
<span class="sd">            desc = &quot;A new version of the model using ensemble trees&quot;</span>
<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>
<span class="sd">            rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">            signature = infer_signature(X, rfr.predict(X))</span>

<span class="sd">            # Log MLflow entities</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>

<span class="sd">            # Register model name in the model registry</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name)</span>

<span class="sd">            # Create a new version of the rfr model under the registered model name</span>
<span class="sd">            model_uri = f&quot;runs:/{run.info.run_id}/sklearn-model&quot;</span>
<span class="sd">            mv = client.create_model_version(name, model_uri, run.info.run_id, description=desc)</span>
<span class="sd">            print_model_version_info(mv)</span>
<span class="sd">            print(&quot;--&quot;)</span>
<span class="sd">            # transition model version from None -&gt; staging</span>
<span class="sd">            mv = client.transition_model_version_stage(name, mv.version, &quot;staging&quot;)</span>
<span class="sd">            print_model_version_info(mv)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Description: A new version of the model using ensemble trees</span>
<span class="sd">            Stage: None</span>
<span class="sd">            --</span>
<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Description: A new version of the model using ensemble trees</span>
<span class="sd">            Stage: Staging</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">transition_model_version_stage</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">stage</span><span class="p">,</span> <span class="n">archive_existing_versions</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.delete_model_version"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.delete_model_version">[docs]</a>    <span class="k">def</span> <span class="nf">delete_model_version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete model version in backend.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the containing registered model.</span>
<span class="sd">            version: Version number of the model version.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow.sklearn</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>


<span class="sd">            def print_models_info(mv):</span>
<span class="sd">                for m in mv:</span>
<span class="sd">                    print(f&quot;name: {m.name}&quot;)</span>
<span class="sd">                    print(f&quot;latest version: {m.version}&quot;)</span>
<span class="sd">                    print(f&quot;run_id: {m.run_id}&quot;)</span>
<span class="sd">                    print(f&quot;current_stage: {m.current_stage}&quot;)</span>


<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>

<span class="sd">            # Create two runs and log MLflow entities</span>
<span class="sd">            with mlflow.start_run() as run1:</span>
<span class="sd">                params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">                rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">                signature = infer_signature(X, rfr.predict(X))</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>

<span class="sd">            with mlflow.start_run() as run2:</span>
<span class="sd">                params = {&quot;n_estimators&quot;: 6, &quot;random_state&quot;: 42}</span>
<span class="sd">                rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">                signature = infer_signature(X, rfr.predict(X))</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>

<span class="sd">            # Register model name in the model registry</span>
<span class="sd">            name = &quot;RandomForestRegression&quot;</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name)</span>

<span class="sd">            # Create a two versions of the rfr model under the registered model name</span>
<span class="sd">            for run_id in [run1.info.run_id, run2.info.run_id]:</span>
<span class="sd">                model_uri = f&quot;runs:/{run_id}/sklearn-model&quot;</span>
<span class="sd">                mv = client.create_model_version(name, model_uri, run_id)</span>
<span class="sd">                print(f&quot;model version {mv.version} created&quot;)</span>

<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # Fetch latest version; this will be version 2</span>
<span class="sd">            models = client.get_latest_versions(name, stages=[&quot;None&quot;])</span>
<span class="sd">            print_models_info(models)</span>
<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # Delete the latest model version 2</span>
<span class="sd">            print(f&quot;Deleting model version {mv.version}&quot;)</span>
<span class="sd">            client.delete_model_version(name, mv.version)</span>
<span class="sd">            models = client.get_latest_versions(name, stages=[&quot;None&quot;])</span>
<span class="sd">            print_models_info(models)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            model version 1 created</span>
<span class="sd">            model version 2 created</span>
<span class="sd">            --</span>
<span class="sd">            name: RandomForestRegression</span>
<span class="sd">            latest version: 2</span>
<span class="sd">            run_id: 9881172ef10f4cb08df3ed452c0c362b</span>
<span class="sd">            current_stage: None</span>
<span class="sd">            --</span>
<span class="sd">            Deleting model version 2</span>
<span class="sd">            name: RandomForestRegression</span>
<span class="sd">            latest version: 1</span>
<span class="sd">            run_id: 9165d4f8aa0a4d069550824bdc55caaf</span>
<span class="sd">            current_stage: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">delete_model_version</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.get_model_version"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.get_model_version">[docs]</a>    <span class="k">def</span> <span class="nf">get_model_version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModelVersion</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the docstring args and returns to google style.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the containing registered model.</span>
<span class="sd">            version: Version number as an integer of the model version.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A single :py:class:`mlflow.entities.model_registry.ModelVersion` object.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow.sklearn</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>

<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>

<span class="sd">            # Create two runs Log MLflow entities</span>
<span class="sd">            with mlflow.start_run() as run1:</span>
<span class="sd">                params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">                rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">                signature = infer_signature(X, rfr.predict(X))</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>

<span class="sd">            with mlflow.start_run() as run2:</span>
<span class="sd">                params = {&quot;n_estimators&quot;: 6, &quot;random_state&quot;: 42}</span>
<span class="sd">                rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">                signature = infer_signature(X, rfr.predict(X))</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>

<span class="sd">            # Register model name in the model registry</span>
<span class="sd">            name = &quot;RandomForestRegression&quot;</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name)</span>

<span class="sd">            # Create a two versions of the rfr model under the registered model name</span>
<span class="sd">            for run_id in [run1.info.run_id, run2.info.run_id]:</span>
<span class="sd">                model_uri = f&quot;runs:/{run_id}/sklearn-model&quot;</span>
<span class="sd">                mv = client.create_model_version(name, model_uri, run_id)</span>
<span class="sd">                print(f&quot;model version {mv.version} created&quot;)</span>
<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # Fetch the last version; this will be version 2</span>
<span class="sd">            mv = client.get_model_version(name, mv.version)</span>
<span class="sd">            print(f&quot;Name: {mv.name}&quot;)</span>
<span class="sd">            print(f&quot;Version: {mv.version}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            model version 1 created</span>
<span class="sd">            model version 2 created</span>
<span class="sd">            --</span>
<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 2</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">get_model_version</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.get_model_version_download_uri"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.get_model_version_download_uri">[docs]</a>    <span class="k">def</span> <span class="nf">get_model_version_download_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the download location in Model Registry for this model version.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name of the containing registered model.</span>
<span class="sd">            version: Version number as an integer of the model version.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A single URI location that allows reads for downloading.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            import mlflow.sklearn</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>

<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">            name = &quot;RandomForestRegression&quot;</span>
<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>
<span class="sd">            rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">            signature = infer_signature(X, rfr.predict(X))</span>

<span class="sd">            # Log MLflow entities</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>

<span class="sd">            # Register model name in the model registry</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name)</span>

<span class="sd">            # Create a new version of the rfr model under the registered model name</span>
<span class="sd">            model_uri = f&quot;runs:/{run.info.run_id}/sklearn-model&quot;</span>
<span class="sd">            mv = client.create_model_version(name, model_uri, run.info.run_id)</span>
<span class="sd">            artifact_uri = client.get_model_version_download_uri(name, mv.version)</span>
<span class="sd">            print(f&quot;Download URI: {artifact_uri}&quot;)</span>

<span class="sd">        .. code-block:: text</span>

<span class="sd">            Download URI: runs:/027d7bbe81924c5a82b3e4ce979fcab7/sklearn-model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">get_model_version_download_uri</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.search_model_versions"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.search_model_versions">[docs]</a>    <span class="k">def</span> <span class="nf">search_model_versions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filter_string</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">SEARCH_MODEL_VERSION_MAX_RESULTS_DEFAULT</span><span class="p">,</span>
        <span class="n">order_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">page_token</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PagedList</span><span class="p">[</span><span class="n">ModelVersion</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Search for model versions in backend that satisfy the filter criteria.</span>

<span class="sd">        .. warning:</span>
<span class="sd">            The model version search results may not have aliases populated for performance reasons.</span>

<span class="sd">        Args:</span>
<span class="sd">            filter_string: Filter query string</span>
<span class="sd">                (e.g., ``&quot;name = &#39;a_model_name&#39; and tag.key = &#39;value1&#39;&quot;``),</span>
<span class="sd">                defaults to searching for all model versions. The following identifiers,</span>
<span class="sd">                comparators, and logical operators are supported.</span>

<span class="sd">                Identifiers</span>
<span class="sd">                  - ``name``: model name.</span>
<span class="sd">                  - ``source_path``: model version source path.</span>
<span class="sd">                  - ``run_id``: The id of the mlflow run that generates the model version.</span>
<span class="sd">                  - ``tags.&lt;tag_key&gt;``: model version tag. If ``tag_key`` contains spaces, it must</span>
<span class="sd">                    be wrapped with backticks (e.g., ``&quot;tags.`extra key`&quot;``).</span>

<span class="sd">                Comparators</span>
<span class="sd">                  - ``=``: Equal to.</span>
<span class="sd">                  - ``!=``: Not equal to.</span>
<span class="sd">                  - ``LIKE``: Case-sensitive pattern match.</span>
<span class="sd">                  - ``ILIKE``: Case-insensitive pattern match.</span>
<span class="sd">                  - ``IN``: In a value list. Only ``run_id`` identifier supports ``IN`` comparator.</span>

<span class="sd">                Logical operators</span>
<span class="sd">                  - ``AND``: Combines two sub-queries and returns True if both of them are True.</span>

<span class="sd">            max_results: Maximum number of model versions desired.</span>
<span class="sd">            order_by: List of column names with ASC|DESC annotation, to be used for ordering</span>
<span class="sd">                matching search results.</span>
<span class="sd">            page_token: Token specifying the next page of results. It should be obtained from</span>
<span class="sd">                a ``search_model_versions`` call.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A PagedList of :py:class:`mlflow.entities.model_registry.ModelVersion`</span>
<span class="sd">            objects that satisfy the search expressions. The pagination token for the next</span>
<span class="sd">            page can be obtained via the ``token`` attribute of the object.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>

<span class="sd">            client = MlflowClient()</span>

<span class="sd">            # Get all versions of the model filtered by name</span>
<span class="sd">            model_name = &quot;CordobaWeatherForecastModel&quot;</span>
<span class="sd">            filter_string = f&quot;name=&#39;{model_name}&#39;&quot;</span>
<span class="sd">            results = client.search_model_versions(filter_string)</span>
<span class="sd">            print(&quot;-&quot; * 80)</span>
<span class="sd">            for res in results:</span>
<span class="sd">                print(f&quot;name={res.name}; run_id={res.run_id}; version={res.version}&quot;)</span>

<span class="sd">            # Get the version of the model filtered by run_id</span>
<span class="sd">            run_id = &quot;e14afa2f47a040728060c1699968fd43&quot;</span>
<span class="sd">            filter_string = f&quot;run_id=&#39;{run_id}&#39;&quot;</span>
<span class="sd">            results = client.search_model_versions(filter_string)</span>
<span class="sd">            print(&quot;-&quot; * 80)</span>
<span class="sd">            for res in results:</span>
<span class="sd">                print(f&quot;name={res.name}; run_id={res.run_id}; version={res.version}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            ------------------------------------------------------------------------------------</span>
<span class="sd">            name=CordobaWeatherForecastModel; run_id=eaef868ee3d14d10b4299c4c81ba8814; version=1</span>
<span class="sd">            name=CordobaWeatherForecastModel; run_id=e14afa2f47a040728060c1699968fd43; version=2</span>
<span class="sd">            ------------------------------------------------------------------------------------</span>
<span class="sd">            name=CordobaWeatherForecastModel; run_id=e14afa2f47a040728060c1699968fd43; version=2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">search_model_versions</span><span class="p">(</span>
            <span class="n">filter_string</span><span class="p">,</span> <span class="n">max_results</span><span class="p">,</span> <span class="n">order_by</span><span class="p">,</span> <span class="n">page_token</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.get_model_version_stages"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.get_model_version_stages">[docs]</a>    <span class="nd">@deprecated</span><span class="p">(</span><span class="n">since</span><span class="o">=</span><span class="s2">&quot;2.9.0&quot;</span><span class="p">,</span> <span class="n">impact</span><span class="o">=</span><span class="n">_STAGES_DEPRECATION_WARNING</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">get_model_version_stages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a docstring. Here is info.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of valid stages.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow.sklearn</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>

<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">            name = &quot;RandomForestRegression&quot;</span>
<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>
<span class="sd">            rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">            signature = infer_signature(X, rfr.predict(X))</span>

<span class="sd">            # Log MLflow entities</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>

<span class="sd">            # Register model name in the model registry</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name)</span>

<span class="sd">            # Create a new version of the rfr model under the registered model name</span>
<span class="sd">            # fetch valid stages</span>
<span class="sd">            model_uri = f&quot;runs:/{run.info.run_id}/models/sklearn-model&quot;</span>
<span class="sd">            mv = client.create_model_version(name, model_uri, run.info.run_id)</span>
<span class="sd">            stages = client.get_model_version_stages(name, mv.version)</span>
<span class="sd">            print(f&quot;Model list of valid stages: {stages}&quot;)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Model list of valid stages: [&#39;None&#39;, &#39;Staging&#39;, &#39;Production&#39;, &#39;Archived&#39;]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ALL_STAGES</span></div>

<div class="viewcode-block" id="MlflowClient.set_model_version_tag"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.set_model_version_tag">[docs]</a>    <span class="k">def</span> <span class="nf">set_model_version_tag</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set a tag for the model version.</span>
<span class="sd">        When stage is set, tag will be set for latest model version of the stage.</span>
<span class="sd">        Setting both version and stage parameter will result in error.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Registered model name.</span>
<span class="sd">            version: Registered model version.</span>
<span class="sd">            key: Tag key to log. key is required.</span>
<span class="sd">            value: Tag value to log. value is required.</span>
<span class="sd">            stage: Registered model stage.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow.sklearn</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>


<span class="sd">            def print_model_version_info(mv):</span>
<span class="sd">                print(f&quot;Name: {mv.name}&quot;)</span>
<span class="sd">                print(f&quot;Version: {mv.version}&quot;)</span>
<span class="sd">                print(f&quot;Tags: {mv.tags}&quot;)</span>


<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">            name = &quot;RandomForestRegression&quot;</span>
<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>
<span class="sd">            rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">            signature = infer_signature(X, rfr.predict(X))</span>

<span class="sd">            # Log MLflow entities</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>

<span class="sd">            # Register model name in the model registry</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name)</span>

<span class="sd">            # Create a new version of the rfr model under the registered model name</span>
<span class="sd">            # and set a tag</span>
<span class="sd">            model_uri = f&quot;runs:/{run.info.run_id}/sklearn-model&quot;</span>
<span class="sd">            mv = client.create_model_version(name, model_uri, run.info.run_id)</span>
<span class="sd">            print_model_version_info(mv)</span>
<span class="sd">            print(&quot;--&quot;)</span>

<span class="sd">            # Tag using model version</span>
<span class="sd">            client.set_model_version_tag(name, mv.version, &quot;t&quot;, &quot;1&quot;)</span>

<span class="sd">            # Tag using model stage</span>
<span class="sd">            client.set_model_version_tag(name, key=&quot;t1&quot;, value=&quot;1&quot;, stage=mv.current_stage)</span>
<span class="sd">            mv = client.get_model_version(name, mv.version)</span>
<span class="sd">            print_model_version_info(mv)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Tags: {}</span>
<span class="sd">            --</span>
<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Tags: {&#39;t&#39;: &#39;1&#39;, &#39;t1&#39;: &#39;1&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_validate_model_version_or_stage_exists</span><span class="p">(</span><span class="n">version</span><span class="p">,</span> <span class="n">stage</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">stage</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The `stage` parameter of the `set_model_version_tag` API is deprecated. &quot;</span>
                <span class="o">+</span> <span class="n">_STAGES_DEPRECATION_WARNING</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">latest_versions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_latest_versions</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">stages</span><span class="o">=</span><span class="p">[</span><span class="n">stage</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">latest_versions</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not find any model version for </span><span class="si">{</span><span class="n">stage</span><span class="si">}</span><span class="s2"> stage&quot;</span><span class="p">)</span>
            <span class="n">version</span> <span class="o">=</span> <span class="n">latest_versions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">version</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">set_model_version_tag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.delete_model_version_tag"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.delete_model_version_tag">[docs]</a>    <span class="k">def</span> <span class="nf">delete_model_version_tag</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete a tag associated with the model version.</span>

<span class="sd">        When stage is set, tag will be deleted for latest model version of the stage.</span>
<span class="sd">        Setting both version and stage parameter will result in error.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Registered model name.</span>
<span class="sd">            version: Registered model version.</span>
<span class="sd">            key: Tag key. key is required.</span>
<span class="sd">            stage: Registered model stage.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow.sklearn</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>


<span class="sd">            def print_model_version_info(mv):</span>
<span class="sd">                print(f&quot;Name: {mv.name}&quot;)</span>
<span class="sd">                print(f&quot;Version: {mv.version}&quot;)</span>
<span class="sd">                print(f&quot;Tags: {mv.tags}&quot;)</span>


<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">            name = &quot;RandomForestRegression&quot;</span>
<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>
<span class="sd">            rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">            signature = infer_signature(X, rfr.predict(X))</span>

<span class="sd">            # Log MLflow entities</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>
<span class="sd">            # Register model name in the model registry</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name)</span>

<span class="sd">            # Create a new version of the rfr model under the registered model name</span>
<span class="sd">            # and delete a tag</span>
<span class="sd">            model_uri = f&quot;runs:/{run.info.run_id}/sklearn-model&quot;</span>
<span class="sd">            tags = {&quot;t&quot;: &quot;1&quot;, &quot;t1&quot;: &quot;2&quot;}</span>
<span class="sd">            mv = client.create_model_version(name, model_uri, run.info.run_id, tags=tags)</span>
<span class="sd">            print_model_version_info(mv)</span>
<span class="sd">            print(&quot;--&quot;)</span>
<span class="sd">            # using version to delete tag</span>
<span class="sd">            client.delete_model_version_tag(name, mv.version, &quot;t&quot;)</span>

<span class="sd">            # using stage to delete tag</span>
<span class="sd">            client.delete_model_version_tag(name, key=&quot;t1&quot;, stage=mv.current_stage)</span>
<span class="sd">            mv = client.get_model_version(name, mv.version)</span>
<span class="sd">            print_model_version_info(mv)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Tags: {&#39;t&#39;: &#39;1&#39;, &#39;t1&#39;: &#39;2&#39;}</span>
<span class="sd">            --</span>
<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Tags: {}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_validate_model_version_or_stage_exists</span><span class="p">(</span><span class="n">version</span><span class="p">,</span> <span class="n">stage</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">stage</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The `stage` parameter of the `delete_model_version_tag` API is deprecated. &quot;</span>
                <span class="o">+</span> <span class="n">_STAGES_DEPRECATION_WARNING</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">latest_versions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_latest_versions</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">stages</span><span class="o">=</span><span class="p">[</span><span class="n">stage</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">latest_versions</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not find any model version for </span><span class="si">{</span><span class="n">stage</span><span class="si">}</span><span class="s2"> stage&quot;</span><span class="p">)</span>
            <span class="n">version</span> <span class="o">=</span> <span class="n">latest_versions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">delete_model_version_tag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.set_registered_model_alias"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.set_registered_model_alias">[docs]</a>    <span class="k">def</span> <span class="nf">set_registered_model_alias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a registered model alias pointing to a model version.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Registered model name.</span>
<span class="sd">            alias: Name of the alias. Note that aliases of the format ``v&lt;number&gt;``, such as</span>
<span class="sd">                ``v9`` and ``v42``, are reserved and cannot be set.</span>
<span class="sd">            version: Registered model version number.</span>

<span class="sd">        .. code-block:: Python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>


<span class="sd">            def print_model_info(rm):</span>
<span class="sd">                print(&quot;--Model--&quot;)</span>
<span class="sd">                print(&quot;name: {}&quot;.format(rm.name))</span>
<span class="sd">                print(&quot;aliases: {}&quot;.format(rm.aliases))</span>


<span class="sd">            def print_model_version_info(mv):</span>
<span class="sd">                print(&quot;--Model Version--&quot;)</span>
<span class="sd">                print(&quot;Name: {}&quot;.format(mv.name))</span>
<span class="sd">                print(&quot;Version: {}&quot;.format(mv.version))</span>
<span class="sd">                print(&quot;Aliases: {}&quot;.format(mv.aliases))</span>


<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">            name = &quot;RandomForestRegression&quot;</span>
<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>
<span class="sd">            rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">            signature = infer_signature(X, rfr.predict(X))</span>

<span class="sd">            # Log MLflow entities</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>

<span class="sd">            # Register model name in the model registry</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name)</span>
<span class="sd">            model = client.get_registered_model(name)</span>
<span class="sd">            print_model_info(model)</span>

<span class="sd">            # Create a new version of the rfr model under the registered model name</span>
<span class="sd">            model_uri = &quot;runs:/{}/sklearn-model&quot;.format(run.info.run_id)</span>
<span class="sd">            mv = client.create_model_version(name, model_uri, run.info.run_id)</span>
<span class="sd">            print_model_version_info(mv)</span>

<span class="sd">            # Set registered model alias</span>
<span class="sd">            client.set_registered_model_alias(name, &quot;test-alias&quot;, mv.version)</span>
<span class="sd">            print()</span>
<span class="sd">            print_model_info(model)</span>
<span class="sd">            print_model_version_info(mv)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            --Model--</span>
<span class="sd">            name: RandomForestRegression</span>
<span class="sd">            aliases: {}</span>

<span class="sd">            --Model Version--</span>
<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Aliases: []</span>

<span class="sd">            --Model--</span>
<span class="sd">            name: RandomForestRegression</span>
<span class="sd">            aliases: {&quot;test-alias&quot;: &quot;1&quot;}</span>

<span class="sd">            --Model Version--</span>
<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Aliases: [&quot;test-alias&quot;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_validate_model_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">_validate_model_alias_name</span><span class="p">(</span><span class="n">alias</span><span class="p">)</span>
        <span class="n">_validate_model_version</span><span class="p">(</span><span class="n">version</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">set_registered_model_alias</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alias</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.delete_registered_model_alias"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.delete_registered_model_alias">[docs]</a>    <span class="k">def</span> <span class="nf">delete_registered_model_alias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete an alias associated with a registered model.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Registered model name.</span>
<span class="sd">            alias: Name of the alias.</span>

<span class="sd">        .. code-block:: Python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>


<span class="sd">            def print_model_info(rm):</span>
<span class="sd">                print(&quot;--Model--&quot;)</span>
<span class="sd">                print(&quot;name: {}&quot;.format(rm.name))</span>
<span class="sd">                print(&quot;aliases: {}&quot;.format(rm.aliases))</span>


<span class="sd">            def print_model_version_info(mv):</span>
<span class="sd">                print(&quot;--Model Version--&quot;)</span>
<span class="sd">                print(&quot;Name: {}&quot;.format(mv.name))</span>
<span class="sd">                print(&quot;Version: {}&quot;.format(mv.version))</span>
<span class="sd">                print(&quot;Aliases: {}&quot;.format(mv.aliases))</span>


<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">            name = &quot;RandomForestRegression&quot;</span>
<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>
<span class="sd">            rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">            signature = infer_signature(X, rfr.predict(X))</span>

<span class="sd">            # Log MLflow entities</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>

<span class="sd">            # Register model name in the model registry</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name)</span>
<span class="sd">            model = client.get_registered_model(name)</span>
<span class="sd">            print_model_info(model)</span>

<span class="sd">            # Create a new version of the rfr model under the registered model name</span>
<span class="sd">            model_uri = &quot;runs:/{}/sklearn-model&quot;.format(run.info.run_id)</span>
<span class="sd">            mv = client.create_model_version(name, model_uri, run.info.run_id)</span>
<span class="sd">            print_model_version_info(mv)</span>

<span class="sd">            # Set registered model alias</span>
<span class="sd">            client.set_registered_model_alias(name, &quot;test-alias&quot;, mv.version)</span>
<span class="sd">            print()</span>
<span class="sd">            print_model_info(model)</span>
<span class="sd">            print_model_version_info(mv)</span>

<span class="sd">            # Delete registered model alias</span>
<span class="sd">            client.delete_registered_model_alias(name, &quot;test-alias&quot;)</span>
<span class="sd">            print()</span>
<span class="sd">            print_model_info(model)</span>
<span class="sd">            print_model_version_info(mv)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            --Model--</span>
<span class="sd">            name: RandomForestRegression</span>
<span class="sd">            aliases: {}</span>
<span class="sd">            --Model Version--</span>
<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Aliases: []</span>

<span class="sd">            --Model--</span>
<span class="sd">            name: RandomForestRegression</span>
<span class="sd">            aliases: {&quot;test-alias&quot;: &quot;1&quot;}</span>
<span class="sd">            --Model Version--</span>
<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Aliases: [&quot;test-alias&quot;]</span>

<span class="sd">            --Model--</span>
<span class="sd">            name: RandomForestRegression</span>
<span class="sd">            aliases: {}</span>
<span class="sd">            --Model Version--</span>
<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Aliases: []</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_validate_model_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">_validate_model_alias_name</span><span class="p">(</span><span class="n">alias</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">delete_registered_model_alias</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alias</span><span class="p">)</span></div>

<div class="viewcode-block" id="MlflowClient.get_model_version_by_alias"><a class="viewcode-back" href="../../../python_api/mlflow.client.html#mlflow.client.MlflowClient.get_model_version_by_alias">[docs]</a>    <span class="k">def</span> <span class="nf">get_model_version_by_alias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModelVersion</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the model version instance by name and alias.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Registered model name.</span>
<span class="sd">            alias: Name of the alias.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A single :py:class:`mlflow.entities.model_registry.ModelVersion` object.</span>

<span class="sd">         .. code-block:: Python</span>
<span class="sd">            :caption: Example</span>

<span class="sd">            import mlflow</span>
<span class="sd">            from mlflow import MlflowClient</span>
<span class="sd">            from mlflow.models import infer_signature</span>
<span class="sd">            from sklearn.datasets import make_regression</span>
<span class="sd">            from sklearn.ensemble import RandomForestRegressor</span>


<span class="sd">            def print_model_info(rm):</span>
<span class="sd">                print(&quot;--Model--&quot;)</span>
<span class="sd">                print(&quot;name: {}&quot;.format(rm.name))</span>
<span class="sd">                print(&quot;aliases: {}&quot;.format(rm.aliases))</span>


<span class="sd">            def print_model_version_info(mv):</span>
<span class="sd">                print(&quot;--Model Version--&quot;)</span>
<span class="sd">                print(&quot;Name: {}&quot;.format(mv.name))</span>
<span class="sd">                print(&quot;Version: {}&quot;.format(mv.version))</span>
<span class="sd">                print(&quot;Aliases: {}&quot;.format(mv.aliases))</span>


<span class="sd">            mlflow.set_tracking_uri(&quot;sqlite:///mlruns.db&quot;)</span>
<span class="sd">            params = {&quot;n_estimators&quot;: 3, &quot;random_state&quot;: 42}</span>
<span class="sd">            name = &quot;RandomForestRegression&quot;</span>
<span class="sd">            X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)</span>
<span class="sd">            rfr = RandomForestRegressor(**params).fit(X, y)</span>
<span class="sd">            signature = infer_signature(X, rfr.predict(X))</span>
<span class="sd">            # Log MLflow entities</span>
<span class="sd">            with mlflow.start_run() as run:</span>
<span class="sd">                mlflow.log_params(params)</span>
<span class="sd">                mlflow.sklearn.log_model(rfr, artifact_path=&quot;sklearn-model&quot;, signature=signature)</span>
<span class="sd">            # Register model name in the model registry</span>
<span class="sd">            client = MlflowClient()</span>
<span class="sd">            client.create_registered_model(name)</span>
<span class="sd">            model = client.get_registered_model(name)</span>
<span class="sd">            print_model_info(model)</span>
<span class="sd">            # Create a new version of the rfr model under the registered model name</span>
<span class="sd">            model_uri = &quot;runs:/{}/sklearn-model&quot;.format(run.info.run_id)</span>
<span class="sd">            mv = client.create_model_version(name, model_uri, run.info.run_id)</span>
<span class="sd">            print_model_version_info(mv)</span>
<span class="sd">            # Set registered model alias</span>
<span class="sd">            client.set_registered_model_alias(name, &quot;test-alias&quot;, mv.version)</span>
<span class="sd">            print()</span>
<span class="sd">            print_model_info(model)</span>
<span class="sd">            print_model_version_info(mv)</span>
<span class="sd">            # Get model version by alias</span>
<span class="sd">            alias_mv = client.get_model_version_by_alias(name, &quot;test-alias&quot;)</span>
<span class="sd">            print()</span>
<span class="sd">            print_model_version_info(alias_mv)</span>

<span class="sd">        .. code-block:: text</span>
<span class="sd">            :caption: Output</span>

<span class="sd">            --Model--</span>
<span class="sd">            name: RandomForestRegression</span>
<span class="sd">            aliases: {}</span>
<span class="sd">            --Model Version--</span>
<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Aliases: []</span>
<span class="sd">            --Model--</span>
<span class="sd">            name: RandomForestRegression</span>
<span class="sd">            aliases: {&quot;test-alias&quot;: &quot;1&quot;}</span>
<span class="sd">            --Model Version--</span>
<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Aliases: [&quot;test-alias&quot;]</span>
<span class="sd">            --Model Version--</span>
<span class="sd">            Name: RandomForestRegression</span>
<span class="sd">            Version: 1</span>
<span class="sd">            Aliases: [&quot;test-alias&quot;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_validate_model_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_registry_client</span><span class="p">()</span><span class="o">.</span><span class="n">get_model_version_by_alias</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alias</span><span class="p">)</span></div></div>
</pre></div>

              </div>
            </div>
            <footer>
  

  <hr/>

  <div role="contentinfo">
      <p class="copyright">
          &copy; MLflow Project, a Series of LF Projects, LLC. All rights reserved.
      </p>

  </div> 

</footer>
          </div>
        </div>
      </section>
    </main>
  </page>

  


  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:'../../../',
      VERSION:'2.17.1.dev0',
      COLLAPSE_INDEX:false,
      FILE_SUFFIX:'.html',
      LINK_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>

  

  <script type="text/javascript" src="../../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/jquery.waypoints.min.js"></script>

  
  
  
  <script type="text/javascript">var CLIPPY_SVG_PATH = "../../../_static/clippy.svg";</script>
  <script type="text/javascript" src="../../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  

  
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
        }
        // Get the code block designator class entries
        const allHighlights = document.querySelectorAll('.highlight');
        // Disable copyable links for notebook cell numbering and for cell outputs
        const highlights = Array.from(allHighlights).filter(highlight => !highlight.closest('.highlight-none') && 
            !highlight.closest('.nboutput'));
    
        highlights.forEach(function(highlight) {
            const copyIcon = document.createElement('span');
            copyIcon.classList.add('copy-icon');
            copyIcon.innerHTML = '&#xf0ea;';

            copyIcon.addEventListener('click', function() {
                const code = highlight.querySelector('pre').textContent;
                copyToClipboard(code);

                // Flash effect on click
                this.style.color = '#0194E2';
                setTimeout(() => {
                    this.style.color = ''; 
                }, 100);

                // Display "Code copied to clipboard" near the clicked icon
                const message = document.createElement('span');
                message.textContent = "Copied!";
                message.classList.add('copy-message'); 

                // Append the message to the icon
                this.appendChild(message);

                setTimeout(() => {
                    this.removeChild(message);
                }, 500);
            });

            highlight.appendChild(copyIcon);
        });
    });
  </script>


<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        // Force download for notebook-download-btn
        const downloadButtons = document.querySelectorAll('.notebook-download-btn');
        downloadButtons.forEach(function(button) {
            button.addEventListener('click', function(event) {
                event.preventDefault(); // Prevent default behavior

                // Fetch the raw content of the notebook from GitHub
                fetch(button.href)
                    .then(response => response.blob())
                    .then(blob => {
                        const url = window.URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.style.display = 'none';
                        link.href = url;
                        const filename = button.href.split('/').pop();
                        link.download = filename; 

                        document.body.appendChild(link);
                        link.click();

                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(link);
                    })
                    .catch(err => console.error('Error fetching the notebook:', err));
            });
        });
    });
</script> 
</body>
</html>