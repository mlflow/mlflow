

<!DOCTYPE html>
<!-- source: docs/source/_modules/mlflow/tracking/fluent -->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mlflow.tracking.fluent</title>
  
   
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="canonical" href="https://mlflow.org/docs/latest/_modules/mlflow/tracking/fluent.html">
  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    

    

  
    

  

  
  
    

  

  
  
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600" rel="stylesheet">
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/cards.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/grids.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/mobile.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/simple-cards.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/tabs.css" type="text/css" />
    
  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="MLflow 2.17.1.dev0 documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>
<script type="text/javascript" src="../../../_static/jquery.js"></script>
<script type="text/javascript" src="../../../_static/underscore.js"></script>
<script type="text/javascript" src="../../../_static/doctools.js"></script>
<script type="text/javascript" src="../../../_static/tabs.js"></script>
<script type="text/javascript" src="../../../_static/languagesections.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script type="text/javascript" src="../../../_static/runllm.js"></script>

<body class="wy-body-for-nav" role="document">
  

  
  <nav class="wy-nav-top header" role="navigation" aria-label="top navigation">
    <ul>
  <li class="menu-toggle">
    <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
    <a href="../../../index.html" class="wy-nav-top-logo"
      ><img src="../../../_static/MLflow-logo-final-black.png" alt="MLflow"
    /></a>
    <span class="version">2.17.1.dev0</span>
  </li>
</ul>
  </nav>
  <page>
    

    <nav data-toggle="wy-nav-shift" class="wy-nav-side relative">
      <div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
  </form>
</div>


    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../../index.html" class="main-navigation-home"><img src="../../../_static/icons/nav-home.svg"> MLflow</a>
    

    
      

      
        <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../python_api/index.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cli.html">Command-Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../R-api.html">R API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../java_api/index.html">Java API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rest-api.html">REST API</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    

    <p>
      <a id='feedbacklink' href="https://github.com/mlflow/mlflow/blob/master/CONTRIBUTING.md" target="_blank">Contribute</a>
    </p>
  </div>
</div>
    </nav>

    <main class="wy-grid-for-nav">
      <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
        <div class="wy-nav-content">
          <div class="rst-content">
            










<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
        <li><a href="../../index.html">Module code</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>mlflow.tracking.fluent</li>
    
    
    <!-- <li class="wy-breadcrumbs-aside">
      <a href="https://github.com/mlflow/mlflow/blob/master/docs/source/_modules/mlflow/tracking/fluent" class="fa fa-github"> Edit on GitHub</a>
    </li> -->
    
  </ul>
</div>
            <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
              <div itemprop="articleBody">
                
  <h1>Source code for mlflow.tracking.fluent</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Internal module implementing the fluent API, allowing management of an active</span>
<span class="sd">MLflow run. This module is exposed to users at the top-level :py:mod:`mlflow` module.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">atexit</span>
<span class="kn">import</span> <span class="nn">contextlib</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">mlflow</span>
<span class="kn">from</span> <span class="nn">mlflow.data.dataset</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">mlflow.entities</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DatasetInput</span><span class="p">,</span>
    <span class="n">Experiment</span><span class="p">,</span>
    <span class="n">InputTag</span><span class="p">,</span>
    <span class="n">Metric</span><span class="p">,</span>
    <span class="n">Param</span><span class="p">,</span>
    <span class="n">Run</span><span class="p">,</span>
    <span class="n">RunStatus</span><span class="p">,</span>
    <span class="n">RunTag</span><span class="p">,</span>
    <span class="n">ViewType</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">mlflow.entities.lifecycle_stage</span> <span class="kn">import</span> <span class="n">LifecycleStage</span>
<span class="kn">from</span> <span class="nn">mlflow.environment_variables</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">MLFLOW_ENABLE_ASYNC_LOGGING</span><span class="p">,</span>
    <span class="n">MLFLOW_ENABLE_SYSTEM_METRICS_LOGGING</span><span class="p">,</span>
    <span class="n">MLFLOW_EXPERIMENT_ID</span><span class="p">,</span>
    <span class="n">MLFLOW_EXPERIMENT_NAME</span><span class="p">,</span>
    <span class="n">MLFLOW_RUN_ID</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">mlflow.exceptions</span> <span class="kn">import</span> <span class="n">MlflowException</span>
<span class="kn">from</span> <span class="nn">mlflow.protos.databricks_pb2</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">INVALID_PARAMETER_VALUE</span><span class="p">,</span>
    <span class="n">RESOURCE_DOES_NOT_EXIST</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">mlflow.store.tracking</span> <span class="kn">import</span> <span class="n">SEARCH_MAX_RESULTS_DEFAULT</span>
<span class="kn">from</span> <span class="nn">mlflow.tracing.provider</span> <span class="kn">import</span> <span class="n">_get_trace_exporter</span>
<span class="kn">from</span> <span class="nn">mlflow.tracking</span> <span class="kn">import</span> <span class="n">_get_artifact_repo</span><span class="p">,</span> <span class="n">_get_store</span><span class="p">,</span> <span class="n">artifact_utils</span>
<span class="kn">from</span> <span class="nn">mlflow.tracking.client</span> <span class="kn">import</span> <span class="n">MlflowClient</span>
<span class="kn">from</span> <span class="nn">mlflow.tracking.context</span> <span class="kn">import</span> <span class="n">registry</span> <span class="k">as</span> <span class="n">context_registry</span>
<span class="kn">from</span> <span class="nn">mlflow.tracking.default_experiment</span> <span class="kn">import</span> <span class="n">registry</span> <span class="k">as</span> <span class="n">default_experiment_registry</span>
<span class="kn">from</span> <span class="nn">mlflow.utils</span> <span class="kn">import</span> <span class="n">get_results_from_paginated_fn</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.annotations</span> <span class="kn">import</span> <span class="n">experimental</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.async_logging.run_operations</span> <span class="kn">import</span> <span class="n">RunOperations</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.autologging_utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AUTOLOGGING_CONF_KEY_IS_GLOBALLY_CONFIGURED</span><span class="p">,</span>
    <span class="n">AUTOLOGGING_INTEGRATIONS</span><span class="p">,</span>
    <span class="n">autologging_integration</span><span class="p">,</span>
    <span class="n">autologging_is_disabled</span><span class="p">,</span>
    <span class="n">is_testing</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.databricks_utils</span> <span class="kn">import</span> <span class="n">is_in_databricks_runtime</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.import_hooks</span> <span class="kn">import</span> <span class="n">register_post_import_hook</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.mlflow_tags</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">MLFLOW_DATASET_CONTEXT</span><span class="p">,</span>
    <span class="n">MLFLOW_EXPERIMENT_PRIMARY_METRIC_GREATER_IS_BETTER</span><span class="p">,</span>
    <span class="n">MLFLOW_EXPERIMENT_PRIMARY_METRIC_NAME</span><span class="p">,</span>
    <span class="n">MLFLOW_PARENT_RUN_ID</span><span class="p">,</span>
    <span class="n">MLFLOW_RUN_NAME</span><span class="p">,</span>
    <span class="n">MLFLOW_RUN_NOTE</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.time</span> <span class="kn">import</span> <span class="n">get_current_time_millis</span>
<span class="kn">from</span> <span class="nn">mlflow.utils.validation</span> <span class="kn">import</span> <span class="n">_validate_experiment_id_type</span><span class="p">,</span> <span class="n">_validate_run_id</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span>
    <span class="kn">import</span> <span class="nn">matplotlib.figure</span>
    <span class="kn">import</span> <span class="nn">numpy</span>
    <span class="kn">import</span> <span class="nn">pandas</span>
    <span class="kn">import</span> <span class="nn">PIL</span>
    <span class="kn">import</span> <span class="nn">plotly</span>


<span class="n">_active_run_stack</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">run_id_to_system_metrics_monitor</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">_active_experiment_id</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">_last_active_run_id</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">SEARCH_MAX_RESULTS_PANDAS</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">NUM_RUNS_PER_PAGE_PANDAS</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="set_experiment"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.set_experiment">[docs]</a><span class="k">def</span> <span class="nf">set_experiment</span><span class="p">(</span>
    <span class="n">experiment_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">experiment_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Experiment</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the given experiment as the active experiment. The experiment must either be specified by</span>
<span class="sd">    name via `experiment_name` or by ID via `experiment_id`. The experiment name and ID cannot</span>
<span class="sd">    both be specified.</span>

<span class="sd">    .. note::</span>
<span class="sd">        If the experiment being set by name does not exist, a new experiment will be</span>
<span class="sd">        created with the given name. After the experiment has been created, it will be set</span>
<span class="sd">        as the active experiment. On certain platforms, such as Databricks, the experiment name</span>
<span class="sd">        must be an absolute path, e.g. ``&quot;/Users/&lt;username&gt;/my-experiment&quot;``.</span>

<span class="sd">    Args:</span>
<span class="sd">        experiment_name: Case sensitive name of the experiment to be activated.</span>
<span class="sd">        experiment_id: ID of the experiment to be activated. If an experiment with this ID</span>
<span class="sd">            does not exist, an exception is thrown.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An instance of :py:class:`mlflow.entities.Experiment` representing the new active</span>
<span class="sd">        experiment.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        # Set an experiment name, which must be unique and case-sensitive.</span>
<span class="sd">        experiment = mlflow.set_experiment(&quot;Social NLP Experiments&quot;)</span>
<span class="sd">        # Get Experiment Details</span>
<span class="sd">        print(f&quot;Experiment_id: {experiment.experiment_id}&quot;)</span>
<span class="sd">        print(f&quot;Artifact Location: {experiment.artifact_location}&quot;)</span>
<span class="sd">        print(f&quot;Tags: {experiment.tags}&quot;)</span>
<span class="sd">        print(f&quot;Lifecycle_stage: {experiment.lifecycle_stage}&quot;)</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">        Experiment_id: 1</span>
<span class="sd">        Artifact Location: file:///.../mlruns/1</span>
<span class="sd">        Tags: {}</span>
<span class="sd">        Lifecycle_stage: active</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">experiment_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">experiment_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
        <span class="n">experiment_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">experiment_id</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Must specify exactly one of: `experiment_id` or `experiment_name`.&quot;</span><span class="p">,</span>
            <span class="n">error_code</span><span class="o">=</span><span class="n">INVALID_PARAMETER_VALUE</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">client</span> <span class="o">=</span> <span class="n">MlflowClient</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">experiment_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">experiment</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_experiment_by_name</span><span class="p">(</span><span class="n">experiment_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">experiment</span><span class="p">:</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Experiment with name &#39;</span><span class="si">%s</span><span class="s2">&#39; does not exist. Creating a new experiment.&quot;</span><span class="p">,</span>
                <span class="n">experiment_name</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># NB: If two simultaneous threads or processes attempt to set the same experiment</span>
            <span class="c1"># simultaneously, a race condition may be encountered here wherein experiment creation</span>
            <span class="c1"># fails</span>
            <span class="n">experiment_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_experiment</span><span class="p">(</span><span class="n">experiment_name</span><span class="p">)</span>
            <span class="n">experiment</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">experiment</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">experiment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Experiment with ID &#39;</span><span class="si">{</span><span class="n">experiment_id</span><span class="si">}</span><span class="s2">&#39; does not exist.&quot;</span><span class="p">,</span>
                <span class="n">error_code</span><span class="o">=</span><span class="n">RESOURCE_DOES_NOT_EXIST</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">experiment</span><span class="o">.</span><span class="n">lifecycle_stage</span> <span class="o">!=</span> <span class="n">LifecycleStage</span><span class="o">.</span><span class="n">ACTIVE</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cannot set a deleted experiment </span><span class="si">{</span><span class="n">experiment</span><span class="o">.</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> as the active experiment. &quot;</span>
                <span class="s2">&quot;You can restore the experiment, or permanently delete the &quot;</span>
                <span class="s2">&quot;experiment to create a new one.&quot;</span>
            <span class="p">),</span>
            <span class="n">error_code</span><span class="o">=</span><span class="n">INVALID_PARAMETER_VALUE</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">global</span> <span class="n">_active_experiment_id</span>
    <span class="n">_active_experiment_id</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">experiment_id</span>
    <span class="k">return</span> <span class="n">experiment</span></div>


<span class="k">def</span> <span class="nf">_set_experiment_primary_metric</span><span class="p">(</span>
    <span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">primary_metric</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">greater_is_better</span><span class="p">:</span> <span class="nb">bool</span>
<span class="p">):</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">MlflowClient</span><span class="p">()</span>
    <span class="n">client</span><span class="o">.</span><span class="n">set_experiment_tag</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">,</span> <span class="n">MLFLOW_EXPERIMENT_PRIMARY_METRIC_NAME</span><span class="p">,</span> <span class="n">primary_metric</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">set_experiment_tag</span><span class="p">(</span>
        <span class="n">experiment_id</span><span class="p">,</span> <span class="n">MLFLOW_EXPERIMENT_PRIMARY_METRIC_GREATER_IS_BETTER</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">greater_is_better</span><span class="p">)</span>
    <span class="p">)</span>


<div class="viewcode-block" id="ActiveRun"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.ActiveRun">[docs]</a><span class="k">class</span> <span class="nc">ActiveRun</span><span class="p">(</span><span class="n">Run</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper around :py:class:`mlflow.entities.Run` to enable using Python ``with`` syntax.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run</span><span class="p">):</span>
        <span class="n">Run</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">RunStatus</span><span class="o">.</span><span class="n">FINISHED</span> <span class="k">if</span> <span class="n">exc_type</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">RunStatus</span><span class="o">.</span><span class="n">FAILED</span>
        <span class="n">end_run</span><span class="p">(</span><span class="n">RunStatus</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">status</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">exc_type</span> <span class="ow">is</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="start_run"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.start_run">[docs]</a><span class="k">def</span> <span class="nf">start_run</span><span class="p">(</span>
    <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">experiment_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">run_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">nested</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">parent_run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_system_metrics</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ActiveRun</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Start a new MLflow run, setting it as the active run under which metrics and parameters</span>
<span class="sd">    will be logged. The return value can be used as a context manager within a ``with`` block;</span>
<span class="sd">    otherwise, you must call ``end_run()`` to terminate the current run.</span>

<span class="sd">    If you pass a ``run_id`` or the ``MLFLOW_RUN_ID`` environment variable is set,</span>
<span class="sd">    ``start_run`` attempts to resume a run with the specified run ID and</span>
<span class="sd">    other parameters are ignored. ``run_id`` takes precedence over ``MLFLOW_RUN_ID``.</span>

<span class="sd">    If resuming an existing run, the run status is set to ``RunStatus.RUNNING``.</span>

<span class="sd">    MLflow sets a variety of default tags on the run, as defined in</span>
<span class="sd">    :ref:`MLflow system tags &lt;system_tags&gt;`.</span>

<span class="sd">    Args:</span>
<span class="sd">        run_id: If specified, get the run with the specified UUID and log parameters</span>
<span class="sd">            and metrics under that run. The run&#39;s end time is unset and its status</span>
<span class="sd">            is set to running, but the run&#39;s other attributes (``source_version``,</span>
<span class="sd">            ``source_type``, etc.) are not changed.</span>
<span class="sd">        experiment_id: ID of the experiment under which to create the current run (applicable</span>
<span class="sd">            only when ``run_id`` is not specified). If ``experiment_id`` argument</span>
<span class="sd">            is unspecified, will look for valid experiment in the following order:</span>
<span class="sd">            activated using ``set_experiment``, ``MLFLOW_EXPERIMENT_NAME``</span>
<span class="sd">            environment variable, ``MLFLOW_EXPERIMENT_ID`` environment variable,</span>
<span class="sd">            or the default experiment as defined by the tracking server.</span>
<span class="sd">        run_name: Name of new run. Used only when ``run_id`` is unspecified. If a new run is</span>
<span class="sd">            created and ``run_name`` is not specified, a random name will be generated for the run.</span>
<span class="sd">        nested: Controls whether run is nested in parent run. ``True`` creates a nested run.</span>
<span class="sd">        parent_run_id: If specified, the current run will be nested under the the run with</span>
<span class="sd">            the specified UUID. The parent run must be in the ACTIVE state.</span>
<span class="sd">        tags: An optional dictionary of string keys and values to set as tags on the run.</span>
<span class="sd">            If a run is being resumed, these tags are set on the resumed run. If a new run is</span>
<span class="sd">            being created, these tags are set on the new run.</span>
<span class="sd">        description: An optional string that populates the description box of the run.</span>
<span class="sd">            If a run is being resumed, the description is set on the resumed run.</span>
<span class="sd">            If a new run is being created, the description is set on the new run.</span>
<span class="sd">        log_system_metrics: bool, defaults to None. If True, system metrics will be logged</span>
<span class="sd">            to MLflow, e.g., cpu/gpu utilization. If None, we will check environment variable</span>
<span class="sd">            `MLFLOW_ENABLE_SYSTEM_METRICS_LOGGING` to determine whether to log system metrics.</span>
<span class="sd">            System metrics logging is an experimental feature in MLflow 2.8 and subject to change.</span>

<span class="sd">    Returns:</span>
<span class="sd">        :py:class:`mlflow.ActiveRun` object that acts as a context manager wrapping the</span>
<span class="sd">        run&#39;s state.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        # Create nested runs</span>
<span class="sd">        experiment_id = mlflow.create_experiment(&quot;experiment1&quot;)</span>
<span class="sd">        with mlflow.start_run(</span>
<span class="sd">            run_name=&quot;PARENT_RUN&quot;,</span>
<span class="sd">            experiment_id=experiment_id,</span>
<span class="sd">            tags={&quot;version&quot;: &quot;v1&quot;, &quot;priority&quot;: &quot;P1&quot;},</span>
<span class="sd">            description=&quot;parent&quot;,</span>
<span class="sd">        ) as parent_run:</span>
<span class="sd">            mlflow.log_param(&quot;parent&quot;, &quot;yes&quot;)</span>
<span class="sd">            with mlflow.start_run(</span>
<span class="sd">                run_name=&quot;CHILD_RUN&quot;,</span>
<span class="sd">                experiment_id=experiment_id,</span>
<span class="sd">                description=&quot;child&quot;,</span>
<span class="sd">                nested=True,</span>
<span class="sd">            ) as child_run:</span>
<span class="sd">                mlflow.log_param(&quot;child&quot;, &quot;yes&quot;)</span>
<span class="sd">        print(&quot;parent run:&quot;)</span>
<span class="sd">        print(f&quot;run_id: {parent_run.info.run_id}&quot;)</span>
<span class="sd">        print(&quot;description: {}&quot;.format(parent_run.data.tags.get(&quot;mlflow.note.content&quot;)))</span>
<span class="sd">        print(&quot;version tag value: {}&quot;.format(parent_run.data.tags.get(&quot;version&quot;)))</span>
<span class="sd">        print(&quot;priority tag value: {}&quot;.format(parent_run.data.tags.get(&quot;priority&quot;)))</span>
<span class="sd">        print(&quot;--&quot;)</span>

<span class="sd">        # Search all child runs with a parent id</span>
<span class="sd">        query = f&quot;tags.mlflow.parentRunId = &#39;{parent_run.info.run_id}&#39;&quot;</span>
<span class="sd">        results = mlflow.search_runs(experiment_ids=[experiment_id], filter_string=query)</span>
<span class="sd">        print(&quot;child runs:&quot;)</span>
<span class="sd">        print(results[[&quot;run_id&quot;, &quot;params.child&quot;, &quot;tags.mlflow.runName&quot;]])</span>

<span class="sd">        # Create a nested run under the existing parent run</span>
<span class="sd">        with mlflow.start_run(</span>
<span class="sd">            run_name=&quot;NEW_CHILD_RUN&quot;,</span>
<span class="sd">            experiment_id=experiment_id,</span>
<span class="sd">            description=&quot;new child&quot;,</span>
<span class="sd">            parent_run_id=parent_run.info.run_id,</span>
<span class="sd">        ) as child_run:</span>
<span class="sd">            mlflow.log_param(&quot;new-child&quot;, &quot;yes&quot;)</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">        parent run:</span>
<span class="sd">        run_id: 8979459433a24a52ab3be87a229a9cdf</span>
<span class="sd">        description: starting a parent for experiment 7</span>
<span class="sd">        version tag value: v1</span>
<span class="sd">        priority tag value: P1</span>
<span class="sd">        --</span>
<span class="sd">        child runs:</span>
<span class="sd">                                     run_id params.child tags.mlflow.runName</span>
<span class="sd">        0  7d175204675e40328e46d9a6a5a7ee6a          yes           CHILD_RUN</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_active_run_stack</span>
    <span class="n">_validate_experiment_id_type</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">)</span>
    <span class="c1"># back compat for int experiment_id</span>
    <span class="n">experiment_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">experiment_id</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_active_run_stack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">nested</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="s2">&quot;Run with UUID </span><span class="si">{}</span><span class="s2"> is already active. To start a new run, first end the &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;current run with mlflow.end_run(). To start a nested &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;run, call start_run with nested=True&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_active_run_stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">MlflowClient</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">run_id</span><span class="p">:</span>
        <span class="n">existing_run_id</span> <span class="o">=</span> <span class="n">run_id</span>
    <span class="k">elif</span> <span class="n">run_id</span> <span class="o">:=</span> <span class="n">MLFLOW_RUN_ID</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
        <span class="n">existing_run_id</span> <span class="o">=</span> <span class="n">run_id</span>
        <span class="k">del</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">MLFLOW_RUN_ID</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">existing_run_id</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">existing_run_id</span><span class="p">:</span>
        <span class="n">_validate_run_id</span><span class="p">(</span><span class="n">existing_run_id</span><span class="p">)</span>
        <span class="n">active_run_obj</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_run</span><span class="p">(</span><span class="n">existing_run_id</span><span class="p">)</span>
        <span class="c1"># Check to see if experiment_id from environment matches experiment_id from set_experiment()</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">_active_experiment_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">_active_experiment_id</span> <span class="o">!=</span> <span class="n">active_run_obj</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">experiment_id</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cannot start run with ID </span><span class="si">{</span><span class="n">existing_run_id</span><span class="si">}</span><span class="s2"> because active run ID &quot;</span>
                <span class="s2">&quot;does not match environment run ID. Make sure --experiment-name &quot;</span>
                <span class="s2">&quot;or --experiment-id matches experiment set with &quot;</span>
                <span class="s2">&quot;set_experiment(), or just use command-line arguments&quot;</span>
            <span class="p">)</span>
        <span class="c1"># Check if the current run has been deleted.</span>
        <span class="k">if</span> <span class="n">active_run_obj</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">lifecycle_stage</span> <span class="o">==</span> <span class="n">LifecycleStage</span><span class="o">.</span><span class="n">DELETED</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cannot start run with ID </span><span class="si">{</span><span class="n">existing_run_id</span><span class="si">}</span><span class="s2"> because it is in the deleted state.&quot;</span>
            <span class="p">)</span>
        <span class="c1"># Use previous `end_time` because a value is required for `update_run_info`.</span>
        <span class="n">end_time</span> <span class="o">=</span> <span class="n">active_run_obj</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">end_time</span>
        <span class="n">_get_store</span><span class="p">()</span><span class="o">.</span><span class="n">update_run_info</span><span class="p">(</span>
            <span class="n">existing_run_id</span><span class="p">,</span> <span class="n">run_status</span><span class="o">=</span><span class="n">RunStatus</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">,</span> <span class="n">end_time</span><span class="o">=</span><span class="n">end_time</span><span class="p">,</span> <span class="n">run_name</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="n">tags</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">MLFLOW_RUN_NOTE</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Description is already set via the tag </span><span class="si">{</span><span class="n">MLFLOW_RUN_NOTE</span><span class="si">}</span><span class="s2"> in tags.&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Remove the key </span><span class="si">{</span><span class="n">MLFLOW_RUN_NOTE</span><span class="si">}</span><span class="s2"> from the tags or omit the description.&quot;</span><span class="p">,</span>
                    <span class="n">error_code</span><span class="o">=</span><span class="n">INVALID_PARAMETER_VALUE</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">tags</span><span class="p">[</span><span class="n">MLFLOW_RUN_NOTE</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

        <span class="k">if</span> <span class="n">tags</span><span class="p">:</span>
            <span class="n">client</span><span class="o">.</span><span class="n">log_batch</span><span class="p">(</span>
                <span class="n">run_id</span><span class="o">=</span><span class="n">existing_run_id</span><span class="p">,</span>
                <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="n">RunTag</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">tags</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span>
            <span class="p">)</span>
        <span class="n">active_run_obj</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_run</span><span class="p">(</span><span class="n">existing_run_id</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">parent_run_id</span><span class="p">:</span>
            <span class="n">_validate_run_id</span><span class="p">(</span><span class="n">parent_run_id</span><span class="p">)</span>
            <span class="c1"># Make sure parent_run_id matches the current run id, if there is an active run</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_active_run_stack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">parent_run_id</span> <span class="o">!=</span> <span class="n">_active_run_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span><span class="p">:</span>
                <span class="n">current_run_id</span> <span class="o">=</span> <span class="n">_active_run_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
                <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Current run with UUID </span><span class="si">{</span><span class="n">current_run_id</span><span class="si">}</span><span class="s2"> does not match the specified &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;parent_run_id </span><span class="si">{</span><span class="n">parent_run_id</span><span class="si">}</span><span class="s2">. To start a new nested run under &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;the parent run with UUID </span><span class="si">{</span><span class="n">current_run_id</span><span class="si">}</span><span class="s2">, first end the current run &quot;</span>
                    <span class="s2">&quot;with mlflow.end_run().&quot;</span>
                <span class="p">)</span>
            <span class="n">parent_run_obj</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_run</span><span class="p">(</span><span class="n">parent_run_id</span><span class="p">)</span>
            <span class="c1"># Check if the specified parent_run has been deleted.</span>
            <span class="k">if</span> <span class="n">parent_run_obj</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">lifecycle_stage</span> <span class="o">==</span> <span class="n">LifecycleStage</span><span class="o">.</span><span class="n">DELETED</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Cannot start run under parent run with ID </span><span class="si">{</span><span class="n">parent_run_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;because it is in the deleted state.&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parent_run_id</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">_active_run_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_active_run_stack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">)</span>

        <span class="n">exp_id_for_run</span> <span class="o">=</span> <span class="n">experiment_id</span> <span class="k">if</span> <span class="n">experiment_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_get_experiment_id</span><span class="p">()</span>

        <span class="n">user_specified_tags</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">MLFLOW_RUN_NOTE</span> <span class="ow">in</span> <span class="n">user_specified_tags</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Description is already set via the tag </span><span class="si">{</span><span class="n">MLFLOW_RUN_NOTE</span><span class="si">}</span><span class="s2"> in tags.&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Remove the key </span><span class="si">{</span><span class="n">MLFLOW_RUN_NOTE</span><span class="si">}</span><span class="s2"> from the tags or omit the description.&quot;</span><span class="p">,</span>
                    <span class="n">error_code</span><span class="o">=</span><span class="n">INVALID_PARAMETER_VALUE</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">user_specified_tags</span><span class="p">[</span><span class="n">MLFLOW_RUN_NOTE</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
        <span class="k">if</span> <span class="n">parent_run_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">user_specified_tags</span><span class="p">[</span><span class="n">MLFLOW_PARENT_RUN_ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent_run_id</span>
        <span class="k">if</span> <span class="n">run_name</span><span class="p">:</span>
            <span class="n">user_specified_tags</span><span class="p">[</span><span class="n">MLFLOW_RUN_NAME</span><span class="p">]</span> <span class="o">=</span> <span class="n">run_name</span>

        <span class="n">resolved_tags</span> <span class="o">=</span> <span class="n">context_registry</span><span class="o">.</span><span class="n">resolve_tags</span><span class="p">(</span><span class="n">user_specified_tags</span><span class="p">)</span>

        <span class="n">active_run_obj</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_run</span><span class="p">(</span>
            <span class="n">experiment_id</span><span class="o">=</span><span class="n">exp_id_for_run</span><span class="p">,</span>
            <span class="n">tags</span><span class="o">=</span><span class="n">resolved_tags</span><span class="p">,</span>
            <span class="n">run_name</span><span class="o">=</span><span class="n">run_name</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">log_system_metrics</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If `log_system_metrics` is not specified, we will check environment variable.</span>
        <span class="n">log_system_metrics</span> <span class="o">=</span> <span class="n">MLFLOW_ENABLE_SYSTEM_METRICS_LOGGING</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">log_system_metrics</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">find_spec</span><span class="p">(</span><span class="s2">&quot;psutil&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="s2">&quot;Failed to start system metrics monitoring as package `psutil` is not installed. &quot;</span>
                <span class="s2">&quot;Please run `pip install psutil` to resolve the issue, otherwise you can disable &quot;</span>
                <span class="s2">&quot;system metrics logging by passing `log_system_metrics=False` to &quot;</span>
                <span class="s2">&quot;`mlflow.start_run()` or calling `mlflow.disable_system_metrics_logging`.&quot;</span>
            <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">mlflow.system_metrics.system_metrics_monitor</span> <span class="kn">import</span> <span class="n">SystemMetricsMonitor</span>

            <span class="n">system_monitor</span> <span class="o">=</span> <span class="n">SystemMetricsMonitor</span><span class="p">(</span>
                <span class="n">active_run_obj</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span><span class="p">,</span>
                <span class="n">resume_logging</span><span class="o">=</span><span class="n">existing_run_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">global</span> <span class="n">run_id_to_system_metrics_monitor</span>

            <span class="n">run_id_to_system_metrics_monitor</span><span class="p">[</span><span class="n">active_run_obj</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">system_monitor</span>
            <span class="n">system_monitor</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to start system metrics monitoring: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="n">_active_run_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ActiveRun</span><span class="p">(</span><span class="n">active_run_obj</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_active_run_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>


<div class="viewcode-block" id="end_run"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.end_run">[docs]</a><span class="k">def</span> <span class="nf">end_run</span><span class="p">(</span><span class="n">status</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">RunStatus</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">RunStatus</span><span class="o">.</span><span class="n">FINISHED</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    End an active MLflow run (if there is one).</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        # Start run and get status</span>
<span class="sd">        mlflow.start_run()</span>
<span class="sd">        run = mlflow.active_run()</span>
<span class="sd">        print(f&quot;run_id: {run.info.run_id}; status: {run.info.status}&quot;)</span>

<span class="sd">        # End run and get status</span>
<span class="sd">        mlflow.end_run()</span>
<span class="sd">        run = mlflow.get_run(run.info.run_id)</span>
<span class="sd">        print(f&quot;run_id: {run.info.run_id}; status: {run.info.status}&quot;)</span>
<span class="sd">        print(&quot;--&quot;)</span>

<span class="sd">        # Check for any active runs</span>
<span class="sd">        print(f&quot;Active run: {mlflow.active_run()}&quot;)</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">        run_id: b47ee4563368419880b44ad8535f6371; status: RUNNING</span>
<span class="sd">        run_id: b47ee4563368419880b44ad8535f6371; status: FINISHED</span>
<span class="sd">        --</span>
<span class="sd">        Active run: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_active_run_stack</span><span class="p">,</span> <span class="n">_last_active_run_id</span><span class="p">,</span> <span class="n">run_id_to_system_metrics_monitor</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_active_run_stack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Clear out the global existing run environment variable as well.</span>
        <span class="n">MLFLOW_RUN_ID</span><span class="o">.</span><span class="n">unset</span><span class="p">()</span>
        <span class="n">run</span> <span class="o">=</span> <span class="n">_active_run_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">_last_active_run_id</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
        <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">set_terminated</span><span class="p">(</span><span class="n">_last_active_run_id</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_last_active_run_id</span> <span class="ow">in</span> <span class="n">run_id_to_system_metrics_monitor</span><span class="p">:</span>
            <span class="n">system_metrics_monitor</span> <span class="o">=</span> <span class="n">run_id_to_system_metrics_monitor</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">_last_active_run_id</span><span class="p">)</span>
            <span class="n">system_metrics_monitor</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">_safe_end_run</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
        <span class="n">end_run</span><span class="p">()</span>


<span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">_safe_end_run</span><span class="p">)</span>


<div class="viewcode-block" id="active_run"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.active_run">[docs]</a><span class="k">def</span> <span class="nf">active_run</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ActiveRun</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the currently active ``Run``, or None if no such run exists.</span>

<span class="sd">    **Note**: You cannot access currently-active run attributes</span>
<span class="sd">    (parameters, metrics, etc.) through the run returned by ``mlflow.active_run``. In order</span>
<span class="sd">    to access such attributes, use the :py:class:`mlflow.client.MlflowClient` as follows:</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        mlflow.start_run()</span>
<span class="sd">        run = mlflow.active_run()</span>
<span class="sd">        print(f&quot;Active run_id: {run.info.run_id}&quot;)</span>
<span class="sd">        mlflow.end_run()</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">        Active run_id: 6f252757005748708cd3aad75d1ff462</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_active_run_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_active_run_stack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="last_active_run"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.last_active_run">[docs]</a><span class="k">def</span> <span class="nf">last_active_run</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Run</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the most recent active run.</span>

<span class="sd">    Examples:</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: To retrieve the most recent autologged run:</span>

<span class="sd">        import mlflow</span>

<span class="sd">        from sklearn.model_selection import train_test_split</span>
<span class="sd">        from sklearn.datasets import load_diabetes</span>
<span class="sd">        from sklearn.ensemble import RandomForestRegressor</span>

<span class="sd">        mlflow.autolog()</span>

<span class="sd">        db = load_diabetes()</span>
<span class="sd">        X_train, X_test, y_train, y_test = train_test_split(db.data, db.target)</span>

<span class="sd">        # Create and train models.</span>
<span class="sd">        rf = RandomForestRegressor(n_estimators=100, max_depth=6, max_features=3)</span>
<span class="sd">        rf.fit(X_train, y_train)</span>

<span class="sd">        # Use the model to make predictions on the test dataset.</span>
<span class="sd">        predictions = rf.predict(X_test)</span>
<span class="sd">        autolog_run = mlflow.last_active_run()</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: To get the most recently active run that ended:</span>

<span class="sd">        import mlflow</span>

<span class="sd">        mlflow.start_run()</span>
<span class="sd">        mlflow.end_run()</span>
<span class="sd">        run = mlflow.last_active_run()</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: To retrieve the currently active run:</span>

<span class="sd">        import mlflow</span>

<span class="sd">        mlflow.start_run()</span>
<span class="sd">        run = mlflow.last_active_run()</span>
<span class="sd">        mlflow.end_run()</span>

<span class="sd">    Returns:</span>
<span class="sd">        The active run (this is equivalent to ``mlflow.active_run()``) if one exists.</span>
<span class="sd">        Otherwise, the last run started from the current Python process that reached</span>
<span class="sd">        a terminal status (i.e. FINISHED, FAILED, or KILLED).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_active_run</span> <span class="o">=</span> <span class="n">active_run</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">_active_run</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_active_run</span>
    <span class="k">if</span> <span class="n">_last_active_run_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">get_run</span><span class="p">(</span><span class="n">_last_active_run_id</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_run"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.get_run">[docs]</a><span class="k">def</span> <span class="nf">get_run</span><span class="p">(</span><span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Run</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch the run from backend store. The resulting Run contains a collection of run metadata --</span>
<span class="sd">    RunInfo as well as a collection of run parameters, tags, and metrics -- RunData. It also</span>
<span class="sd">    contains a collection of run inputs (experimental), including information about datasets used by</span>
<span class="sd">    the run -- RunInputs. In the case where multiple metrics with the same key are logged for the</span>
<span class="sd">    run, the RunData contains the most recently logged value at the largest step for each metric.</span>

<span class="sd">    Args:</span>
<span class="sd">        run_id: Unique identifier for the run.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A single Run object, if the run exists. Otherwise, raises an exception.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        with mlflow.start_run() as run:</span>
<span class="sd">            mlflow.log_param(&quot;p&quot;, 0)</span>
<span class="sd">        run_id = run.info.run_id</span>
<span class="sd">        print(</span>
<span class="sd">            f&quot;run_id: {run_id}; lifecycle_stage: {mlflow.get_run(run_id).info.lifecycle_stage}&quot;</span>
<span class="sd">        )</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">        run_id: 7472befefc754e388e8e922824a0cca5; lifecycle_stage: active</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">get_run</span><span class="p">(</span><span class="n">run_id</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_parent_run"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.get_parent_run">[docs]</a><span class="k">def</span> <span class="nf">get_parent_run</span><span class="p">(</span><span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Run</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the parent run for the given run id if one exists.</span>

<span class="sd">    Args:</span>
<span class="sd">        run_id: Unique identifier for the child run.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A single :py:class:`mlflow.entities.Run` object, if the parent run exists. Otherwise,</span>
<span class="sd">        returns None.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        # Create nested runs</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            with mlflow.start_run(nested=True) as child_run:</span>
<span class="sd">                child_run_id = child_run.info.run_id</span>

<span class="sd">        parent_run = mlflow.get_parent_run(child_run_id)</span>

<span class="sd">        print(f&quot;child_run_id: {child_run_id}&quot;)</span>
<span class="sd">        print(f&quot;parent_run_id: {parent_run.info.run_id}&quot;)</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">        child_run_id: 7d175204675e40328e46d9a6a5a7ee6a</span>
<span class="sd">        parent_run_id: 8979459433a24a52ab3be87a229a9cdf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">get_parent_run</span><span class="p">(</span><span class="n">run_id</span><span class="p">)</span></div>


<div class="viewcode-block" id="log_param"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.log_param">[docs]</a><span class="k">def</span> <span class="nf">log_param</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">synchronous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Log a parameter (e.g. model hyperparameter) under the current run. If no run is active,</span>
<span class="sd">    this method will create a new active run.</span>

<span class="sd">    Args:</span>
<span class="sd">        key: Parameter name. This string may only contain alphanumerics, underscores (_), dashes</span>
<span class="sd">            (-), periods (.), spaces ( ), and slashes (/). All backend stores support keys up to</span>
<span class="sd">            length 250, but some may support larger keys.</span>
<span class="sd">        value: Parameter value, but will be string-ified if not. All built-in backend stores support</span>
<span class="sd">            values up to length 6000, but some may support larger values.</span>
<span class="sd">        synchronous: *Experimental* If True, blocks until the parameter is logged successfully. If</span>
<span class="sd">            False, logs the parameter asynchronously and returns a future representing the logging</span>
<span class="sd">            operation. If None, read from environment variable `MLFLOW_ENABLE_ASYNC_LOGGING`,</span>
<span class="sd">            which defaults to False if not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        When `synchronous=True`, returns parameter value. When `synchronous=False`, returns an</span>
<span class="sd">        :py:class:`mlflow.utils.async_logging.run_operations.RunOperations` instance that represents</span>
<span class="sd">        future for logging operation.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            value = mlflow.log_param(&quot;learning_rate&quot;, 0.01)</span>
<span class="sd">            assert value == 0.01</span>
<span class="sd">            value = mlflow.log_param(&quot;learning_rate&quot;, 0.02, synchronous=False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">synchronous</span> <span class="o">=</span> <span class="n">synchronous</span> <span class="k">if</span> <span class="n">synchronous</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="ow">not</span> <span class="n">MLFLOW_ENABLE_ASYNC_LOGGING</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">log_param</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">synchronous</span><span class="o">=</span><span class="n">synchronous</span><span class="p">)</span></div>


<div class="viewcode-block" id="flush_async_logging"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.flush_async_logging">[docs]</a><span class="k">def</span> <span class="nf">flush_async_logging</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Flush all pending async logging.&quot;&quot;&quot;</span>
    <span class="n">_get_store</span><span class="p">()</span><span class="o">.</span><span class="n">flush_async_logging</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">_shut_down_async_logging</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shutdown the async logging and flush all pending data.&quot;&quot;&quot;</span>
    <span class="n">_get_store</span><span class="p">()</span><span class="o">.</span><span class="n">shut_down_async_logging</span><span class="p">()</span>


<div class="viewcode-block" id="flush_artifact_async_logging"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.flush_artifact_async_logging">[docs]</a><span class="k">def</span> <span class="nf">flush_artifact_async_logging</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Flush all pending artifact async logging.&quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">_artifact_repo</span> <span class="o">=</span> <span class="n">_get_artifact_repo</span><span class="p">(</span><span class="n">run_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_artifact_repo</span><span class="p">:</span>
        <span class="n">_artifact_repo</span><span class="o">.</span><span class="n">flush_async_logging</span><span class="p">()</span></div>


<div class="viewcode-block" id="flush_trace_async_logging"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.flush_trace_async_logging">[docs]</a><span class="k">def</span> <span class="nf">flush_trace_async_logging</span><span class="p">(</span><span class="n">terminate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Flush all pending trace async logging.</span>

<span class="sd">    Args:</span>
<span class="sd">        terminate: If True, shut down the logging threads after flushing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">_get_trace_exporter</span><span class="p">()</span><span class="o">.</span><span class="n">_async_queue</span><span class="o">.</span><span class="n">flush</span><span class="p">(</span><span class="n">terminate</span><span class="o">=</span><span class="n">terminate</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to flush trace async logging: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="set_experiment_tag"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.set_experiment_tag">[docs]</a><span class="k">def</span> <span class="nf">set_experiment_tag</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set a tag on the current experiment. Value is converted to a string.</span>

<span class="sd">    Args:</span>
<span class="sd">        key: Tag name. This string may only contain alphanumerics, underscores (_), dashes (-),</span>
<span class="sd">            periods (.), spaces ( ), and slashes (/). All backend stores will support keys up to</span>
<span class="sd">            length 250, but some may support larger keys.</span>
<span class="sd">        value: Tag value, but will be string-ified if not. All backend stores will support values</span>
<span class="sd">            up to length 5000, but some may support larger values.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.set_experiment_tag(&quot;release.version&quot;, &quot;2.2.0&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">experiment_id</span> <span class="o">=</span> <span class="n">_get_experiment_id</span><span class="p">()</span>
    <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">set_experiment_tag</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="set_tag"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.set_tag">[docs]</a><span class="k">def</span> <span class="nf">set_tag</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">synchronous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunOperations</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set a tag under the current run. If no run is active, this method will create a new active</span>
<span class="sd">    run.</span>

<span class="sd">    Args:</span>
<span class="sd">        key: Tag name. This string may only contain alphanumerics, underscores (_), dashes (-),</span>
<span class="sd">            periods (.), spaces ( ), and slashes (/). All backend stores will support keys up to</span>
<span class="sd">            length 250, but some may support larger keys.</span>
<span class="sd">        value: Tag value, but will be string-ified if not. All backend stores will support values</span>
<span class="sd">            up to length 5000, but some may support larger values.</span>
<span class="sd">        synchronous: *Experimental* If True, blocks until the tag is logged successfully. If False,</span>
<span class="sd">            logs the tag asynchronously and returns a future representing the logging operation.</span>
<span class="sd">            If None, read from environment variable `MLFLOW_ENABLE_ASYNC_LOGGING`, which</span>
<span class="sd">            defaults to False if not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        When `synchronous=True`, returns None. When `synchronous=False`, returns an</span>
<span class="sd">        :py:class:`mlflow.utils.async_logging.run_operations.RunOperations` instance that</span>
<span class="sd">        represents future for logging operation.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        # Set a tag.</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.set_tag(&quot;release.version&quot;, &quot;2.2.0&quot;)</span>

<span class="sd">        # Set a tag in async fashion.</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.set_tag(&quot;release.version&quot;, &quot;2.2.1&quot;, synchronous=False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">synchronous</span> <span class="o">=</span> <span class="n">synchronous</span> <span class="k">if</span> <span class="n">synchronous</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="ow">not</span> <span class="n">MLFLOW_ENABLE_ASYNC_LOGGING</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">set_tag</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">synchronous</span><span class="o">=</span><span class="n">synchronous</span><span class="p">)</span></div>


<div class="viewcode-block" id="delete_tag"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.delete_tag">[docs]</a><span class="k">def</span> <span class="nf">delete_tag</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Delete a tag from a run. This is irreversible. If no run is active, this method</span>
<span class="sd">    will create a new active run.</span>

<span class="sd">    Args:</span>
<span class="sd">        key: Name of the tag</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        tags = {&quot;engineering&quot;: &quot;ML Platform&quot;, &quot;engineering_remote&quot;: &quot;ML Platform&quot;}</span>

<span class="sd">        with mlflow.start_run() as run:</span>
<span class="sd">            mlflow.set_tags(tags)</span>

<span class="sd">        with mlflow.start_run(run_id=run.info.run_id):</span>
<span class="sd">            mlflow.delete_tag(&quot;engineering_remote&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">delete_tag</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="log_metric"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.log_metric">[docs]</a><span class="k">def</span> <span class="nf">log_metric</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">step</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">synchronous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunOperations</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Log a metric under the current run. If no run is active, this method will create</span>
<span class="sd">    a new active run.</span>

<span class="sd">    Args:</span>
<span class="sd">        key: Metric name. This string may only contain alphanumerics, underscores (_),</span>
<span class="sd">            dashes (-), periods (.), spaces ( ), and slashes (/).</span>
<span class="sd">            All backend stores will support keys up to length 250, but some may</span>
<span class="sd">            support larger keys.</span>
<span class="sd">        value: Metric value. Note that some special values such as +/- Infinity may be</span>
<span class="sd">            replaced by other values depending on the store. For example, the</span>
<span class="sd">            SQLAlchemy store replaces +/- Infinity with max / min float values.</span>
<span class="sd">            All backend stores will support values up to length 5000, but some</span>
<span class="sd">            may support larger values.</span>
<span class="sd">        step: Metric step. Defaults to zero if unspecified.</span>
<span class="sd">        synchronous: *Experimental* If True, blocks until the metric is logged</span>
<span class="sd">            successfully. If False, logs the metric asynchronously and</span>
<span class="sd">            returns a future representing the logging operation. If None, read from environment</span>
<span class="sd">            variable `MLFLOW_ENABLE_ASYNC_LOGGING`, which defaults to False if not set.</span>
<span class="sd">        timestamp: Time when this metric was calculated. Defaults to the current system time.</span>
<span class="sd">        run_id: If specified, log the metric to the specified run. If not specified, log the metric</span>
<span class="sd">            to the currently active run.</span>

<span class="sd">    Returns:</span>
<span class="sd">        When `synchronous=True`, returns None.</span>
<span class="sd">        When `synchronous=False`, returns `RunOperations` that represents future for</span>
<span class="sd">        logging operation.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        # Log a metric</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_metric(&quot;mse&quot;, 2500.00)</span>

<span class="sd">        # Log a metric in async fashion.</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_metric(&quot;mse&quot;, 2500.00, synchronous=False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">run_id</span> <span class="ow">or</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">synchronous</span> <span class="o">=</span> <span class="n">synchronous</span> <span class="k">if</span> <span class="n">synchronous</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="ow">not</span> <span class="n">MLFLOW_ENABLE_ASYNC_LOGGING</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span>
        <span class="n">run_id</span><span class="p">,</span>
        <span class="n">key</span><span class="p">,</span>
        <span class="n">value</span><span class="p">,</span>
        <span class="n">timestamp</span> <span class="ow">or</span> <span class="n">get_current_time_millis</span><span class="p">(),</span>
        <span class="n">step</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">synchronous</span><span class="o">=</span><span class="n">synchronous</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="log_metrics"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.log_metrics">[docs]</a><span class="k">def</span> <span class="nf">log_metrics</span><span class="p">(</span>
    <span class="n">metrics</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">step</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">synchronous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunOperations</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Log multiple metrics for the current run. If no run is active, this method will create a new</span>
<span class="sd">    active run.</span>

<span class="sd">    Args:</span>
<span class="sd">        metrics: Dictionary of metric_name: String -&gt; value: Float. Note that some special</span>
<span class="sd">            values such as +/- Infinity may be replaced by other values depending on</span>
<span class="sd">            the store. For example, sql based store may replace +/- Infinity with</span>
<span class="sd">            max / min float values.</span>
<span class="sd">        step: A single integer step at which to log the specified</span>
<span class="sd">            Metrics. If unspecified, each metric is logged at step zero.</span>
<span class="sd">        synchronous: *Experimental* If True, blocks until the metrics are logged</span>
<span class="sd">            successfully. If False, logs the metrics asynchronously and</span>
<span class="sd">            returns a future representing the logging operation. If None, read from environment</span>
<span class="sd">            variable `MLFLOW_ENABLE_ASYNC_LOGGING`, which defaults to False if not set.</span>
<span class="sd">        run_id: Run ID. If specified, log metrics to the specified run. If not specified, log</span>
<span class="sd">            metrics to the currently active run.</span>
<span class="sd">        timestamp: Time when these metrics were calculated. Defaults to the current system time.</span>

<span class="sd">    Returns:</span>
<span class="sd">        When `synchronous=True`, returns None. When `synchronous=False`, returns an</span>
<span class="sd">        :py:class:`mlflow.utils.async_logging.run_operations.RunOperations` instance that</span>
<span class="sd">        represents future for logging operation.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        metrics = {&quot;mse&quot;: 2500.00, &quot;rmse&quot;: 50.00}</span>

<span class="sd">        # Log a batch of metrics</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_metrics(metrics)</span>

<span class="sd">        # Log a batch of metrics in async fashion.</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_metrics(metrics, synchronous=False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">run_id</span> <span class="ow">or</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">timestamp</span> <span class="ow">or</span> <span class="n">get_current_time_millis</span><span class="p">()</span>
    <span class="n">metrics_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">Metric</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">step</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="n">synchronous</span> <span class="o">=</span> <span class="n">synchronous</span> <span class="k">if</span> <span class="n">synchronous</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="ow">not</span> <span class="n">MLFLOW_ENABLE_ASYNC_LOGGING</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">log_batch</span><span class="p">(</span>
        <span class="n">run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics_arr</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">[],</span> <span class="n">tags</span><span class="o">=</span><span class="p">[],</span> <span class="n">synchronous</span><span class="o">=</span><span class="n">synchronous</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="log_params"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.log_params">[docs]</a><span class="k">def</span> <span class="nf">log_params</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">synchronous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunOperations</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Log a batch of params for the current run. If no run is active, this method will create a</span>
<span class="sd">    new active run.</span>

<span class="sd">    Args:</span>
<span class="sd">        params: Dictionary of param_name: String -&gt; value: (String, but will be string-ified if</span>
<span class="sd">            not)</span>
<span class="sd">        synchronous: *Experimental* If True, blocks until the parameters are logged</span>
<span class="sd">            successfully. If False, logs the parameters asynchronously and</span>
<span class="sd">            returns a future representing the logging operation. If None, read from environment</span>
<span class="sd">            variable `MLFLOW_ENABLE_ASYNC_LOGGING`, which defaults to False if not set.</span>
<span class="sd">        run_id: Run ID. If specified, log params to the specified run. If not specified, log</span>
<span class="sd">            params to the currently active run.</span>

<span class="sd">    Returns:</span>
<span class="sd">        When `synchronous=True`, returns None. When `synchronous=False`, returns an</span>
<span class="sd">        :py:class:`mlflow.utils.async_logging.run_operations.RunOperations` instance that</span>
<span class="sd">        represents future for logging operation.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        params = {&quot;learning_rate&quot;: 0.01, &quot;n_estimators&quot;: 10}</span>

<span class="sd">        # Log a batch of parameters</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_params(params)</span>

<span class="sd">        # Log a batch of parameters in async fashion.</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_params(params, synchronous=False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">run_id</span> <span class="ow">or</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">params_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">Param</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="n">synchronous</span> <span class="o">=</span> <span class="n">synchronous</span> <span class="k">if</span> <span class="n">synchronous</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="ow">not</span> <span class="n">MLFLOW_ENABLE_ASYNC_LOGGING</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">log_batch</span><span class="p">(</span>
        <span class="n">run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[],</span> <span class="n">params</span><span class="o">=</span><span class="n">params_arr</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="p">[],</span> <span class="n">synchronous</span><span class="o">=</span><span class="n">synchronous</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="log_input"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.log_input">[docs]</a><span class="k">def</span> <span class="nf">log_input</span><span class="p">(</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Log a dataset used in the current run.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset: :py:class:`mlflow.data.dataset.Dataset` object to be logged.</span>
<span class="sd">        context: Context in which the dataset is used. For example: &quot;training&quot;, &quot;testing&quot;.</span>
<span class="sd">            This will be set as an input tag with key `mlflow.data.context`.</span>
<span class="sd">        tags: Tags to be associated with the dataset. Dictionary of tag_key -&gt; tag_value.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import numpy as np</span>
<span class="sd">        import mlflow</span>

<span class="sd">        array = np.asarray([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<span class="sd">        dataset = mlflow.data.from_numpy(array, source=&quot;data.csv&quot;)</span>

<span class="sd">        # Log an input dataset used for training</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_input(dataset, context=&quot;training&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">tags_to_log</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">tags</span><span class="p">:</span>
        <span class="n">tags_to_log</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">InputTag</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">tags</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
    <span class="k">if</span> <span class="n">context</span><span class="p">:</span>
        <span class="n">tags_to_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InputTag</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">MLFLOW_DATASET_CONTEXT</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">context</span><span class="p">))</span>

    <span class="n">dataset_input</span> <span class="o">=</span> <span class="n">DatasetInput</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">_to_mlflow_entity</span><span class="p">(),</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags_to_log</span><span class="p">)</span>

    <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">log_inputs</span><span class="p">(</span><span class="n">run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">,</span> <span class="n">datasets</span><span class="o">=</span><span class="p">[</span><span class="n">dataset_input</span><span class="p">])</span></div>


<div class="viewcode-block" id="set_experiment_tags"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.set_experiment_tags">[docs]</a><span class="k">def</span> <span class="nf">set_experiment_tags</span><span class="p">(</span><span class="n">tags</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set tags for the current active experiment.</span>

<span class="sd">    Args:</span>
<span class="sd">        tags: Dictionary containing tag names and corresponding values.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        tags = {</span>
<span class="sd">            &quot;engineering&quot;: &quot;ML Platform&quot;,</span>
<span class="sd">            &quot;release.candidate&quot;: &quot;RC1&quot;,</span>
<span class="sd">            &quot;release.version&quot;: &quot;2.2.0&quot;,</span>
<span class="sd">        }</span>

<span class="sd">        # Set a batch of tags</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.set_experiment_tags(tags)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">tags</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">set_experiment_tag</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="set_tags"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.set_tags">[docs]</a><span class="k">def</span> <span class="nf">set_tags</span><span class="p">(</span><span class="n">tags</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">synchronous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunOperations</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Log a batch of tags for the current run. If no run is active, this method will create a</span>
<span class="sd">    new active run.</span>

<span class="sd">    Args:</span>
<span class="sd">        tags: Dictionary of tag_name: String -&gt; value: (String, but will be string-ified if</span>
<span class="sd">            not)</span>
<span class="sd">        synchronous: *Experimental* If True, blocks until tags are logged successfully. If False,</span>
<span class="sd">            logs tags asynchronously and returns a future representing the logging operation.</span>
<span class="sd">            If None, read from environment variable `MLFLOW_ENABLE_ASYNC_LOGGING`, which</span>
<span class="sd">            defaults to False if not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        When `synchronous=True`, returns None. When `synchronous=False`, returns an</span>
<span class="sd">        :py:class:`mlflow.utils.async_logging.run_operations.RunOperations` instance that</span>
<span class="sd">        represents future for logging operation.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        tags = {</span>
<span class="sd">            &quot;engineering&quot;: &quot;ML Platform&quot;,</span>
<span class="sd">            &quot;release.candidate&quot;: &quot;RC1&quot;,</span>
<span class="sd">            &quot;release.version&quot;: &quot;2.2.0&quot;,</span>
<span class="sd">        }</span>

<span class="sd">        # Set a batch of tags</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.set_tags(tags)</span>

<span class="sd">        # Set a batch of tags in async fashion.</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.set_tags(tags, synchronous=False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">tags_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">RunTag</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">tags</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="n">synchronous</span> <span class="o">=</span> <span class="n">synchronous</span> <span class="k">if</span> <span class="n">synchronous</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="ow">not</span> <span class="n">MLFLOW_ENABLE_ASYNC_LOGGING</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">log_batch</span><span class="p">(</span>
        <span class="n">run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[],</span> <span class="n">params</span><span class="o">=</span><span class="p">[],</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags_arr</span><span class="p">,</span> <span class="n">synchronous</span><span class="o">=</span><span class="n">synchronous</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="log_artifact"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.log_artifact">[docs]</a><span class="k">def</span> <span class="nf">log_artifact</span><span class="p">(</span>
    <span class="n">local_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">artifact_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Log a local file or directory as an artifact of the currently active run. If no run is</span>
<span class="sd">    active, this method will create a new active run.</span>

<span class="sd">    Args:</span>
<span class="sd">        local_path: Path to the file to write.</span>
<span class="sd">        artifact_path: If provided, the directory in ``artifact_uri`` to write to.</span>
<span class="sd">        run_id: If specified, log the artifact to the specified run. If not specified, log the</span>
<span class="sd">            artifact to the currently active run.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import tempfile</span>
<span class="sd">        from pathlib import Path</span>

<span class="sd">        import mlflow</span>

<span class="sd">        # Create a features.txt artifact file</span>
<span class="sd">        features = &quot;rooms, zipcode, median_price, school_rating, transport&quot;</span>
<span class="sd">        with tempfile.TemporaryDirectory() as tmp_dir:</span>
<span class="sd">            path = Path(tmp_dir, &quot;features.txt&quot;)</span>
<span class="sd">            path.write_text(features)</span>
<span class="sd">            # With artifact_path=None write features.txt under</span>
<span class="sd">            # root artifact_uri/artifacts directory</span>
<span class="sd">            with mlflow.start_run():</span>
<span class="sd">                mlflow.log_artifact(path)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">run_id</span> <span class="ow">or</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">log_artifact</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">artifact_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="log_artifacts"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.log_artifacts">[docs]</a><span class="k">def</span> <span class="nf">log_artifacts</span><span class="p">(</span>
    <span class="n">local_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">artifact_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Log all the contents of a local directory as artifacts of the run. If no run is active,</span>
<span class="sd">    this method will create a new active run.</span>

<span class="sd">    Args:</span>
<span class="sd">        local_dir: Path to the directory of files to write.</span>
<span class="sd">        artifact_path: If provided, the directory in ``artifact_uri`` to write to.</span>
<span class="sd">        run_id: If specified, log the artifacts to the specified run. If not specified, log the</span>
<span class="sd">            artifacts to the currently active run.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import json</span>
<span class="sd">        import tempfile</span>
<span class="sd">        from pathlib import Path</span>

<span class="sd">        import mlflow</span>

<span class="sd">        # Create some files to preserve as artifacts</span>
<span class="sd">        features = &quot;rooms, zipcode, median_price, school_rating, transport&quot;</span>
<span class="sd">        data = {&quot;state&quot;: &quot;TX&quot;, &quot;Available&quot;: 25, &quot;Type&quot;: &quot;Detached&quot;}</span>
<span class="sd">        with tempfile.TemporaryDirectory() as tmp_dir:</span>
<span class="sd">            tmp_dir = Path(tmp_dir)</span>
<span class="sd">            with (tmp_dir / &quot;data.json&quot;).open(&quot;w&quot;) as f:</span>
<span class="sd">                json.dump(data, f, indent=2)</span>
<span class="sd">            with (tmp_dir / &quot;features.json&quot;).open(&quot;w&quot;) as f:</span>
<span class="sd">                f.write(features)</span>
<span class="sd">            # Write all files in `tmp_dir` to root artifact_uri/states</span>
<span class="sd">            with mlflow.start_run():</span>
<span class="sd">                mlflow.log_artifacts(tmp_dir, artifact_path=&quot;states&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">run_id</span> <span class="ow">or</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">log_artifacts</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">local_dir</span><span class="p">,</span> <span class="n">artifact_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="log_text"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.log_text">[docs]</a><span class="k">def</span> <span class="nf">log_text</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Log text as an artifact.</span>

<span class="sd">    Args:</span>
<span class="sd">        text: String containing text to log.</span>
<span class="sd">        artifact_file: The run-relative artifact file path in posixpath format to which</span>
<span class="sd">            the text is saved (e.g. &quot;dir/file.txt&quot;).</span>
<span class="sd">        run_id: If specified, log the artifact to the specified run. If not specified, log the</span>
<span class="sd">            artifact to the currently active run.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            # Log text to a file under the run&#39;s root artifact directory</span>
<span class="sd">            mlflow.log_text(&quot;text1&quot;, &quot;file1.txt&quot;)</span>

<span class="sd">            # Log text in a subdirectory of the run&#39;s root artifact directory</span>
<span class="sd">            mlflow.log_text(&quot;text2&quot;, &quot;dir/file2.txt&quot;)</span>

<span class="sd">            # Log HTML text</span>
<span class="sd">            mlflow.log_text(&quot;&lt;h1&gt;header&lt;/h1&gt;&quot;, &quot;index.html&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">run_id</span> <span class="ow">or</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">log_text</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">)</span></div>


<div class="viewcode-block" id="log_dict"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.log_dict">[docs]</a><span class="k">def</span> <span class="nf">log_dict</span><span class="p">(</span><span class="n">dictionary</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">artifact_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Log a JSON/YAML-serializable object (e.g. `dict`) as an artifact. The serialization</span>
<span class="sd">    format (JSON or YAML) is automatically inferred from the extension of `artifact_file`.</span>
<span class="sd">    If the file extension doesn&#39;t exist or match any of [&quot;.json&quot;, &quot;.yml&quot;, &quot;.yaml&quot;],</span>
<span class="sd">    JSON format is used.</span>

<span class="sd">    Args:</span>
<span class="sd">        dictionary: Dictionary to log.</span>
<span class="sd">        artifact_file: The run-relative artifact file path in posixpath format to which</span>
<span class="sd">            the dictionary is saved (e.g. &quot;dir/data.json&quot;).</span>
<span class="sd">        run_id: If specified, log the dictionary to the specified run. If not specified, log the</span>
<span class="sd">            dictionary to the currently active run.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        dictionary = {&quot;k&quot;: &quot;v&quot;}</span>

<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            # Log a dictionary as a JSON file under the run&#39;s root artifact directory</span>
<span class="sd">            mlflow.log_dict(dictionary, &quot;data.json&quot;)</span>

<span class="sd">            # Log a dictionary as a YAML file in a subdirectory of the run&#39;s root artifact directory</span>
<span class="sd">            mlflow.log_dict(dictionary, &quot;dir/data.yml&quot;)</span>

<span class="sd">            # If the file extension doesn&#39;t exist or match any of [&quot;.json&quot;, &quot;.yaml&quot;, &quot;.yml&quot;],</span>
<span class="sd">            # JSON format is used.</span>
<span class="sd">            mlflow.log_dict(dictionary, &quot;data&quot;)</span>
<span class="sd">            mlflow.log_dict(dictionary, &quot;data.txt&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">run_id</span> <span class="ow">or</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">log_dict</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">)</span></div>


<div class="viewcode-block" id="log_figure"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.log_figure">[docs]</a><span class="k">def</span> <span class="nf">log_figure</span><span class="p">(</span>
    <span class="n">figure</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;matplotlib.figure.Figure&quot;</span><span class="p">,</span> <span class="s2">&quot;plotly.graph_objects.Figure&quot;</span><span class="p">],</span>
    <span class="n">artifact_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">save_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Log a figure as an artifact. The following figure objects are supported:</span>

<span class="sd">    - `matplotlib.figure.Figure`_</span>
<span class="sd">    - `plotly.graph_objects.Figure`_</span>

<span class="sd">    .. _matplotlib.figure.Figure:</span>
<span class="sd">        https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html</span>

<span class="sd">    .. _plotly.graph_objects.Figure:</span>
<span class="sd">        https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html</span>

<span class="sd">    Args:</span>
<span class="sd">        figure: Figure to log.</span>
<span class="sd">        artifact_file: The run-relative artifact file path in posixpath format to which</span>
<span class="sd">            the figure is saved (e.g. &quot;dir/file.png&quot;).</span>
<span class="sd">        save_kwargs: Additional keyword arguments passed to the method that saves the figure.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Matplotlib Example</span>

<span class="sd">        import mlflow</span>
<span class="sd">        import matplotlib.pyplot as plt</span>

<span class="sd">        fig, ax = plt.subplots()</span>
<span class="sd">        ax.plot([0, 1], [2, 3])</span>

<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_figure(fig, &quot;figure.png&quot;)</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Plotly Example</span>

<span class="sd">        import mlflow</span>
<span class="sd">        from plotly import graph_objects as go</span>

<span class="sd">        fig = go.Figure(go.Scatter(x=[0, 1], y=[2, 3]))</span>

<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_figure(fig, &quot;figure.html&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">log_figure</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">figure</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">,</span> <span class="n">save_kwargs</span><span class="o">=</span><span class="n">save_kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="log_image"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.log_image">[docs]</a><span class="k">def</span> <span class="nf">log_image</span><span class="p">(</span>
    <span class="n">image</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;numpy.ndarray&quot;</span><span class="p">,</span> <span class="s2">&quot;PIL.Image.Image&quot;</span><span class="p">,</span> <span class="s2">&quot;mlflow.Image&quot;</span><span class="p">],</span>
    <span class="n">artifact_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">step</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">synchronous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Logs an image in MLflow, supporting two use cases:</span>

<span class="sd">    1. Time-stepped image logging:</span>
<span class="sd">        Ideal for tracking changes or progressions through iterative processes (e.g.,</span>
<span class="sd">        during model training phases).</span>

<span class="sd">        - Usage: :code:`log_image(image, key=key, step=step, timestamp=timestamp)`</span>

<span class="sd">    2. Artifact file image logging:</span>
<span class="sd">        Best suited for static image logging where the image is saved directly as a file</span>
<span class="sd">        artifact.</span>

<span class="sd">        - Usage: :code:`log_image(image, artifact_file)`</span>

<span class="sd">    The following image formats are supported:</span>
<span class="sd">        - `numpy.ndarray`_</span>
<span class="sd">        - `PIL.Image.Image`_</span>

<span class="sd">        .. _numpy.ndarray:</span>
<span class="sd">            https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html</span>

<span class="sd">        .. _PIL.Image.Image:</span>
<span class="sd">            https://pillow.readthedocs.io/en/stable/reference/Image.html#PIL.Image.Image</span>

<span class="sd">        - :class:`mlflow.Image`: An MLflow wrapper around PIL image for convenient image logging.</span>

<span class="sd">    Numpy array support</span>
<span class="sd">        - data types:</span>

<span class="sd">            - bool (useful for logging image masks)</span>
<span class="sd">            - integer [0, 255]</span>
<span class="sd">            - unsigned integer [0, 255]</span>
<span class="sd">            - float [0.0, 1.0]</span>

<span class="sd">            .. warning::</span>

<span class="sd">                - Out-of-range integer values will raise ValueError.</span>
<span class="sd">                - Out-of-range float values will auto-scale with min/max and warn.</span>

<span class="sd">        - shape (H: height, W: width):</span>

<span class="sd">            - H x W (Grayscale)</span>
<span class="sd">            - H x W x 1 (Grayscale)</span>
<span class="sd">            - H x W x 3 (an RGB channel order is assumed)</span>
<span class="sd">            - H x W x 4 (an RGBA channel order is assumed)</span>

<span class="sd">    Args:</span>
<span class="sd">        image: The image object to be logged.</span>
<span class="sd">        artifact_file: Specifies the path, in POSIX format, where the image</span>
<span class="sd">            will be stored as an artifact relative to the run&#39;s root directory (for</span>
<span class="sd">            example, &quot;dir/image.png&quot;). This parameter is kept for backward compatibility</span>
<span class="sd">            and should not be used together with `key`, `step`, or `timestamp`.</span>
<span class="sd">        key: Image name for time-stepped image logging. This string may only contain</span>
<span class="sd">            alphanumerics, underscores (_), dashes (-), periods (.), spaces ( ), and</span>
<span class="sd">            slashes (/).</span>
<span class="sd">        step: Integer training step (iteration) at which the image was saved.</span>
<span class="sd">            Defaults to 0.</span>
<span class="sd">        timestamp: Time when this image was saved. Defaults to the current system time.</span>
<span class="sd">        synchronous: *Experimental* If True, blocks until the image is logged successfully.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :caption: Time-stepped image logging numpy example</span>

<span class="sd">        import mlflow</span>
<span class="sd">        import numpy as np</span>

<span class="sd">        image = np.random.randint(0, 256, size=(100, 100, 3), dtype=np.uint8)</span>

<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_image(image, key=&quot;dogs&quot;, step=3)</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :caption: Time-stepped image logging pillow example</span>

<span class="sd">        import mlflow</span>
<span class="sd">        from PIL import Image</span>

<span class="sd">        image = Image.new(&quot;RGB&quot;, (100, 100))</span>

<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_image(image, key=&quot;dogs&quot;, step=3)</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :caption: Time-stepped image logging with mlflow.Image example</span>

<span class="sd">        import mlflow</span>
<span class="sd">        from PIL import Image</span>

<span class="sd">        # If you have a preexisting saved image</span>
<span class="sd">        Image.new(&quot;RGB&quot;, (100, 100)).save(&quot;image.png&quot;)</span>

<span class="sd">        image = mlflow.Image(&quot;image.png&quot;)</span>
<span class="sd">        with mlflow.start_run() as run:</span>
<span class="sd">            mlflow.log_image(run.info.run_id, image, key=&quot;dogs&quot;, step=3)</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :caption: Legacy artifact file image logging numpy example</span>

<span class="sd">        import mlflow</span>
<span class="sd">        import numpy as np</span>

<span class="sd">        image = np.random.randint(0, 256, size=(100, 100, 3), dtype=np.uint8)</span>

<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_image(image, &quot;image.png&quot;)</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :caption: Legacy artifact file image logging pillow example</span>

<span class="sd">        import mlflow</span>
<span class="sd">        from PIL import Image</span>

<span class="sd">        image = Image.new(&quot;RGB&quot;, (100, 100))</span>

<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_image(image, &quot;image.png&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">log_image</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">synchronous</span><span class="p">)</span></div>


<div class="viewcode-block" id="log_table"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.log_table">[docs]</a><span class="nd">@experimental</span>
<span class="k">def</span> <span class="nf">log_table</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">],</span>
    <span class="n">artifact_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Log a table to MLflow Tracking as a JSON artifact. If the artifact_file already exists</span>
<span class="sd">    in the run, the data would be appended to the existing artifact_file.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Dictionary or pandas.DataFrame to log.</span>
<span class="sd">        artifact_file: The run-relative artifact file path in posixpath format to which</span>
<span class="sd">            the table is saved (e.g. &quot;dir/file.json&quot;).</span>
<span class="sd">        run_id: If specified, log the table to the specified run. If not specified, log the</span>
<span class="sd">            table to the currently active run.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Dictionary Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        table_dict = {</span>
<span class="sd">            &quot;inputs&quot;: [&quot;What is MLflow?&quot;, &quot;What is Databricks?&quot;],</span>
<span class="sd">            &quot;outputs&quot;: [&quot;MLflow is ...&quot;, &quot;Databricks is ...&quot;],</span>
<span class="sd">            &quot;toxicity&quot;: [0.0, 0.0],</span>
<span class="sd">        }</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            # Log the dictionary as a table</span>
<span class="sd">            mlflow.log_table(data=table_dict, artifact_file=&quot;qabot_eval_results.json&quot;)</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Pandas DF Example</span>

<span class="sd">        import mlflow</span>
<span class="sd">        import pandas as pd</span>

<span class="sd">        table_dict = {</span>
<span class="sd">            &quot;inputs&quot;: [&quot;What is MLflow?&quot;, &quot;What is Databricks?&quot;],</span>
<span class="sd">            &quot;outputs&quot;: [&quot;MLflow is ...&quot;, &quot;Databricks is ...&quot;],</span>
<span class="sd">            &quot;toxicity&quot;: [0.0, 0.0],</span>
<span class="sd">        }</span>
<span class="sd">        df = pd.DataFrame.from_dict(table_dict)</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            # Log the df as a table</span>
<span class="sd">            mlflow.log_table(data=df, artifact_file=&quot;qabot_eval_results.json&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">run_id</span> <span class="ow">or</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">log_table</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">)</span></div>


<div class="viewcode-block" id="load_table"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.load_table">[docs]</a><span class="nd">@experimental</span>
<span class="k">def</span> <span class="nf">load_table</span><span class="p">(</span>
    <span class="n">artifact_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">run_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">extra_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load a table from MLflow Tracking as a pandas.DataFrame. The table is loaded from the</span>
<span class="sd">    specified artifact_file in the specified run_ids. The extra_columns are columns that</span>
<span class="sd">    are not in the table but are augmented with run information and added to the DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        artifact_file: The run-relative artifact file path in posixpath format to which</span>
<span class="sd">            table to load (e.g. &quot;dir/file.json&quot;).</span>
<span class="sd">        run_ids: Optional list of run_ids to load the table from. If no run_ids are specified,</span>
<span class="sd">            the table is loaded from all runs in the current experiment.</span>
<span class="sd">        extra_columns: Optional list of extra columns to add to the returned DataFrame</span>
<span class="sd">            For example, if extra_columns=[&quot;run_id&quot;], then the returned DataFrame</span>
<span class="sd">            will have a column named run_id.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame containing the loaded table if the artifact exists</span>
<span class="sd">        or else throw a MlflowException.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example with passing run_ids</span>

<span class="sd">        import mlflow</span>

<span class="sd">        table_dict = {</span>
<span class="sd">            &quot;inputs&quot;: [&quot;What is MLflow?&quot;, &quot;What is Databricks?&quot;],</span>
<span class="sd">            &quot;outputs&quot;: [&quot;MLflow is ...&quot;, &quot;Databricks is ...&quot;],</span>
<span class="sd">            &quot;toxicity&quot;: [0.0, 0.0],</span>
<span class="sd">        }</span>

<span class="sd">        with mlflow.start_run() as run:</span>
<span class="sd">            # Log the dictionary as a table</span>
<span class="sd">            mlflow.log_table(data=table_dict, artifact_file=&quot;qabot_eval_results.json&quot;)</span>
<span class="sd">            run_id = run.info.run_id</span>

<span class="sd">        loaded_table = mlflow.load_table(</span>
<span class="sd">            artifact_file=&quot;qabot_eval_results.json&quot;,</span>
<span class="sd">            run_ids=[run_id],</span>
<span class="sd">            # Append a column containing the associated run ID for each row</span>
<span class="sd">            extra_columns=[&quot;run_id&quot;],</span>
<span class="sd">        )</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example with passing no run_ids</span>

<span class="sd">        # Loads the table with the specified name for all runs in the given</span>
<span class="sd">        # experiment and joins them together</span>
<span class="sd">        import mlflow</span>

<span class="sd">        table_dict = {</span>
<span class="sd">            &quot;inputs&quot;: [&quot;What is MLflow?&quot;, &quot;What is Databricks?&quot;],</span>
<span class="sd">            &quot;outputs&quot;: [&quot;MLflow is ...&quot;, &quot;Databricks is ...&quot;],</span>
<span class="sd">            &quot;toxicity&quot;: [0.0, 0.0],</span>
<span class="sd">        }</span>

<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            # Log the dictionary as a table</span>
<span class="sd">            mlflow.log_table(data=table_dict, artifact_file=&quot;qabot_eval_results.json&quot;)</span>

<span class="sd">        loaded_table = mlflow.load_table(</span>
<span class="sd">            &quot;qabot_eval_results.json&quot;,</span>
<span class="sd">            # Append the run ID and the parent run ID to the table</span>
<span class="sd">            extra_columns=[&quot;run_id&quot;],</span>
<span class="sd">        )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">experiment_id</span> <span class="o">=</span> <span class="n">_get_experiment_id</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">load_table</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">,</span> <span class="n">artifact_file</span><span class="p">,</span> <span class="n">run_ids</span><span class="p">,</span> <span class="n">extra_columns</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_record_logged_model</span><span class="p">(</span><span class="n">mlflow_model</span><span class="p">,</span> <span class="n">run_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">run_id</span> <span class="o">=</span> <span class="n">run_id</span> <span class="ow">or</span> <span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span>
    <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">_record_logged_model</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="n">mlflow_model</span><span class="p">)</span>


<div class="viewcode-block" id="get_experiment"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.get_experiment">[docs]</a><span class="k">def</span> <span class="nf">get_experiment</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Experiment</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve an experiment by experiment_id from the backend store</span>

<span class="sd">    Args:</span>
<span class="sd">        experiment_id: The string-ified experiment ID returned from ``create_experiment``.</span>

<span class="sd">    Returns:</span>
<span class="sd">        :py:class:`mlflow.entities.Experiment`</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        experiment = mlflow.get_experiment(&quot;0&quot;)</span>
<span class="sd">        print(f&quot;Name: {experiment.name}&quot;)</span>
<span class="sd">        print(f&quot;Artifact Location: {experiment.artifact_location}&quot;)</span>
<span class="sd">        print(f&quot;Tags: {experiment.tags}&quot;)</span>
<span class="sd">        print(f&quot;Lifecycle_stage: {experiment.lifecycle_stage}&quot;)</span>
<span class="sd">        print(f&quot;Creation timestamp: {experiment.creation_time}&quot;)</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">        Name: Default</span>
<span class="sd">        Artifact Location: file:///.../mlruns/0</span>
<span class="sd">        Tags: {}</span>
<span class="sd">        Lifecycle_stage: active</span>
<span class="sd">        Creation timestamp: 1662004217511</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_experiment_by_name"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.get_experiment_by_name">[docs]</a><span class="k">def</span> <span class="nf">get_experiment_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Experiment</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve an experiment by experiment name from the backend store</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The case sensitive experiment name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An instance of :py:class:`mlflow.entities.Experiment`</span>
<span class="sd">        if an experiment with the specified name exists, otherwise None.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        # Case sensitive name</span>
<span class="sd">        experiment = mlflow.get_experiment_by_name(&quot;Default&quot;)</span>
<span class="sd">        print(f&quot;Experiment_id: {experiment.experiment_id}&quot;)</span>
<span class="sd">        print(f&quot;Artifact Location: {experiment.artifact_location}&quot;)</span>
<span class="sd">        print(f&quot;Tags: {experiment.tags}&quot;)</span>
<span class="sd">        print(f&quot;Lifecycle_stage: {experiment.lifecycle_stage}&quot;)</span>
<span class="sd">        print(f&quot;Creation timestamp: {experiment.creation_time}&quot;)</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">        Experiment_id: 0</span>
<span class="sd">        Artifact Location: file:///.../mlruns/0</span>
<span class="sd">        Tags: {}</span>
<span class="sd">        Lifecycle_stage: active</span>
<span class="sd">        Creation timestamp: 1662004217511</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">get_experiment_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="search_experiments"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.search_experiments">[docs]</a><span class="k">def</span> <span class="nf">search_experiments</span><span class="p">(</span>
    <span class="n">view_type</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">ViewType</span><span class="o">.</span><span class="n">ACTIVE_ONLY</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filter_string</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">order_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Experiment</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Search for experiments that match the specified search query.</span>

<span class="sd">    Args:</span>
<span class="sd">        view_type: One of enum values ``ACTIVE_ONLY``, ``DELETED_ONLY``, or ``ALL``</span>
<span class="sd">            defined in :py:class:`mlflow.entities.ViewType`.</span>
<span class="sd">        max_results: If passed, specifies the maximum number of experiments desired. If not</span>
<span class="sd">            passed, all experiments will be returned.</span>
<span class="sd">        filter_string: Filter query string (e.g., ``&quot;name = &#39;my_experiment&#39;&quot;``), defaults to</span>
<span class="sd">            searching for all experiments. The following identifiers, comparators, and logical</span>
<span class="sd">            operators are supported.</span>

<span class="sd">            Identifiers</span>
<span class="sd">              - ``name``: Experiment name</span>
<span class="sd">              - ``creation_time``: Experiment creation time</span>
<span class="sd">              - ``last_update_time``: Experiment last update time</span>
<span class="sd">              - ``tags.&lt;tag_key&gt;``: Experiment tag. If ``tag_key`` contains</span>
<span class="sd">                spaces, it must be wrapped with backticks (e.g., ``&quot;tags.`extra key`&quot;``).</span>

<span class="sd">            Comparators for string attributes and tags</span>
<span class="sd">                - ``=``: Equal to</span>
<span class="sd">                - ``!=``: Not equal to</span>
<span class="sd">                - ``LIKE``: Case-sensitive pattern match</span>
<span class="sd">                - ``ILIKE``: Case-insensitive pattern match</span>

<span class="sd">            Comparators for numeric attributes</span>
<span class="sd">                - ``=``: Equal to</span>
<span class="sd">                - ``!=``: Not equal to</span>
<span class="sd">                - ``&lt;``: Less than</span>
<span class="sd">                - ``&lt;=``: Less than or equal to</span>
<span class="sd">                - ``&gt;``: Greater than</span>
<span class="sd">                - ``&gt;=``: Greater than or equal to</span>

<span class="sd">            Logical operators</span>
<span class="sd">              - ``AND``: Combines two sub-queries and returns True if both of them are True.</span>

<span class="sd">        order_by: List of columns to order by. The ``order_by`` column can contain an optional</span>
<span class="sd">            ``DESC`` or ``ASC`` value (e.g., ``&quot;name DESC&quot;``). The default ordering is ``ASC``,</span>
<span class="sd">            so ``&quot;name&quot;`` is equivalent to ``&quot;name ASC&quot;``. If unspecified, defaults to</span>
<span class="sd">            ``[&quot;last_update_time DESC&quot;]``, which lists experiments updated most recently first.</span>
<span class="sd">            The following fields are supported:</span>

<span class="sd">                - ``experiment_id``: Experiment ID</span>
<span class="sd">                - ``name``: Experiment name</span>
<span class="sd">                - ``creation_time``: Experiment creation time</span>
<span class="sd">                - ``last_update_time``: Experiment last update time</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of :py:class:`Experiment &lt;mlflow.entities.Experiment&gt;` objects.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>


<span class="sd">        def assert_experiment_names_equal(experiments, expected_names):</span>
<span class="sd">            actual_names = [e.name for e in experiments if e.name != &quot;Default&quot;]</span>
<span class="sd">            assert actual_names == expected_names, (actual_names, expected_names)</span>


<span class="sd">        mlflow.set_tracking_uri(&quot;sqlite:///:memory:&quot;)</span>
<span class="sd">        # Create experiments</span>
<span class="sd">        for name, tags in [</span>
<span class="sd">            (&quot;a&quot;, None),</span>
<span class="sd">            (&quot;b&quot;, None),</span>
<span class="sd">            (&quot;ab&quot;, {&quot;k&quot;: &quot;v&quot;}),</span>
<span class="sd">            (&quot;bb&quot;, {&quot;k&quot;: &quot;V&quot;}),</span>
<span class="sd">        ]:</span>
<span class="sd">            mlflow.create_experiment(name, tags=tags)</span>

<span class="sd">        # Search for experiments with name &quot;a&quot;</span>
<span class="sd">        experiments = mlflow.search_experiments(filter_string=&quot;name = &#39;a&#39;&quot;)</span>
<span class="sd">        assert_experiment_names_equal(experiments, [&quot;a&quot;])</span>
<span class="sd">        # Search for experiments with name starting with &quot;a&quot;</span>
<span class="sd">        experiments = mlflow.search_experiments(filter_string=&quot;name LIKE &#39;a%&#39;&quot;)</span>
<span class="sd">        assert_experiment_names_equal(experiments, [&quot;ab&quot;, &quot;a&quot;])</span>
<span class="sd">        # Search for experiments with tag key &quot;k&quot; and value ending with &quot;v&quot; or &quot;V&quot;</span>
<span class="sd">        experiments = mlflow.search_experiments(filter_string=&quot;tags.k ILIKE &#39;%v&#39;&quot;)</span>
<span class="sd">        assert_experiment_names_equal(experiments, [&quot;bb&quot;, &quot;ab&quot;])</span>
<span class="sd">        # Search for experiments with name ending with &quot;b&quot; and tag {&quot;k&quot;: &quot;v&quot;}</span>
<span class="sd">        experiments = mlflow.search_experiments(filter_string=&quot;name LIKE &#39;%b&#39; AND tags.k = &#39;v&#39;&quot;)</span>
<span class="sd">        assert_experiment_names_equal(experiments, [&quot;ab&quot;])</span>
<span class="sd">        # Sort experiments by name in ascending order</span>
<span class="sd">        experiments = mlflow.search_experiments(order_by=[&quot;name&quot;])</span>
<span class="sd">        assert_experiment_names_equal(experiments, [&quot;a&quot;, &quot;ab&quot;, &quot;b&quot;, &quot;bb&quot;])</span>
<span class="sd">        # Sort experiments by ID in descending order</span>
<span class="sd">        experiments = mlflow.search_experiments(order_by=[&quot;experiment_id DESC&quot;])</span>
<span class="sd">        assert_experiment_names_equal(experiments, [&quot;bb&quot;, &quot;ab&quot;, &quot;b&quot;, &quot;a&quot;])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">pagination_wrapper_func</span><span class="p">(</span><span class="n">number_to_get</span><span class="p">,</span> <span class="n">next_page_token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">search_experiments</span><span class="p">(</span>
            <span class="n">view_type</span><span class="o">=</span><span class="n">view_type</span><span class="p">,</span>
            <span class="n">max_results</span><span class="o">=</span><span class="n">number_to_get</span><span class="p">,</span>
            <span class="n">filter_string</span><span class="o">=</span><span class="n">filter_string</span><span class="p">,</span>
            <span class="n">order_by</span><span class="o">=</span><span class="n">order_by</span><span class="p">,</span>
            <span class="n">page_token</span><span class="o">=</span><span class="n">next_page_token</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">get_results_from_paginated_fn</span><span class="p">(</span>
        <span class="n">pagination_wrapper_func</span><span class="p">,</span>
        <span class="n">SEARCH_MAX_RESULTS_DEFAULT</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="create_experiment"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.create_experiment">[docs]</a><span class="k">def</span> <span class="nf">create_experiment</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">artifact_location</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an experiment.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The experiment name, which must be a unique string.</span>
<span class="sd">        artifact_location: The location to store run artifacts. If not provided, the server picks</span>
<span class="sd">            an appropriate default.</span>
<span class="sd">        tags: An optional dictionary of string keys and values to set as tags on the experiment.</span>

<span class="sd">    Returns:</span>
<span class="sd">        String ID of the created experiment.</span>

<span class="sd">     .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>
<span class="sd">        from pathlib import Path</span>

<span class="sd">        # Create an experiment name, which must be unique and case sensitive</span>
<span class="sd">        experiment_id = mlflow.create_experiment(</span>
<span class="sd">            &quot;Social NLP Experiments&quot;,</span>
<span class="sd">            artifact_location=Path.cwd().joinpath(&quot;mlruns&quot;).as_uri(),</span>
<span class="sd">            tags={&quot;version&quot;: &quot;v1&quot;, &quot;priority&quot;: &quot;P1&quot;},</span>
<span class="sd">        )</span>
<span class="sd">        experiment = mlflow.get_experiment(experiment_id)</span>
<span class="sd">        print(f&quot;Name: {experiment.name}&quot;)</span>
<span class="sd">        print(f&quot;Experiment_id: {experiment.experiment_id}&quot;)</span>
<span class="sd">        print(f&quot;Artifact Location: {experiment.artifact_location}&quot;)</span>
<span class="sd">        print(f&quot;Tags: {experiment.tags}&quot;)</span>
<span class="sd">        print(f&quot;Lifecycle_stage: {experiment.lifecycle_stage}&quot;)</span>
<span class="sd">        print(f&quot;Creation timestamp: {experiment.creation_time}&quot;)</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">        Name: Social NLP Experiments</span>
<span class="sd">        Experiment_id: 1</span>
<span class="sd">        Artifact Location: file:///.../mlruns</span>
<span class="sd">        Tags: {&#39;version&#39;: &#39;v1&#39;, &#39;priority&#39;: &#39;P1&#39;}</span>
<span class="sd">        Lifecycle_stage: active</span>
<span class="sd">        Creation timestamp: 1662004217511</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">create_experiment</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">artifact_location</span><span class="p">,</span> <span class="n">tags</span><span class="p">)</span></div>


<div class="viewcode-block" id="delete_experiment"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.delete_experiment">[docs]</a><span class="k">def</span> <span class="nf">delete_experiment</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Delete an experiment from the backend store.</span>

<span class="sd">    Args:</span>
<span class="sd">        experiment_id: The string-ified experiment ID returned from ``create_experiment``.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        experiment_id = mlflow.create_experiment(&quot;New Experiment&quot;)</span>
<span class="sd">        mlflow.delete_experiment(experiment_id)</span>

<span class="sd">        # Examine the deleted experiment details.</span>
<span class="sd">        experiment = mlflow.get_experiment(experiment_id)</span>
<span class="sd">        print(f&quot;Name: {experiment.name}&quot;)</span>
<span class="sd">        print(f&quot;Artifact Location: {experiment.artifact_location}&quot;)</span>
<span class="sd">        print(f&quot;Lifecycle_stage: {experiment.lifecycle_stage}&quot;)</span>
<span class="sd">        print(f&quot;Last Updated timestamp: {experiment.last_update_time}&quot;)</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">        Name: New Experiment</span>
<span class="sd">        Artifact Location: file:///.../mlruns/2</span>
<span class="sd">        Lifecycle_stage: deleted</span>
<span class="sd">        Last Updated timestamp: 1662004217511</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">delete_experiment</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">)</span></div>


<div class="viewcode-block" id="delete_run"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.delete_run">[docs]</a><span class="k">def</span> <span class="nf">delete_run</span><span class="p">(</span><span class="n">run_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deletes a run with the given ID.</span>

<span class="sd">    Args:</span>
<span class="sd">        run_id: Unique identifier for the run to delete.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        with mlflow.start_run() as run:</span>
<span class="sd">            mlflow.log_param(&quot;p&quot;, 0)</span>

<span class="sd">        run_id = run.info.run_id</span>
<span class="sd">        mlflow.delete_run(run_id)</span>

<span class="sd">        lifecycle_stage = mlflow.get_run(run_id).info.lifecycle_stage</span>
<span class="sd">        print(f&quot;run_id: {run_id}; lifecycle_stage: {lifecycle_stage}&quot;)</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">        run_id: 45f4af3e6fd349e58579b27fcb0b8277; lifecycle_stage: deleted</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">delete_run</span><span class="p">(</span><span class="n">run_id</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_artifact_uri"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.get_artifact_uri">[docs]</a><span class="k">def</span> <span class="nf">get_artifact_uri</span><span class="p">(</span><span class="n">artifact_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the absolute URI of the specified artifact in the currently active run.</span>

<span class="sd">    If `path` is not specified, the artifact root URI of the currently active</span>
<span class="sd">    run will be returned; calls to ``log_artifact`` and ``log_artifacts`` write</span>
<span class="sd">    artifact(s) to subdirectories of the artifact root URI.</span>

<span class="sd">    If no run is active, this method will create a new active run.</span>

<span class="sd">    Args:</span>
<span class="sd">        artifact_path: The run-relative artifact path for which to obtain an absolute URI.</span>
<span class="sd">            For example, &quot;path/to/artifact&quot;. If unspecified, the artifact root URI</span>
<span class="sd">            for the currently active run will be returned.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An *absolute* URI referring to the specified artifact or the currently active run&#39;s</span>
<span class="sd">        artifact root. For example, if an artifact path is provided and the currently active</span>
<span class="sd">        run uses an S3-backed store, this may be a uri of the form</span>
<span class="sd">        ``s3://&lt;bucket_name&gt;/path/to/artifact/root/path/to/artifact``. If an artifact path</span>
<span class="sd">        is not provided and the currently active run uses an S3-backed store, this may be a</span>
<span class="sd">        URI of the form ``s3://&lt;bucket_name&gt;/path/to/artifact/root``.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        features = &quot;rooms, zipcode, median_price, school_rating, transport&quot;</span>
<span class="sd">        with open(&quot;features.txt&quot;, &quot;w&quot;) as f:</span>
<span class="sd">            f.write(features)</span>

<span class="sd">        # Log the artifact in a directory &quot;features&quot; under the root artifact_uri/features</span>
<span class="sd">        with mlflow.start_run():</span>
<span class="sd">            mlflow.log_artifact(&quot;features.txt&quot;, artifact_path=&quot;features&quot;)</span>

<span class="sd">            # Fetch the artifact uri root directory</span>
<span class="sd">            artifact_uri = mlflow.get_artifact_uri()</span>
<span class="sd">            print(f&quot;Artifact uri: {artifact_uri}&quot;)</span>

<span class="sd">            # Fetch a specific artifact uri</span>
<span class="sd">            artifact_uri = mlflow.get_artifact_uri(artifact_path=&quot;features/features.txt&quot;)</span>
<span class="sd">            print(f&quot;Artifact uri: {artifact_uri}&quot;)</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">        Artifact uri: file:///.../0/a46a80f1c9644bd8f4e5dd5553fffce/artifacts</span>
<span class="sd">        Artifact uri: file:///.../0/a46a80f1c9644bd8f4e5dd5553fffce/artifacts/features/features.txt</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">artifact_utils</span><span class="o">.</span><span class="n">get_artifact_uri</span><span class="p">(</span>
        <span class="n">run_id</span><span class="o">=</span><span class="n">_get_or_start_run</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span><span class="p">,</span> <span class="n">artifact_path</span><span class="o">=</span><span class="n">artifact_path</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="search_runs"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.search_runs">[docs]</a><span class="k">def</span> <span class="nf">search_runs</span><span class="p">(</span>
    <span class="n">experiment_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filter_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">run_view_type</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">ViewType</span><span class="o">.</span><span class="n">ACTIVE_ONLY</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">SEARCH_MAX_RESULTS_PANDAS</span><span class="p">,</span>
    <span class="n">order_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;pandas&quot;</span><span class="p">,</span>
    <span class="n">search_all_experiments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">experiment_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Run</span><span class="p">],</span> <span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Search for Runs that fit the specified criteria.</span>

<span class="sd">    Args:</span>
<span class="sd">        experiment_ids: List of experiment IDs. Search can work with experiment IDs or</span>
<span class="sd">            experiment names, but not both in the same call. Values other than</span>
<span class="sd">            ``None`` or ``[]`` will result in error if ``experiment_names`` is</span>
<span class="sd">            also not ``None`` or ``[]``. ``None`` will default to the active</span>
<span class="sd">            experiment if ``experiment_names`` is ``None`` or ``[]``.</span>
<span class="sd">        filter_string: Filter query string, defaults to searching all runs.</span>
<span class="sd">        run_view_type: one of enum values ``ACTIVE_ONLY``, ``DELETED_ONLY``, or ``ALL`` runs</span>
<span class="sd">            defined in :py:class:`mlflow.entities.ViewType`.</span>
<span class="sd">        max_results: The maximum number of runs to put in the dataframe. Default is 100,000</span>
<span class="sd">            to avoid causing out-of-memory issues on the user&#39;s machine.</span>
<span class="sd">        order_by: List of columns to order by (e.g., &quot;metrics.rmse&quot;). The ``order_by`` column</span>
<span class="sd">            can contain an optional ``DESC`` or ``ASC`` value. The default is ``ASC``.</span>
<span class="sd">            The default ordering is to sort by ``start_time DESC``, then ``run_id``.</span>
<span class="sd">        output_format: The output format to be returned. If ``pandas``, a ``pandas.DataFrame``</span>
<span class="sd">            is returned and, if ``list``, a list of :py:class:`mlflow.entities.Run`</span>
<span class="sd">            is returned.</span>
<span class="sd">        search_all_experiments: Boolean specifying whether all experiments should be searched.</span>
<span class="sd">            Only honored if ``experiment_ids`` is ``[]`` or ``None``.</span>
<span class="sd">        experiment_names: List of experiment names. Search can work with experiment IDs or</span>
<span class="sd">            experiment names, but not both in the same call. Values other</span>
<span class="sd">            than ``None`` or ``[]`` will result in error if ``experiment_ids``</span>
<span class="sd">            is also not ``None`` or ``[]``. ``None`` will default to the active</span>
<span class="sd">            experiment if ``experiment_ids`` is ``None`` or ``[]``.</span>

<span class="sd">    Returns:</span>
<span class="sd">        If output_format is ``list``: a list of :py:class:`mlflow.entities.Run`. If</span>
<span class="sd">        output_format is ``pandas``: ``pandas.DataFrame`` of runs, where each metric,</span>
<span class="sd">        parameter, and tag is expanded into its own column named metrics.*, params.*, or</span>
<span class="sd">        tags.* respectively. For runs that don&#39;t have a particular metric, parameter, or tag,</span>
<span class="sd">        the value for the corresponding column is (NumPy) ``Nan``, ``None``, or ``None``</span>
<span class="sd">        respectively.</span>

<span class="sd">     .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import mlflow</span>

<span class="sd">        # Create an experiment and log two runs under it</span>
<span class="sd">        experiment_name = &quot;Social NLP Experiments&quot;</span>
<span class="sd">        experiment_id = mlflow.create_experiment(experiment_name)</span>
<span class="sd">        with mlflow.start_run(experiment_id=experiment_id):</span>
<span class="sd">            mlflow.log_metric(&quot;m&quot;, 1.55)</span>
<span class="sd">            mlflow.set_tag(&quot;s.release&quot;, &quot;1.1.0-RC&quot;)</span>
<span class="sd">        with mlflow.start_run(experiment_id=experiment_id):</span>
<span class="sd">            mlflow.log_metric(&quot;m&quot;, 2.50)</span>
<span class="sd">            mlflow.set_tag(&quot;s.release&quot;, &quot;1.2.0-GA&quot;)</span>
<span class="sd">        # Search for all the runs in the experiment with the given experiment ID</span>
<span class="sd">        df = mlflow.search_runs([experiment_id], order_by=[&quot;metrics.m DESC&quot;])</span>
<span class="sd">        print(df[[&quot;metrics.m&quot;, &quot;tags.s.release&quot;, &quot;run_id&quot;]])</span>
<span class="sd">        print(&quot;--&quot;)</span>
<span class="sd">        # Search the experiment_id using a filter_string with tag</span>
<span class="sd">        # that has a case insensitive pattern</span>
<span class="sd">        filter_string = &quot;tags.s.release ILIKE &#39;%rc%&#39;&quot;</span>
<span class="sd">        df = mlflow.search_runs([experiment_id], filter_string=filter_string)</span>
<span class="sd">        print(df[[&quot;metrics.m&quot;, &quot;tags.s.release&quot;, &quot;run_id&quot;]])</span>
<span class="sd">        print(&quot;--&quot;)</span>
<span class="sd">        # Search for all the runs in the experiment with the given experiment name</span>
<span class="sd">        df = mlflow.search_runs(experiment_names=[experiment_name], order_by=[&quot;metrics.m DESC&quot;])</span>
<span class="sd">        print(df[[&quot;metrics.m&quot;, &quot;tags.s.release&quot;, &quot;run_id&quot;]])</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">           metrics.m tags.s.release                            run_id</span>
<span class="sd">        0       2.50       1.2.0-GA  147eed886ab44633902cc8e19b2267e2</span>
<span class="sd">        1       1.55       1.1.0-RC  5cc7feaf532f496f885ad7750809c4d4</span>
<span class="sd">        --</span>
<span class="sd">           metrics.m tags.s.release                            run_id</span>
<span class="sd">        0       1.55       1.1.0-RC  5cc7feaf532f496f885ad7750809c4d4</span>
<span class="sd">        --</span>
<span class="sd">           metrics.m tags.s.release                            run_id</span>
<span class="sd">        0       2.50       1.2.0-GA  147eed886ab44633902cc8e19b2267e2</span>
<span class="sd">        1       1.55       1.1.0-RC  5cc7feaf532f496f885ad7750809c4d4</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">no_ids</span> <span class="o">=</span> <span class="n">experiment_ids</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">experiment_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">no_names</span> <span class="o">=</span> <span class="n">experiment_names</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">experiment_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">no_ids_or_names</span> <span class="o">=</span> <span class="n">no_ids</span> <span class="ow">and</span> <span class="n">no_names</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">no_ids</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">no_names</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Only experiment_ids or experiment_names can be used, but not both&quot;</span><span class="p">,</span>
            <span class="n">error_code</span><span class="o">=</span><span class="n">INVALID_PARAMETER_VALUE</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">search_all_experiments</span> <span class="ow">and</span> <span class="n">no_ids_or_names</span><span class="p">:</span>
        <span class="n">experiment_ids</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">exp</span><span class="o">.</span><span class="n">experiment_id</span> <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">search_experiments</span><span class="p">(</span><span class="n">view_type</span><span class="o">=</span><span class="n">ViewType</span><span class="o">.</span><span class="n">ACTIVE_ONLY</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="k">elif</span> <span class="n">no_ids_or_names</span><span class="p">:</span>
        <span class="n">experiment_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">_get_experiment_id</span><span class="p">()]</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">no_names</span><span class="p">:</span>
        <span class="n">experiments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">experiment_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">experiment_by_name</span> <span class="o">=</span> <span class="n">get_experiment_by_name</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">experiment_by_name</span><span class="p">:</span>
                    <span class="n">experiments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">experiment_by_name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Cannot retrieve experiment by name </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">experiment_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">experiment_id</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">experiments</span> <span class="k">if</span> <span class="n">e</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">experiment_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">runs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Using an internal function as the linter doesn&#39;t like assigning a lambda, and inlining the</span>
        <span class="c1"># full thing is a mess</span>
        <span class="k">def</span> <span class="nf">pagination_wrapper_func</span><span class="p">(</span><span class="n">number_to_get</span><span class="p">,</span> <span class="n">next_page_token</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">search_runs</span><span class="p">(</span>
                <span class="n">experiment_ids</span><span class="p">,</span>
                <span class="n">filter_string</span><span class="p">,</span>
                <span class="n">run_view_type</span><span class="p">,</span>
                <span class="n">number_to_get</span><span class="p">,</span>
                <span class="n">order_by</span><span class="p">,</span>
                <span class="n">next_page_token</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">runs</span> <span class="o">=</span> <span class="n">get_results_from_paginated_fn</span><span class="p">(</span>
            <span class="n">pagination_wrapper_func</span><span class="p">,</span>
            <span class="n">NUM_RUNS_PER_PAGE_PANDAS</span><span class="p">,</span>
            <span class="n">max_results</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s2">&quot;list&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">runs</span>  <span class="c1"># List[mlflow.entities.run.Run]</span>
    <span class="k">elif</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s2">&quot;pandas&quot;</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;run_id&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;experiment_id&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;artifact_uri&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;end_time&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">tags</span> <span class="o">=</span> <span class="p">({},</span> <span class="p">{},</span> <span class="p">{})</span>
        <span class="n">PARAM_NULL</span><span class="p">,</span> <span class="n">METRIC_NULL</span><span class="p">,</span> <span class="n">TAG_NULL</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">run</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">runs</span><span class="p">):</span>
            <span class="n">info</span><span class="p">[</span><span class="s2">&quot;run_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">run_id</span><span class="p">)</span>
            <span class="n">info</span><span class="p">[</span><span class="s2">&quot;experiment_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">experiment_id</span><span class="p">)</span>
            <span class="n">info</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
            <span class="n">info</span><span class="p">[</span><span class="s2">&quot;artifact_uri&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">artifact_uri</span><span class="p">)</span>
            <span class="n">info</span><span class="p">[</span><span class="s2">&quot;start_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="n">info</span><span class="p">[</span><span class="s2">&quot;end_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">end_time</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

            <span class="c1"># Params</span>
            <span class="n">param_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">param_keys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PARAM_NULL</span><span class="p">)</span>
            <span class="n">new_params</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="n">param_keys</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">new_params</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">PARAM_NULL</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span>  <span class="c1"># Fill in null values for all previous runs</span>
                <span class="n">params</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>

            <span class="c1"># Metrics</span>
            <span class="n">metric_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">metric_keys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">metrics</span><span class="p">:</span>
                    <span class="n">metrics</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">metrics</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">METRIC_NULL</span><span class="p">)</span>
            <span class="n">new_metrics</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="n">metric_keys</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">new_metrics</span><span class="p">:</span>
                <span class="n">metrics</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">METRIC_NULL</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span>
                <span class="n">metrics</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="n">m</span><span class="p">])</span>

            <span class="c1"># Tags</span>
            <span class="n">tag_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tags</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">tag_keys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
                    <span class="n">tags</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tags</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tags</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TAG_NULL</span><span class="p">)</span>
            <span class="n">new_tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="n">tag_keys</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">new_tags</span><span class="p">:</span>
                <span class="n">tags</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">TAG_NULL</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span>
                <span class="n">tags</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tags</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;metrics.&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;params.&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">tags</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;tags.&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unsupported output format: </span><span class="si">{</span><span class="n">output_format</span><span class="si">}</span><span class="s2">. Supported string values are &#39;pandas&#39; &quot;</span>
            <span class="s2">&quot;or &#39;list&#39;&quot;</span>
        <span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_get_or_start_run</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_active_run_stack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_active_run_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">start_run</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">_get_experiment_id_from_env</span><span class="p">():</span>
    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">MLFLOW_EXPERIMENT_NAME</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">experiment_id</span> <span class="o">=</span> <span class="n">MLFLOW_EXPERIMENT_ID</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">experiment_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">exp</span> <span class="o">=</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">get_experiment_by_name</span><span class="p">(</span><span class="n">experiment_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exp</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">experiment_id</span> <span class="ow">and</span> <span class="n">experiment_id</span> <span class="o">!=</span> <span class="n">exp</span><span class="o">.</span><span class="n">experiment_id</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;The provided </span><span class="si">{</span><span class="n">MLFLOW_EXPERIMENT_ID</span><span class="si">}</span><span class="s2"> environment variable &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;value `</span><span class="si">{</span><span class="n">experiment_id</span><span class="si">}</span><span class="s2">` does not match the experiment id &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">exp</span><span class="o">.</span><span class="n">experiment_id</span><span class="si">}</span><span class="s2">` for experiment name `</span><span class="si">{</span><span class="n">experiment_name</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">,</span>
                    <span class="n">error_code</span><span class="o">=</span><span class="n">INVALID_PARAMETER_VALUE</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">exp</span><span class="o">.</span><span class="n">experiment_id</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">create_experiment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">experiment_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">experiment_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="n">MlflowClient</span><span class="p">()</span><span class="o">.</span><span class="n">get_experiment</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">exp</span><span class="o">.</span><span class="n">experiment_id</span>
        <span class="k">except</span> <span class="n">MlflowException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MlflowException</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;The provided </span><span class="si">{</span><span class="n">MLFLOW_EXPERIMENT_ID</span><span class="si">}</span><span class="s2"> environment variable &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;value `</span><span class="si">{</span><span class="n">experiment_id</span><span class="si">}</span><span class="s2">` does not exist in the tracking server. Provide a valid &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;experiment_id.&quot;</span><span class="p">,</span>
                <span class="n">error_code</span><span class="o">=</span><span class="n">INVALID_PARAMETER_VALUE</span><span class="p">,</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>


<span class="k">def</span> <span class="nf">_get_experiment_id</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">_active_experiment_id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_active_experiment_id</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_get_experiment_id_from_env</span><span class="p">()</span> <span class="ow">or</span> <span class="n">default_experiment_registry</span><span class="o">.</span><span class="n">get_experiment_id</span><span class="p">()</span>


<div class="viewcode-block" id="autolog"><a class="viewcode-back" href="../../../python_api/mlflow.html#mlflow.autolog">[docs]</a><span class="nd">@autologging_integration</span><span class="p">(</span><span class="s2">&quot;mlflow&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">autolog</span><span class="p">(</span>
    <span class="n">log_input_examples</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">log_model_signatures</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">log_models</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">log_datasets</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">disable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclusive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">disable_for_unsupported_versions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">silent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">extra_tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enables (or disables) and configures autologging for all supported integrations.</span>

<span class="sd">    The parameters are passed to any autologging integrations that support them.</span>

<span class="sd">    See the :ref:`tracking docs &lt;automatic-logging&gt;` for a list of supported autologging</span>
<span class="sd">    integrations.</span>

<span class="sd">    Note that framework-specific configurations set at any point will take precedence over</span>
<span class="sd">    any configurations set by this function. For example:</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>

<span class="sd">        import mlflow</span>

<span class="sd">        mlflow.autolog(log_models=False, exclusive=True)</span>
<span class="sd">        import sklearn</span>

<span class="sd">    would enable autologging for `sklearn` with `log_models=False` and `exclusive=True`,</span>
<span class="sd">    but</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>

<span class="sd">        import mlflow</span>

<span class="sd">        mlflow.autolog(log_models=False, exclusive=True)</span>

<span class="sd">        import sklearn</span>

<span class="sd">        mlflow.sklearn.autolog(log_models=True)</span>

<span class="sd">    would enable autologging for `sklearn` with `log_models=True` and `exclusive=False`,</span>
<span class="sd">    the latter resulting from the default value for `exclusive` in `mlflow.sklearn.autolog`;</span>
<span class="sd">    other framework autolog functions (e.g. `mlflow.tensorflow.autolog`) would use the</span>
<span class="sd">    configurations set by `mlflow.autolog` (in this instance, `log_models=False`, `exclusive=True`),</span>
<span class="sd">    until they are explicitly called by the user.</span>

<span class="sd">    Args:</span>
<span class="sd">        log_input_examples: If ``True``, input examples from training datasets are collected and</span>
<span class="sd">            logged along with model artifacts during training. If ``False``,</span>
<span class="sd">            input examples are not logged.</span>
<span class="sd">            Note: Input examples are MLflow model attributes</span>
<span class="sd">            and are only collected if ``log_models`` is also ``True``.</span>
<span class="sd">        log_model_signatures: If ``True``,</span>
<span class="sd">            :py:class:`ModelSignatures &lt;mlflow.models.ModelSignature&gt;`</span>
<span class="sd">            describing model inputs and outputs are collected and logged along</span>
<span class="sd">            with model artifacts during training. If ``False``, signatures are</span>
<span class="sd">            not logged. Note: Model signatures are MLflow model attributes</span>
<span class="sd">            and are only collected if ``log_models`` is also ``True``.</span>
<span class="sd">        log_models: If ``True``, trained models are logged as MLflow model artifacts.</span>
<span class="sd">            If ``False``, trained models are not logged.</span>
<span class="sd">            Input examples and model signatures, which are attributes of MLflow models,</span>
<span class="sd">            are also omitted when ``log_models`` is ``False``.</span>
<span class="sd">        log_datasets: If ``True``, dataset information is logged to MLflow Tracking.</span>
<span class="sd">            If ``False``, dataset information is not logged.</span>
<span class="sd">        disable: If ``True``, disables all supported autologging integrations. If ``False``,</span>
<span class="sd">            enables all supported autologging integrations.</span>
<span class="sd">        exclusive: If ``True``, autologged content is not logged to user-created fluent runs.</span>
<span class="sd">            If ``False``, autologged content is logged to the active fluent run,</span>
<span class="sd">            which may be user-created.</span>
<span class="sd">        disable_for_unsupported_versions: If ``True``, disable autologging for versions of</span>
<span class="sd">            all integration libraries that have not been tested against this version</span>
<span class="sd">            of the MLflow client or are incompatible.</span>
<span class="sd">        silent: If ``True``, suppress all event logs and warnings from MLflow during autologging</span>
<span class="sd">            setup and training execution. If ``False``, show all events and warnings during</span>
<span class="sd">            autologging setup and training execution.</span>
<span class="sd">        extra_tags: A dictionary of extra tags to set on each managed run created by autologging.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :test:</span>
<span class="sd">        :caption: Example</span>

<span class="sd">        import numpy as np</span>
<span class="sd">        import mlflow.sklearn</span>
<span class="sd">        from mlflow import MlflowClient</span>
<span class="sd">        from sklearn.linear_model import LinearRegression</span>


<span class="sd">        def print_auto_logged_info(r):</span>
<span class="sd">            tags = {k: v for k, v in r.data.tags.items() if not k.startswith(&quot;mlflow.&quot;)}</span>
<span class="sd">            artifacts = [f.path for f in MlflowClient().list_artifacts(r.info.run_id, &quot;model&quot;)]</span>
<span class="sd">            print(f&quot;run_id: {r.info.run_id}&quot;)</span>
<span class="sd">            print(f&quot;artifacts: {artifacts}&quot;)</span>
<span class="sd">            print(f&quot;params: {r.data.params}&quot;)</span>
<span class="sd">            print(f&quot;metrics: {r.data.metrics}&quot;)</span>
<span class="sd">            print(f&quot;tags: {tags}&quot;)</span>


<span class="sd">        # prepare training data</span>
<span class="sd">        X = np.array([[1, 1], [1, 2], [2, 2], [2, 3]])</span>
<span class="sd">        y = np.dot(X, np.array([1, 2])) + 3</span>

<span class="sd">        # Auto log all the parameters, metrics, and artifacts</span>
<span class="sd">        mlflow.autolog()</span>
<span class="sd">        model = LinearRegression()</span>
<span class="sd">        with mlflow.start_run() as run:</span>
<span class="sd">            model.fit(X, y)</span>

<span class="sd">        # fetch the auto logged parameters and metrics for ended run</span>
<span class="sd">        print_auto_logged_info(mlflow.get_run(run_id=run.info.run_id))</span>

<span class="sd">    .. code-block:: text</span>
<span class="sd">        :caption: Output</span>

<span class="sd">        run_id: fd10a17d028c47399a55ab8741721ef7</span>
<span class="sd">        artifacts: [&#39;model/MLmodel&#39;, &#39;model/conda.yaml&#39;, &#39;model/model.pkl&#39;]</span>
<span class="sd">        params: {&#39;copy_X&#39;: &#39;True&#39;,</span>
<span class="sd">                 &#39;normalize&#39;: &#39;False&#39;,</span>
<span class="sd">                 &#39;fit_intercept&#39;: &#39;True&#39;,</span>
<span class="sd">                 &#39;n_jobs&#39;: &#39;None&#39;}</span>
<span class="sd">        metrics: {&#39;training_score&#39;: 1.0,</span>
<span class="sd">                  &#39;training_root_mean_squared_error&#39;: 4.440892098500626e-16,</span>
<span class="sd">                  &#39;training_r2_score&#39;: 1.0,</span>
<span class="sd">                  &#39;training_mean_absolute_error&#39;: 2.220446049250313e-16,</span>
<span class="sd">                  &#39;training_mean_squared_error&#39;: 1.9721522630525295e-31}</span>
<span class="sd">        tags: {&#39;estimator_class&#39;: &#39;sklearn.linear_model._base.LinearRegression&#39;,</span>
<span class="sd">               &#39;estimator_name&#39;: &#39;LinearRegression&#39;}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">locals_copy</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

    <span class="c1"># Mapping of library name to specific autolog function name. We use string like</span>
    <span class="c1"># &quot;tensorflow.autolog&quot; to avoid loading all flavor modules, so we only set autologging for</span>
    <span class="c1"># compatible modules.</span>
    <span class="c1"># eg: mxnet.gluon is the actual library, mlflow.gluon.autolog is our autolog function for it</span>
    <span class="n">LIBRARY_TO_AUTOLOG_MODULE</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;tensorflow&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.tensorflow&quot;</span><span class="p">,</span>
        <span class="s2">&quot;keras&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.keras&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mxnet.gluon&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.gluon&quot;</span><span class="p">,</span>
        <span class="s2">&quot;xgboost&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.xgboost&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lightgbm&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.lightgbm&quot;</span><span class="p">,</span>
        <span class="s2">&quot;statsmodels&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.statsmodels&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sklearn&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.sklearn&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fastai&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.fastai&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pyspark&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.spark&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pyspark.ml&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.pyspark.ml&quot;</span><span class="p">,</span>
        <span class="c1"># TODO: Broaden this beyond pytorch_lightning as we add autologging support for more</span>
        <span class="c1"># Pytorch frameworks under mlflow.pytorch.autolog</span>
        <span class="s2">&quot;pytorch_lightning&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.pytorch&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lightning&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.pytorch&quot;</span><span class="p">,</span>
        <span class="s2">&quot;setfit&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.transformers&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transformers&quot;</span><span class="p">:</span> <span class="s2">&quot;mlflow.transformers&quot;</span><span class="p">,</span>
        <span class="c1"># do not enable langchain autologging by default</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">get_autologging_params</span><span class="p">(</span><span class="n">autolog_fn</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">needed_params</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">autolog_fn</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">locals_copy</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">needed_params</span><span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">setup_autologging</span><span class="p">(</span><span class="n">module</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">autologging_params</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">autolog_module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">LIBRARY_TO_AUTOLOG_MODULE</span><span class="p">[</span><span class="n">module</span><span class="o">.</span><span class="vm">__name__</span><span class="p">])</span>
            <span class="n">autolog_fn</span> <span class="o">=</span> <span class="n">autolog_module</span><span class="o">.</span><span class="n">autolog</span>
            <span class="c1"># Only call integration&#39;s autolog function with `mlflow.autolog` configs</span>
            <span class="c1"># if the integration&#39;s autolog function has not already been called by the user.</span>
            <span class="c1"># Logic is as follows:</span>
            <span class="c1"># - if a previous_config exists, that means either `mlflow.autolog` or</span>
            <span class="c1">#   `mlflow.integration.autolog` was called.</span>
            <span class="c1"># - if the config contains `AUTOLOGGING_CONF_KEY_IS_GLOBALLY_CONFIGURED`, the</span>
            <span class="c1">#   configuration was set by `mlflow.autolog`, and so we can safely call `autolog_fn`</span>
            <span class="c1">#   with `autologging_params`.</span>
            <span class="c1"># - if the config doesn&#39;t contain this key, the configuration was set by an</span>
            <span class="c1">#   `mlflow.integration.autolog` call, so we should not call `autolog_fn` with</span>
            <span class="c1">#   new configs.</span>
            <span class="n">prev_config</span> <span class="o">=</span> <span class="n">AUTOLOGGING_INTEGRATIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">autolog_fn</span><span class="o">.</span><span class="n">integration_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">prev_config</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">prev_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="n">AUTOLOGGING_CONF_KEY_IS_GLOBALLY_CONFIGURED</span><span class="p">,</span> <span class="kc">False</span>
            <span class="p">):</span>
                <span class="k">return</span>

            <span class="n">autologging_params</span> <span class="o">=</span> <span class="n">get_autologging_params</span><span class="p">(</span><span class="n">autolog_fn</span><span class="p">)</span>
            <span class="n">autolog_fn</span><span class="p">(</span><span class="o">**</span><span class="n">autologging_params</span><span class="p">)</span>
            <span class="n">AUTOLOGGING_INTEGRATIONS</span><span class="p">[</span><span class="n">autolog_fn</span><span class="o">.</span><span class="n">integration_name</span><span class="p">][</span>
                <span class="n">AUTOLOGGING_CONF_KEY_IS_GLOBALLY_CONFIGURED</span>
            <span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">autologging_is_disabled</span><span class="p">(</span>
                <span class="n">autolog_fn</span><span class="o">.</span><span class="n">integration_name</span>
            <span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">autologging_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;silent&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Autologging successfully enabled for </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">module</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_testing</span><span class="p">():</span>
                <span class="c1"># Raise unexpected exceptions in test mode in order to detect</span>
                <span class="c1"># errors within dependent autologging integrations</span>
                <span class="k">raise</span>
            <span class="k">elif</span> <span class="n">autologging_params</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">autologging_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;silent&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Exception raised while enabling autologging for </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">module</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="p">)</span>

    <span class="c1"># for each autolog library (except pyspark), register a post-import hook.</span>
    <span class="c1"># this way, we do not send any errors to the user until we know they are using the library.</span>
    <span class="c1"># the post-import hook also retroactively activates for previously-imported libraries.</span>
    <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">LIBRARY_TO_AUTOLOG_MODULE</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="p">{</span><span class="s2">&quot;pyspark&quot;</span><span class="p">,</span> <span class="s2">&quot;pyspark.ml&quot;</span><span class="p">}):</span>
        <span class="n">register_post_import_hook</span><span class="p">(</span><span class="n">setup_autologging</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">is_in_databricks_runtime</span><span class="p">():</span>
        <span class="c1"># for pyspark, we activate autologging immediately, without waiting for a module import.</span>
        <span class="c1"># this is because on Databricks a SparkSession already exists and the user can directly</span>
        <span class="c1">#   interact with it, and this activity should be logged.</span>
        <span class="kn">import</span> <span class="nn">pyspark</span> <span class="k">as</span> <span class="nn">pyspark_module</span>
        <span class="kn">import</span> <span class="nn">pyspark.ml</span> <span class="k">as</span> <span class="nn">pyspark_ml_module</span>

        <span class="n">setup_autologging</span><span class="p">(</span><span class="n">pyspark_module</span><span class="p">)</span>
        <span class="n">setup_autologging</span><span class="p">(</span><span class="n">pyspark_ml_module</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">register_post_import_hook</span><span class="p">(</span><span class="n">setup_autologging</span><span class="p">,</span> <span class="s2">&quot;pyspark&quot;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">register_post_import_hook</span><span class="p">(</span><span class="n">setup_autologging</span><span class="p">,</span> <span class="s2">&quot;pyspark.ml&quot;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>
</pre></div>

              </div>
            </div>
            <footer>
  

  <hr/>

  <div role="contentinfo">
      <p class="copyright">
          &copy; MLflow Project, a Series of LF Projects, LLC. All rights reserved.
      </p>

  </div> 

</footer>
          </div>
        </div>
      </section>
    </main>
  </page>

  


  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:'../../../',
      VERSION:'2.17.1.dev0',
      COLLAPSE_INDEX:false,
      FILE_SUFFIX:'.html',
      LINK_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>

  

  <script type="text/javascript" src="../../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/jquery.waypoints.min.js"></script>

  
  
  
  <script type="text/javascript">var CLIPPY_SVG_PATH = "../../../_static/clippy.svg";</script>
  <script type="text/javascript" src="../../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  

  
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
        }
        // Get the code block designator class entries
        const allHighlights = document.querySelectorAll('.highlight');
        // Disable copyable links for notebook cell numbering and for cell outputs
        const highlights = Array.from(allHighlights).filter(highlight => !highlight.closest('.highlight-none') && 
            !highlight.closest('.nboutput'));
    
        highlights.forEach(function(highlight) {
            const copyIcon = document.createElement('span');
            copyIcon.classList.add('copy-icon');
            copyIcon.innerHTML = '&#xf0ea;';

            copyIcon.addEventListener('click', function() {
                const code = highlight.querySelector('pre').textContent;
                copyToClipboard(code);

                // Flash effect on click
                this.style.color = '#0194E2';
                setTimeout(() => {
                    this.style.color = ''; 
                }, 100);

                // Display "Code copied to clipboard" near the clicked icon
                const message = document.createElement('span');
                message.textContent = "Copied!";
                message.classList.add('copy-message'); 

                // Append the message to the icon
                this.appendChild(message);

                setTimeout(() => {
                    this.removeChild(message);
                }, 500);
            });

            highlight.appendChild(copyIcon);
        });
    });
  </script>


<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        // Force download for notebook-download-btn
        const downloadButtons = document.querySelectorAll('.notebook-download-btn');
        downloadButtons.forEach(function(button) {
            button.addEventListener('click', function(event) {
                event.preventDefault(); // Prevent default behavior

                // Fetch the raw content of the notebook from GitHub
                fetch(button.href)
                    .then(response => response.blob())
                    .then(blob => {
                        const url = window.URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.style.display = 'none';
                        link.href = url;
                        const filename = button.href.split('/').pop();
                        link.download = filename; 

                        document.body.appendChild(link);
                        link.click();

                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(link);
                    })
                    .catch(err => console.error('Error fetching the notebook:', err));
            });
        });
    });
</script> 
</body>
</html>