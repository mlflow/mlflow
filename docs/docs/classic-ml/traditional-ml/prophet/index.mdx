import FeatureHighlights from "@site/src/components/FeatureHighlights";
import TilesGrid from "@site/src/components/TilesGrid";
import TileCard from "@site/src/components/TileCard";
import { TrendingUp, GitBranch, CheckCircle, Package } from "lucide-react";

# MLflow Prophet Integration

## Introduction

**Prophet** is Meta's open-source time series forecasting library designed for business forecasting tasks. It decomposes time series into trend, seasonality, and holiday effects, handling missing data and outliers while producing interpretable forecasts.

MLflow's Prophet integration provides experiment tracking, model versioning, and deployment capabilities for time series forecasting workflows.

:::note No Autologging for Prophet

Prophet does not support autologging to prevent overwhelming the tracking server. Time series forecasting often involves training hundreds or thousands of models (e.g., one per product or location), which would create excessive load on the tracking server if autologging were enabled. Use manual logging with bulk APIs for large-scale forecasting workflows.

:::

## Why MLflow + Prophet?

<FeatureHighlights
  features={[
    {
      icon: TrendingUp,
      title: "Model Tracking",
      description: "Log Prophet models with parameters, cross-validation metrics, and forecast components for comprehensive experiment tracking.",
    },
    {
      icon: GitBranch,
      title: "Experiment Comparison",
      description: "Compare different seasonality configurations, holiday effects, and hyperparameter combinations across forecasting experiments.",
    },
    {
      icon: CheckCircle,
      title: "Forecast Validation",
      description: "Integrate Prophet's cross-validation metrics directly into MLflow tracking for reproducible model evaluation.",
    },
    {
      icon: Package,
      title: "Model Registry",
      description: "Version and deploy Prophet forecasting models with MLflow's model registry and serving infrastructure.",
    },
  ]}
/>

## Key Features

### Model Logging and Tracking

Log Prophet models with parameters, cross-validation metrics, and forecast components:

```python
import mlflow
import mlflow.prophet
from prophet import Prophet
from prophet.diagnostics import cross_validation, performance_metrics

with mlflow.start_run():
    # Create and fit Prophet model
    model = Prophet(
        changepoint_prior_scale=0.05,
        seasonality_prior_scale=10,
        yearly_seasonality=True,
        weekly_seasonality=True,
    )
    model.fit(df)

    # Cross-validation
    cv_results = cross_validation(
        model, initial="730 days", period="180 days", horizon="365 days"
    )
    metrics = performance_metrics(cv_results)
    mlflow.log_metrics(metrics[["mse", "rmse", "mae", "mape"]].mean().to_dict())

    # Log model
    mlflow.prophet.log_model(pr_model=model, name="prophet_model")
```

### Cross-Validation Integration

Prophet's time series cross-validation integrates directly with MLflow to track forecast performance across different horizons and configurations.

### Model Registry and Deployment

Version Prophet models in the MLflow Model Registry and deploy them using MLflow's serving infrastructure for production forecasting.

:::tip High-Volume Training

When training many Prophet models (e.g., forecasts for thousands of products), use bulk logging APIs to reduce tracking server overhead:

```python
# Batch log metrics and parameters
mlflow.log_params({f"param_{i}": value for i, value in enumerate(params)})
mlflow.log_metrics({f"metric_{i}": value for i, value in enumerate(metrics)})
```

:::

## Learn More

<TilesGrid>
  <TileCard
    icon={TrendingUp}
    title="Prophet Guide"
    description="Detailed guide for Prophet model logging, cross-validation, and deployment"
    href="/ml/traditional-ml/prophet/guide"
  />
  <TileCard
    icon={Package}
    title="Model Registry"
    description="Version and manage Prophet forecasting models"
    href="/ml/model-registry"
  />
  <TileCard
    icon={GitBranch}
    title="MLflow Tracking"
    description="Track experiments, parameters, and metrics"
    href="/ml/tracking"
  />
</TilesGrid>
