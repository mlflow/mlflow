import Link from "@docusaurus/Link";
import { CardGroup, PageCard } from "@site/src/components/Card";

# MLflow Evaluation

:::warning Classic ML Evaluation System

This documentation covers MLflow's **classic evaluation system** (`mlflow.evaluate`) which uses `EvaluationMetric` and `make_metric` for custom metrics.

**For GenAI/LLM evaluation**, please use the system at [GenAI Evaluation](/genai/eval-monitor) which uses:

- `mlflow.genai.evaluate()` instead of `mlflow.evaluate()`
- `Scorer` objects instead of `EvaluationMetric`
- Built-in LLM judges and scorers

**Important**: These two systems are **not interoperable**. `EvaluationMetric` objects cannot be used with `mlflow.genai.evaluate()`, and `Scorer` objects cannot be used with `mlflow.evaluate()`.
:::

## Introduction

**Model evaluation** is the cornerstone of reliable machine learning, transforming trained models into trustworthy, production-ready systems. MLflow's comprehensive evaluation framework goes beyond simple accuracy metrics, providing deep insights into model behavior, performance characteristics, and real-world readiness through automated testing, visualization, and validation pipelines.

MLflow's evaluation capabilities democratize advanced model assessment, making sophisticated evaluation techniques accessible to teams of all sizes. From rapid prototyping to enterprise deployment, MLflow evaluation ensures your models meet the highest standards of reliability, fairness, and performance.

<details>
  <summary>Why Comprehensive Model Evaluation Matters</summary>

#### Beyond Basic Metrics

- ğŸ“Š **Holistic Assessment**: Performance metrics, visualizations, and explanations in one unified framework
- ğŸ¯ **Task-Specific Evaluation**: Specialized evaluators for classification, regression, and LLM tasks
- ğŸ” **Model Interpretability**: SHAP integration for understanding model decisions and feature importance
- âš–ï¸ **Fairness Analysis**: Bias detection and ethical AI validation across demographic groups

#### Production Readiness

- ğŸš€ **Automated Validation**: Threshold-based model acceptance with customizable criteria
- ğŸ“ˆ **Performance Monitoring**: Track model degradation and drift over time
- ğŸ”„ **A/B Testing Support**: Compare candidate models against production baselines
- ğŸ“‹ **Audit Trails**: Complete evaluation history for regulatory compliance and model governance

</details>

## Why MLflow Evaluation?

MLflow's evaluation framework provides a comprehensive solution for model assessment and validation:

- âš¡ **One-Line Evaluation**: Comprehensive model assessment with `mlflow.evaluate()` - minimal configuration required
- ğŸ›ï¸ **Flexible Evaluation Modes**: Evaluate models, functions, or static datasets with the same unified API
- ğŸ“Š **Rich Visualizations**: Automatic generation of performance plots, confusion matrices, and diagnostic charts
- ğŸ”§ **Custom Metrics**: Define domain-specific evaluation criteria with easy-to-use metric builders
- ğŸ§  **Built-in Explainability**: SHAP integration for model interpretation and feature importance analysis
- ğŸ‘¥ **Team Collaboration**: Share evaluation results and model comparisons through MLflow's tracking interface
- ğŸ­ **Enterprise Integration**: Plugin architecture for specialized evaluation frameworks like Giskard and Trubrics

## Core Evaluation Capabilities

### Automated Model Assessment

MLflow evaluation transforms complex model assessment into simple, reproducible workflows:

```python
import mlflow
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.datasets import load_wine

# Load and prepare data
wine = load_wine()
X_train, X_test, y_train, y_test = train_test_split(
    wine.data, wine.target, test_size=0.2, random_state=42
)

# Train model
model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X_train, y_train)

# Create evaluation dataset
eval_data = X_test
eval_data["target"] = y_test

with mlflow.start_run():
    # Log model
    mlflow.sklearn.log_model(model, name="model")

    # Comprehensive evaluation with one line
    result = mlflow.models.evaluate(
        model="models:/my-model/1",
        data=eval_data,
        targets="target",
        model_type="classifier",
        evaluators=["default"],
    )
```

<details>
  <summary>What Gets Automatically Generated</summary>

#### Performance Metrics

- ğŸ“Š **Classification**: Accuracy, precision, recall, F1-score, ROC-AUC, confusion matrices
- ğŸ“ˆ **Regression**: MAE, MSE, RMSE, RÂ², residual analysis, prediction vs actual plots
- ğŸ¯ **Custom Metrics**: Domain-specific measures defined with simple Python functions

#### Visual Diagnostics

- ğŸ“Š **Performance Plots**: ROC curves, precision-recall curves, calibration plots
- ğŸ“ˆ **Feature Importance**: SHAP values, permutation importance, feature interactions

#### Model Explanations

- ğŸ§  **Global Explanations**: Overall model behavior and feature contributions (with `shap`)
- ğŸ” **Local Explanations**: Individual prediction explanations and decision paths (with `shap`)

</details>

### Flexible Evaluation Modes

MLflow supports multiple evaluation approaches to fit your workflow:

<details>
  <summary>Comprehensive Evaluation Options</summary>

#### Model Evaluation

- ğŸ¤– **Logged Models**: Evaluate models that have been logged to MLflow
- ğŸ”„ **Live Models**: Direct evaluation of in-memory model objects
- ğŸ“¦ **Pipeline Evaluation**: End-to-end assessment of preprocessing and modeling pipelines

#### Function Evaluation

- âš¡ **Lightweight Assessment**: Evaluate Python functions without model logging overhead
- ğŸ”§ **Custom Predictions**: Assess complex prediction logic and business rules
- ğŸ¯ **Rapid Prototyping**: Quick evaluation during model development

#### Dataset Evaluation

- ğŸ“Š **Static Analysis**: Evaluate pre-computed predictions without re-running models
- ğŸ”„ **Batch Processing**: Assess large-scale inference results efficiently
- ğŸ“ˆ **Historical Analysis**: Evaluate model performance on past predictions

</details>

## Specialized Evaluation Areas

Our comprehensive evaluation framework is organized into specialized areas, each designed for specific aspects of model assessment:

<CardGroup>
  <PageCard
    headerText="Model Evaluation"
    link="/ml/evaluation/model-eval"
    text="Core model evaluation workflows for classification and regression tasks with automated metrics, visualizations, and performance assessment."
  />
  <PageCard
    headerText="Dataset Evaluation"
    link="/ml/evaluation/dataset-eval"
    text="Evaluate static datasets and pre-computed predictions without re-running models, perfect for batch processing and historical analysis."
  />
</CardGroup>

<CardGroup>
  <PageCard
    headerText="Function Evaluation"
    link="/ml/evaluation/function-eval"
    text="Lightweight evaluation of Python functions and custom prediction logic without the overhead of model logging and registration."
  />
  <PageCard
    headerText="Custom Metrics & Visualizations"
    link="/ml/evaluation/metrics-visualizations"
    text="Define domain-specific evaluation criteria, custom metrics, and specialized visualizations tailored to your business requirements."
  />
</CardGroup>

<CardGroup>
  <PageCard
    headerText="SHAP Integration"
    link="/ml/evaluation/shap"
    text="Deep model interpretation with SHAP values, feature importance analysis, and explainable AI capabilities for transparent ML."
  />
  <PageCard
    headerText="Plugin Evaluators"
    link="/ml/evaluation/plugin-evaluators"
    text="Extend evaluation capabilities with specialized plugins like Giskard for vulnerability scanning and Trubrics for advanced validation."
  />
</CardGroup>

## Advanced Evaluation Features

### Enterprise Integration

<details>
  <summary>Production-Grade Evaluation</summary>

#### Model Governance

- ğŸ“‹ **Audit Trails**: Complete evaluation history for regulatory compliance
- ğŸ”’ **Access Control**: Role-based evaluation permissions and result visibility
- ğŸ“Š **Executive Dashboards**: High-level model performance summaries for stakeholders
- ğŸ”„ **Automated Reporting**: Scheduled evaluation reports and performance alerts

#### MLOps Integration

- ğŸš€ **CI/CD Pipelines**: Automated evaluation gates in deployment workflows
- ğŸ“ˆ **Performance Monitoring**: Continuous evaluation of production models
- ğŸ”„ **A/B Testing**: Statistical comparison of model variants in production
- ğŸ“Š **Drift Detection**: Automated alerts for model performance degradation

</details>

## Real-World Applications

MLflow evaluation excels across diverse machine learning applications:

- ğŸ¦ **Financial Services**: Credit scoring model validation, fraud detection performance assessment, and regulatory compliance evaluation
- ğŸ¥ **Healthcare**: Medical AI model validation, diagnostic accuracy assessment, and safety-critical model certification
- ğŸ›’ **E-commerce**: Recommendation system evaluation, search relevance assessment, and personalization effectiveness measurement
- ğŸš— **Autonomous Systems**: Safety-critical model validation, edge case analysis, and robustness testing for self-driving vehicles
- ğŸ¯ **Marketing Technology**: Campaign effectiveness measurement, customer segmentation validation, and attribution model assessment
- ğŸ­ **Manufacturing**: Quality control model validation, predictive maintenance assessment, and process optimization evaluation
- ğŸ“± **Technology Platforms**: Content moderation effectiveness, user behavior prediction accuracy, and system performance optimization

## Getting Started

Ready to elevate your model evaluation practices with MLflow? Choose the evaluation approach that best fits your current needs:

<details>
  <summary>Quick Start Recommendations</summary>

#### For Data Scientists

Start with [Model Evaluation](model-eval) to understand comprehensive performance assessment, then explore **Custom Metrics** for domain-specific requirements.

#### For ML Engineers

Begin with [Function Evaluation](function-eval) for lightweight testing, then advance to **Model Validation** for production readiness assessment.

#### For ML Researchers

Explore [SHAP Integration](shap) for model interpretability, then investigate **Plugin Evaluators** for specialized analysis capabilities.

#### For Enterprise Teams

Start with [Model Validation](metrics-visualizations) for governance requirements, then implement [Dataset Evaluation](dataset-eval) for large-scale assessment workflows.

</details>

Whether you're validating your first model or implementing enterprise-scale evaluation frameworks, MLflow's comprehensive evaluation suite provides the tools and insights needed to build trustworthy, reliable machine learning systems that deliver real business value with confidence.
