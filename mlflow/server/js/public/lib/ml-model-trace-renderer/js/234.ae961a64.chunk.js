"use strict";(self.webpackChunkdatabricks_mlModelTraceRenderer=self.webpackChunkdatabricks_mlModelTraceRenderer||[]).push([[234],{30234:(e,r,t)=>{let n;t.r(r),t.d(r,{CodeSnippetRenderMode:()=>ev,INFERENCE_TABLE_RESPONSE_COLUMN_KEY:()=>eg,INFERENCE_TABLE_TRACE_COLUMN_KEY:()=>em,MLFLOW_TRACE_SCHEMA_VERSION_KEY:()=>ep,ModelIconType:()=>eh,ModelSpanType:()=>ef,ModelTraceChildToParentFrameMessage:()=>ao,ModelTraceContextProvider:()=>ap,ModelTraceExplorer:()=>i2,ModelTraceExplorerFrameRenderer:()=>al,ModelTraceExplorerOSSNotebookRenderer:()=>i9,ModelTraceParentToChildFrameMessage:()=>ai,ModelTraceSpanType:()=>eE,getIsMlflowTraceUIEnabled:()=>eX,getModelTraceId:()=>eZ,getModelTraceSpanEndTime:()=>eV,getModelTraceSpanId:()=>e$,getModelTraceSpanParentId:()=>eK,getModelTraceSpanStartTime:()=>eH,getTraceArtifact:()=>i4,isModelTrace:()=>e0,isV3ModelTraceSpan:()=>eG,useModelTraceContext:()=>ad});var o=t(98358),i=t(40760),a=t.n(i),s=t(67494),l=t(59155),c=t(93556),d=t(33271),u=t(21340),p=t.n(u);let g=a().createContext({tags:{},contextChain:[],contextList:[]});var m=t(5256),f=t(97202);let h=(0,i.createContext)({esComponent:f.Es.UiInfra,errorBoundaryId:"__default"});function E(){return(0,i.useContext)(h)}let v=(0,i.createContext)({UNSAFE_logErrorInPanelBoundary:()=>{}});function y(e,r){let t=(0,i.useRef)([]),{esComponent:n,errorBoundaryId:o}=E();return(0,i.useCallback)((i,a)=>{let s=Object.keys(a),l=Object.keys(i).filter(e=>s.includes(e)&&!t.current.includes(e));l.length>0&&(t.current.push(...l),m.iT.sev2(l.some(e=>"esComponent"===e)?f.Es.UiObservability:n,r,`Error boundary: ${o}, record event context chain: ${e.join(",")}, duplicate tags: ${l.join(",")}. Please follow go/recordeventduplicatetags to resolve.
Call stack: ${Error().stack}`,!0))},[e,r,n,o])}let b=Symbol("NOT_INITIALIZED");var x=t(86403),S=t(63147);let T="rit_comp_id";var I=function(e){return e.INITIAL_LOAD="INITIAL_LOAD",e.NAVIGATION="NAVIGATION",e.INTERACTION="INTERACTION",e.MEASUREMENT="MEASUREMENT",e.PANEL_BOUNDARY="PANEL_BOUNDARY",e.WINDOW_ON_ERROR="WINDOW_ON_ERROR",e}({}),_=t(74517);function A(e){switch(e.entityType){case"page":return{type:_.jZ.EntityType_Type.PAGE,sub_type:void 0,entity_id:e.entityId,entity_view_id:e.entityViewId};case"component":return{type:_.jZ.EntityType_Type.COMPONENT,sub_type:function(e){switch(e){case"accordion":return _.jZ.EntitySubType_Type.ACCORDION;case"alert":return _.jZ.EntitySubType_Type.ALERT;case"banner":return _.jZ.EntitySubType_Type.BANNER;case"button":return _.jZ.EntitySubType_Type.BUTTON;case"card":return _.jZ.EntitySubType_Type.CARD;case"checkbox":return _.jZ.EntitySubType_Type.CHECKBOX;case"context_menu_checkbox_item":return _.jZ.EntitySubType_Type.CONTEXT_MENU_CHECKBOX_ITEM;case"context_menu_item":return _.jZ.EntitySubType_Type.CONTEXT_MENU_ITEM;case"context_menu_radio_group":return _.jZ.EntitySubType_Type.CONTEXT_MENU_RADIO_GROUP;case"dialog_combobox":return _.jZ.EntitySubType_Type.DIALOG_COMBOBOX;case"div":return _.jZ.EntitySubType_Type.DIV;case"drawer_content":return _.jZ.EntitySubType_Type.DRAWER_CONTENT;case"dropdown_menu_checkbox_item":return _.jZ.EntitySubType_Type.DROPDOWN_MENU_CHECKBOX_ITEM;case"dropdown_menu_item":return _.jZ.EntitySubType_Type.DROPDOWN_MENU_ITEM;case"dropdown_menu_radio_group":return _.jZ.EntitySubType_Type.DROPDOWN_MENU_RADIO_GROUP;case"file_input":return _.jZ.EntitySubType_Type.FILE_INPUT;case"form":return _.jZ.EntitySubType_Type.FORM;case"input":return _.jZ.EntitySubType_Type.INPUT;case"legacy_select":return _.jZ.EntitySubType_Type.LEGACY_SELECT;case"link":return _.jZ.EntitySubType_Type.LINK;case"listbox":return _.jZ.EntitySubType_Type.LISTBOX;case"modal":return _.jZ.EntitySubType_Type.MODAL;case"notification":return _.jZ.EntitySubType_Type.NOTIFICATION;case"pagination":return _.jZ.EntitySubType_Type.PAGINATION;case"pill_control":return _.jZ.EntitySubType_Type.PILL_CONTROL;case"popover":return _.jZ.EntitySubType_Type.POPOVER;case"preview_card":return _.jZ.EntitySubType_Type.PREVIEW_CARD;case"radio":return _.jZ.EntitySubType_Type.RADIO;case"radio_group":return _.jZ.EntitySubType_Type.RADIO_GROUP;case"react_select":return _.jZ.EntitySubType_Type.REACT_SELECT;case"segmented_control_group":return _.jZ.EntitySubType_Type.SEGMENTED_CONTROL_GROUP;case"simple_select":return _.jZ.EntitySubType_Type.SIMPLE_SELECT;case"switch":return _.jZ.EntitySubType_Type.SWITCH;case"table_header":return _.jZ.EntitySubType_Type.TABLE_HEADER;case"tabs":return _.jZ.EntitySubType_Type.TABS;case"tag":return _.jZ.EntitySubType_Type.TAG;case"text_area":return _.jZ.EntitySubType_Type.TEXT_AREA;case"toggle_button":return _.jZ.EntitySubType_Type.TOGGLE_BUTTON;case"tooltip":return _.jZ.EntitySubType_Type.TOOLTIP;case"typeahead_combobox":return _.jZ.EntitySubType_Type.TYPEAHEAD_COMBOBOX;case"typography_link":return _.jZ.EntitySubType_Type.TYPOGRAPHY_LINK}}(e.entitySubType),entity_id:e.entityId,entity_view_id:e.entityViewId};case"interaction":return{type:_.jZ.EntityType_Type.INTERACTION,sub_type:function(e){switch(e){case I.INITIAL_LOAD:return _.jZ.EntitySubType_Type.INITIAL_LOAD;case I.NAVIGATION:return _.jZ.EntitySubType_Type.NAVIGATION;case I.INTERACTION:return _.jZ.EntitySubType_Type.INTERACTION;case I.MEASUREMENT:return _.jZ.EntitySubType_Type.MEASUREMENT;case I.PANEL_BOUNDARY:return _.jZ.EntitySubType_Type.PANEL_BOUNDARY;case I.WINDOW_ON_ERROR:return _.jZ.EntitySubType_Type.WINDOW_ON_ERROR}}(e.entitySubType),entity_id:e.entityId}}}function R(e){return void 0!==e.valueBoolean?{value_boolean:e.valueBoolean}:void 0!==e.valueString?{value_string:e.valueString}:void 0!==e.valueNumber?{value_number:e.valueNumber}:void 0!==e.valueFiles?{value_multi_file_metadata:{file_metadata_list:e.valueFiles.map(e=>({mime_type:e.type,byte_size:e.size}))}}:{}}let w=new Set(["clusterLogDestination","availabilityZone","availability","clusterLogRegion","virtualClusterSize","performanceMode","manualModeEnableAutoscaling","autoterminationEnabled","autoModeSparkVersion","manualModeSparkVersion","runtimeEngine","nodeTypeId","driverNodeTypeId","instancePoolId","driverInstancePoolId","numWorkers","minWorkers","maxWorkers","autoterminationMinutes","dataSecurityMode","useMlRuntime","singleNode","useDocker","ebsVolumeType","ebsVolumeCount","ebsVolumeSize","localSsdCount"]),N=new Set(["language"]),Y={SimpleClusterCreateForm:w,SimpleClusterEditForm:w,"lakeflow.create-pipeline-landing-page.create-single-file-pipeline":N,"lakeflow.create-pipeline-landing-page.create-pipeline-templates":N};function C(e){switch(typeof e){case"boolean":return{value_boolean:e};case"number":return{value_number:e};case"string":return{value_string:e};default:return}}function M(e){var r,t,n,o,i,a,s,l;let c={...e.customContext,interactionSubject:e.eventPayload.interactionSubject,rootInteractionId:e.eventPayload.rootInteractionId,interactionId:e.eventPayload.interactionId,eventType:e.eventType,eventClientSource:e.eventClientSource,entityType:e.eventEntity.entityType,entitySubType:e.eventEntity.entitySubType,entityId:e.eventEntity.entityId};switch(e.eventType){case"page_view":{let{productEntityChain:r,urlParams:t,...n}=e.eventPayload,o=null==r?void 0:r.map(e=>`${e.type}:${e.id}`).join(",");return{...c,pageId:e.eventEntity.entityId,productEntityChain:o,...n,...t}}case"page_clipboard_cut":return{...c,referrerComponentType:null==(r=e.eventPayload.referrerEntity)?void 0:r.entitySubType,referrerComponentId:null==(t=e.eventPayload.referrerEntity)?void 0:t.entityId};case"page_clipboard_copy":return{...c,referrerComponentType:null==(n=e.eventPayload.referrerEntity)?void 0:n.entitySubType,referrerComponentId:null==(o=e.eventPayload.referrerEntity)?void 0:o.entityId};case"page_clipboard_paste":return{...c,referrerComponentType:null==(i=e.eventPayload.referrerEntity)?void 0:i.entitySubType,referrerComponentId:null==(a=e.eventPayload.referrerEntity)?void 0:a.entityId};case"component_click":case"component_view":case"component_zoom":return{...c,componentType:e.eventEntity.entitySubType,componentId:e.eventEntity.entityId};case"component_value_change":return{...c,componentType:e.eventEntity.entitySubType,componentId:e.eventEntity.entityId,valueChangeEventValueBoolean:e.eventPayload.valueBoolean,valueChangeEventValueString:e.eventPayload.valueString,valueChangeEventValueNumber:e.eventPayload.valueNumber};case"form_submit":return{...c,referrerComponentType:null==(s=e.eventPayload.submissionTriggerEntity)?void 0:s.entitySubType,referrerComponentId:null==(l=e.eventPayload.submissionTriggerEntity)?void 0:l.entityId};case"interaction_phase":return{...c,interactionPhaseName:e.eventPayload.interactionPhaseName,interactionPhaseStatus:e.eventPayload.interactionPhaseStatus,interactionPhaseType:e.eventPayload.interactionPhaseType}}}function D(e){return{type:function(e){switch(e){case"page_view":return _.jZ.EventType_Type.PAGE_VIEW;case"page_clipboard_cut":return _.jZ.EventType_Type.CLIPBOARD_CUT;case"page_clipboard_copy":return _.jZ.EventType_Type.CLIPBOARD_COPY;case"page_clipboard_paste":return _.jZ.EventType_Type.CLIPBOARD_PASTE;case"component_click":return _.jZ.EventType_Type.COMPONENT_CLICK;case"component_value_change":return _.jZ.EventType_Type.COMPONENT_VALUE_CHANGE;case"component_view":return _.jZ.EventType_Type.COMPONENT_VIEW;case"component_zoom":return _.jZ.EventType_Type.COMPONENT_ZOOM;case"interaction_phase":return _.jZ.EventType_Type.INTERACTION_PHASE;case"form_submit":return _.jZ.EventType_Type.FORM_SUBMIT}}(e.eventType),client_source:function(e){switch(e){case"adhoc":case"dropzone":return _.jZ.EventClientSource_Type.ADHOC;case"design_system":return _.jZ.EventClientSource_Type.DESIGN_SYSTEM;case"legacy_router":return _.jZ.EventClientSource_Type.LEGACY_ROUTER;case"react_interaction_tracing":return _.jZ.EventClientSource_Type.REACT_INTERACTION_TRACING;case"unified_router":return _.jZ.EventClientSource_Type.UNIFIED_ROUTER;case"error_logging":return _.jZ.EventClientSource_Type.ERROR_LOGGING}}(e.eventClientSource),entity:A(e.eventEntity),payload:(()=>{var r,t,n,o,i,a,s,l,c,d,u,p,g,m,f,h,E,v,y,b,x;let S={interaction_subject:e.eventPayload.interactionSubject,interaction_id:e.eventPayload.interactionId,root_interaction_id:e.eventPayload.rootInteractionId,parent_id:null==(r=e.eventPayload.interactionId)?void 0:r.slice(0,16)};switch(e.eventType){case"page_view":let{utmSourceUrlParam:T,utmMediumUrlParam:I,utmCampaignUrlParam:w,utmAdGroupUrlParam:N,utmContentUrlParam:M,utmOfferUrlParam:D,utmAdUrlParam:O,sisuIntentUrlParam:k,itmDataUrlParam:L,scidUrlParam:P,sisuDbxSourceUrlParam:U,sisuRlAidUrlParam:F,sisuGclidUrlParam:B,sisuMsclkidUrlParam:W,sisuFblidUrlParam:j,sisuLiFatIdUrlParam:z,sisuTwclidUrlParam:G,sisuRdtCidUrlParam:$,fullscreenWidgetUrlParam:K,...H}=null!=(x=e.eventPayload.urlParams)?x:{},V={utm_source:null==(t=e.eventPayload.urlParams)?void 0:t.utmSourceUrlParam,utm_medium:null==(n=e.eventPayload.urlParams)?void 0:n.utmMediumUrlParam,utm_campaign:null==(o=e.eventPayload.urlParams)?void 0:o.utmCampaignUrlParam,utm_ad_group:null==(i=e.eventPayload.urlParams)?void 0:i.utmAdGroupUrlParam,utm_content:null==(a=e.eventPayload.urlParams)?void 0:a.utmContentUrlParam,utm_offer:null==(s=e.eventPayload.urlParams)?void 0:s.utmOfferUrlParam,utm_ad_url:null==(l=e.eventPayload.urlParams)?void 0:l.utmAdUrlParam,sisu_intent:null==(c=e.eventPayload.urlParams)?void 0:c.sisuIntentUrlParam,itm_data:null==(d=e.eventPayload.urlParams)?void 0:d.itmDataUrlParam,scid:null==(u=e.eventPayload.urlParams)?void 0:u.scidUrlParam,sisu_dbx_source:null==(p=e.eventPayload.urlParams)?void 0:p.sisuDbxSourceUrlParam,sisu_rl_aid:null==(g=e.eventPayload.urlParams)?void 0:g.sisuRlAidUrlParam,sisu_gclid:null==(m=e.eventPayload.urlParams)?void 0:m.sisuGclidUrlParam,sisu_msclkid:null==(f=e.eventPayload.urlParams)?void 0:f.sisuMsclkidUrlParam,sisu_fbclid:null==(h=e.eventPayload.urlParams)?void 0:h.sisuFblidUrlParam,sisu_li_fat_id:null==(E=e.eventPayload.urlParams)?void 0:E.sisuLiFatIdUrlParam,sisu_twclid:null==(v=e.eventPayload.urlParams)?void 0:v.sisuTwclidUrlParam,sisu_rdt_cid:null==(y=e.eventPayload.urlParams)?void 0:y.sisuRdtCidUrlParam,fullscreen_widget:null==(b=e.eventPayload.urlParams)?void 0:b.fullscreenWidgetUrlParam,...H};return{...S,page_view_payload:{referrer_component_id:e.eventPayload.referrerComponentId,browser_screen_height:e.eventPayload.browserScreenHeight,browser_screen_width:e.eventPayload.browserScreenWidth,url_params:Object.values(V).some(e=>void 0!==e)?V:void 0}};case"page_clipboard_cut":return{...S,clipboard_cut_payload:{referrer_entity:e.eventPayload.referrerEntity?A(e.eventPayload.referrerEntity):void 0}};case"page_clipboard_copy":return{...S,clipboard_copy_payload:{referrer_entity:e.eventPayload.referrerEntity?A(e.eventPayload.referrerEntity):void 0}};case"page_clipboard_paste":return{...S,clipboard_paste_payload:{referrer_entity:e.eventPayload.referrerEntity?A(e.eventPayload.referrerEntity):void 0}};case"component_click":case"component_zoom":return S;case"component_value_change":let Z=R(e.eventPayload);return{...S,component_value_change_payload:{...Z,value_payload:Z}};case"component_view":{let r=R(e.eventPayload);return{...S,component_view_payload:{value_payload:r}}}case"form_submit":return{...S,form_submit_payload:{submission_trigger_entity:e.eventPayload.submissionTriggerEntity?A(e.eventPayload.submissionTriggerEntity):void 0,form_property_values:function(e,r,t){if(void 0===r&&void 0===t||void 0===e||!Y[e])return;let n={};return Y[e].forEach(e=>{let o=null==r?void 0:r[e],i=null==t?void 0:t[e];(void 0!==o||void 0!==i)&&(n[e]={initial_value:C(o),final_value:C(i)})}),n}(e.eventEntity.entityId,e.eventPayload.initialPropertyValues,e.eventPayload.finalPropertyValues)}};case"interaction_phase":let q=function(e){switch(e){case"start":return _.jZ.InteractionPhaseType_Type.START;case"in_progress":return _.jZ.InteractionPhaseType_Type.IN_PROGRESS;case"complete":return _.jZ.InteractionPhaseType_Type.COMPLETE}}(e.eventPayload.interactionPhaseType);return{...S,interaction_phase_payload:{name:e.eventPayload.interactionPhaseName,type:q,status:function(e){switch(e){case"success":return _.jZ.Status_Type.SUCCESS;case"failure":return _.jZ.Status_Type.FAILURE;case"cancelled":return _.jZ.Status_Type.CANCELLED;case"interrupted":return _.jZ.Status_Type.INTERRUPTED;case"timed_out":return _.jZ.Status_Type.TIMED_OUT}}(e.eventPayload.interactionPhaseStatus),duration_millis:q===_.jZ.InteractionPhaseType_Type.COMPLETE&&e.eventPayload.duration?Math.round(10*e.eventPayload.duration)/10:void 0,exception:e.eventPayload.exception,exception_metadata:e.eventPayload.exceptionMetadata,causes:e.eventPayload.causes}}}})(),custom_context:e.customContextProto}}function O(e,r,t){k(e,r,{...t,eventClientSource:"adhoc"})}function k(e,r,t){if((0,d.W)("databricks.fe.observability.recordProtoBeforeEvent",!0)){r&&r({observability_log:D(t)}),e("uiAnalyticsEvent",M(t));return}e("uiAnalyticsEvent",M(t)),r&&r({observability_log:D(t)})}let L=new WeakMap,P=null;function U(e){if("nativeEvent"in e)return e.nativeEvent;return e}let F={onClick:"component_click",onSubmit:"form_submit",onValueChange:"component_value_change",onView:"component_view"},B=e=>{let{recordEvent:r,recordProto:t,startInteraction:n}=e;return(0,i.useCallback)(e=>{let{eventType:o,componentType:i,componentId:a,componentSubType:s,value:l,shouldStartInteraction:c,event:d,mode:u,referrerComponent:p,isInteractionSubject:g,formPropertyValues:h,componentViewId:E}=e,v=null,y=F[o],b=function(e,r,t){return{interactionName:`${T}:${e}:component:${r}:${t}`,componentType:r,componentId:t}}(y,i,a),x=null;if((null==d?void 0:d.defaultPrevented)&&"form_submit"!==y||"skip"===u)return;if(c){let e=!0;if("form_submit"===y){let r=d?L.get(U(d))||null:void 0;e=!r;let t=(r=null!=r?r:P?L.get(P):null)?function(e){if(!e.startsWith(`${T}:`))return null;return{interactionName:e,componentType:e.split(":")[3],componentId:e.split(":")[4]}}(r.name):null;r&&t&&("button"===t.componentType||"dropdown_menu_item"===t.componentType)&&(x=r,p||(p={id:t.componentId,type:t.componentType}))}x||(x=n(b.interactionName,void 0,void 0,void 0,{isInteractionSubject:!1})),e&&x&&d&&function(e,r){if(!r)return m.iT.sev2(f.Es.UiInfra,"Experimental: set-interaction-for-event-with-null",Error("cannot set null interaction for event"));let t=U(e);if(L.has(t)){var n;m.iT.sev2(f.Es.UiObservability,"Experimental: event-has-interaction-associated-already",{eventType:t.type,existing:null==(n=L.get(t))?void 0:n.name,new:null==r?void 0:r.name,stack:Error().stack})}P=t,L.set(t,r),queueMicrotask(()=>{t===P&&(P=null)})}(d,x)}if("associate_event_only"===u)return;switch(y){case"component_click":v={eventType:y,eventClientSource:"design_system",eventEntity:{entityType:"component",entitySubType:i,entityId:a,entityViewId:E},eventPayload:{interactionSubject:null==g||g,interactionId:null==x?void 0:x.id,rootInteractionId:null==x?void 0:x.rootInteractionId}};break;case"form_submit":v={eventType:y,eventClientSource:"design_system",eventEntity:{entityType:"component",entitySubType:i,entityId:a},eventPayload:{interactionSubject:!0,interactionId:null==x?void 0:x.id,rootInteractionId:null==x?void 0:x.rootInteractionId,submissionTriggerEntity:p?{entityType:"component",entitySubType:p.type,entityId:p.id}:void 0,initialPropertyValues:null==h?void 0:h.initial,finalPropertyValues:null==h?void 0:h.final}};break;case"component_value_change":v={eventType:y,eventClientSource:"design_system",eventEntity:{entityType:"component",entitySubType:i,entityId:a,entityViewId:E},eventPayload:{interactionSubject:!0,valueBoolean:"boolean"==typeof l?l:void 0,valueString:"string"==typeof l?l:void 0,valueNumber:"number"==typeof l?l:void 0}};break;case"component_view":if(v={eventType:y,eventClientSource:"design_system",eventEntity:{entityType:"component",entitySubType:i,entityId:a,entityViewId:E},eventPayload:{interactionSubject:!0,valueBoolean:"boolean"==typeof l?l:void 0,valueString:"string"==typeof l?l:void 0,valueNumber:"number"==typeof l?l:void 0}},[S.v_.Alert,S.v_.Banner,S.v_.Notification].includes(i)&&s===S.NI.Error){let e=`Experimental: DuBois-${i} High Erroring Rate`;r(m.CW,{eventId:e},`Experimental: DuBois-${i} component being viewed at a high rate on ${a}`)}}v?k(r,t,v):m.iT.sev2(f.Es.UiObservability,"InternalDesignSystemEventProvider/UnknownEventType",{eventType:o,componentType:i,componentId:a})},[r,t,n])},W=Symbol();function j(e,r,t){let n,o=function(){for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];if(void 0===n&&(n=e()),!n)return r(...i);return t(...i)};return o[W]=function(){n=void 0},o}var z=t(90609),G=t(31280);function $(e,r,t,n){if(t&&e(null!=t?t:{},r),t&&n){let e=Object.keys(t),r=Object.keys(n);p()(0===e.filter(e=>r.includes(e)).length,`Cannot specify a tag in both the tags and as override. Tags: ${e.join(",")}, overrides: ${r.join(",")}`)}return t||n?{...r,...t,...n}:r}let K={};function H(){let{tags:e,contextChain:r}=(0,i.useContext)(g),t=y(r,"DuplicateRecordEventInvocationTag"),n=(0,i.useCallback)((r,n)=>$(t,e,r,n),[t,e]);return{contextTags:e,mergeTags:n}}function V(){let e=function(){let{mergeTags:e}=H();return(0,i.useCallback)(r=>{let{metric:t,tags:n,overrides:o,eventData:i}=r,a=e(n,o);(0,G.y)(t,a,i)},[e])}();return(0,i.useCallback)((r,t,n)=>e({metric:r,tags:t,eventData:n}),[e])}var Z=t(25656),q=t.n(Z),J=function(e){return e.GLOBAL="global",e.WEBAPP_APP_ROOT="webapp_app_root",e.WEBAPP_LOGIN_ROOT="webapp_login_root",e.WEBAPP_REACT_ROOT="webapp_react_root",e.PLATFORM_ROUTER_PAGE_VIEW="platform_router_page_view",e.PLATFORM_ROUTER_PAGE_ID="platform_router_page_id",e.SCHEMA_BROWSER_OPTIONS="schema_browser_options",e.SCHEMA_BROWSER_LOCATION_ID="schema_browser_location_id",e.SCHEMA_BROWSER_PANEL_ID="schema_browser_panel_id",e.SCHEMA_BROWSER_TREE_ID="schema_browser_tree_id",e.SEARCH_PAGE="search_page",e.NAVIGATIONAL_SEARCH_BAR="navigational_search_bar",e.INGESTION_CONNECTIONS_MODAL_ID="ingestion_connections_modal_id",e.INGESTION_CREATE_TABLE_VOLUME="ingestion_create_table_volume",e.INGESTION_CREATE_OR_MODIFY_TABLE_PAGE_ID="ingestion_create_or_modify_table_page_id",e.INGESTION_CREATE_OR_MODIFY_TABLE_ID="ingestion_create_or_modify_table_id",e.INGESTION_CREATE_TABLE_EXTERNAL_LOCATIONS_PAGE_ID="ingestion_create_table_external_locations_page_id",e.INGESTION_CREATE_TABLE_EXTERNAL_LOCATIONS_ID="ingestion_create_table_external_locations_id",e.INGESTION_NEW_PIPELINE_PAGE_ID="ingestion_new_pipeline_page_id",e.INGESTION_PREVIEW_TABLE_ID="ingestion_preview_table_id",e.INGESTION_FILE_UPLOADER_ID="ingestion_file_uploader_id",e.INGESTION_VOLUME_UPLOAD_ID="ingestion_volume_upload_id",e.INGESTION_ADD_DATA_PAGE_ID="ingestion_add_data_page_id",e.INGESTION_QUERY_SOURCE_ALERTS_ID="ingestion_query_source_alerts_id",e.INGESTION_SETUP_WIZARD_ID="ingestion_setup_wizard_id",e.INGESTION_DRAWER_ID="ingestion_drawer_id",e.DATA_EXPLORER_UI="data_explorer_ui",e.SQL_EDITOR_TAB_ID="sql_editor_tab_id",e.SQL_EDITOR_TABS_COUNT_ID="sql_editor_tabs_count_id",e.SISU_APP_ROOT="sisu_app_root",e.ANALYTICS_CONTAINER="analytics_container",e.PRODUCT_ENTITY_CONTAINER="product_entity_container",e.PANEL_BOUNDARY="panel_boundary",e.ACCOUNTS_CONSOLE_LOGIN_ROOT="accounts_console_login_root",e.BILLING_UPGRADE_MODAL="billing_upgrade_modal",e.FEATURE_PREVIEW_PAGE_ID="feature_preview_page_id",e.WEBAPP_DARK_MODE_PROMPT_MODAL="webapp_dark_mode_prompt_modal",e.ASSET_LIST_ITEM="homepage_asset_list_item",e.BROWSE_ASSET_SELECTOR="browse_asset_selector",e.BROWSE_ASSET_SELECTOR_SECTION="browse_asset_selector_section",e.BROWSE_ASSET_SELECTOR_SUBSECTION="browse_asset_selector_subsection",e.BROWSE_FAVORITES_TABLE="browse_favorite_table",e.BROWSE_POPULAR_TABLE="browse_popular_table",e.ACCOUNTS_CONSOLE_CREATE_WORKSPACE_MODAL="accounts_console_create_workspace_modal",e.DATA_SHARING="data_sharing",e.AI_PLAYGROUND="ai_playground",e.UI_DEPLOYABLE="ui_deployable",e.WAREHOUSE_UI_MONITORING_TAB="warehouse_ui_monitoring_tab",e.ASSISTANT_QUICKFIX="assistant_quickfix",e.PIPELINE_CONTEXT="pipeline_context",e.MLFLOW_CONTEXT="mlflow_context",e.ALERT_UTILS="alert_utils",e.DISCOVER_PAGE_ITEM="discover_page_item",e}({});let X={DUMMY_TEST_CONTEXT:["context.server_context.client_ip"],[J.ANALYTICS_CONTAINER]:["context.analytics_context.analytics_container_context","context.client_context.context_error_boundary_id","context.client_context.es_component"],[J.PLATFORM_ROUTER_PAGE_ID]:["context.client_context.page_id","context.client_context.page_info_context.record_event_context_page_id"],[J.PLATFORM_ROUTER_PAGE_VIEW]:["context.client_context.page_view_id","context.client_context.page_info_context.record_event_context_page_view_id"],[J.PRODUCT_ENTITY_CONTAINER]:["context.analytics_context.product_entity_context"]},Q=void 0,ee=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=new Set;return Object.keys(e).forEach(n=>{let o=[...r,n].join(".");"object"==typeof e[n]&&null!==e[n]?ee(e[n],[...r,n]).forEach(e=>t.add(e)):t.add(o)}),t},er=(e,r)=>{var t,n;return null!=(n=null==(t=X[e])?void 0:t.some(e=>r.startsWith(e)))&&n};function et(e,r,t,n,o){let i=ee(e),a=new Set,s=new Set,l=r.map(r=>{let t=r.recordProtoContextFunc(e);return{id:r.id,result:t,paths:ee(t)}});l.forEach(e=>{let{paths:r,id:t}=e;r.forEach(e=>{er(t,e)&&i.has(e)&&s.add(e)})});let c=q().merge(e,...l.map(e=>e.result));return l.forEach(e=>{let{id:r,paths:t}=e;t.forEach(e=>{i.has(e)?er(r,e)||a.add(e):i.add(e)})}),s.size>0&&(0,d.W)("databricks.fe.observability.protoContextualAlerts",!1)&&m.iT.sev2(f.Es.UiObservability,"experimental-AllowlistedRecordProtoPropertyViolation",`Error boundary: ${n}, record event context chain: ${o.join(",")}, allowlisted properties modified by main object: ${[...s].join(",")}. Please follow go/recordprotoallowlistviolation to resolve.
Call stack: ${Error().stack}`,!0),a.delete("context.client_context.page_info_context.active_record_event_context_id"),a.size>0&&(0,d.W)("databricks.fe.observability.protoContextualAlerts",!1)&&m.iT.sev2(f.Es.UiObservability,"experimental-DuplicateRecordProtoProperty",`Error boundary: ${n}, record event context chain: ${o.join(",")}, duplicate proto properties: ${[...a].join(",")}. Please follow go/recordprotoduplicateproperties to resolve.
Call stack: ${Error().stack}`,!0),c}function en(){let{esComponent:e,errorBoundaryId:r}=E(),{contextList:t,contextChain:n}=(0,i.useContext)(g);return(0,i.useCallback)(o=>(0,z.F)(t.length>0?et({entry:o},t,e,r,n):{entry:o}),[n,r,e,t])}function eo(){let{esComponent:e,errorBoundaryId:r}=E(),{contextList:t,contextChain:n}=(0,i.useContext)(g),o=(0,i.useRef)(Q);return(0,i.useLayoutEffect)(()=>{o.current=t},[t]),(0,i.useCallback)(t=>{(0,z.F)(o.current?et({entry:t},o.current,e,r,n):{entry:t})},[n,r,e])}let ei=a().createContext({getCurrentInteraction:()=>null,startInteraction:()=>null}),ea=j(()=>null!=n?n:(0,d.W)("databricks.fe.observability.enableInteractionPhaseUseRecordProtoFn",!0),()=>z.w,en),es=j(()=>null!=n?n:(0,d.W)("databricks.fe.observability.enableInteractionPhaseUseRecordProtoFn",!0),()=>z.w,eo);function el(e){let{children:r}=e,t=function(){let{tags:e,contextChain:r}=(0,i.useContext)(g),t=y(r,"DuplicateRecordEventInvocationTag"),n=(0,i.useRef)(K);(0,i.useLayoutEffect)(()=>{n.current=e},[e]);let o=(0,i.useCallback)((e,r)=>(p()(n.current!==K,"mergeTagsStable called before layout effects ran. mergeTagsStable should only be called in response to user actions or in useEffect."),$(t,n.current,e,r)),[t]);return(0,i.useCallback)((e,r,t)=>{let n=o(r);(0,G.y)(e,n,t)},[o])}(),n=eo(),{startInteraction:a}=function(){let{esComponent:e,errorBoundaryId:r}=E(),{mergeTags:t}=function(){let{tags:e,contextChain:r}=(0,i.useContext)(g),t=y(r,"DuplicateRecordEventInvocationTag"),n=(0,i.useRef)(K);return(0,i.useLayoutEffect)(()=>{n.current=e},[e]),{mergeTags:(0,i.useCallback)((e,r)=>(p()(n.current!==K,"mergeTagsStable called before layout effects ran. mergeTagsStable should only be called in response to user actions or in useEffect."),$(t,n.current,e,r)),[t])}}(),n=(0,i.useContext)(ei),o=n.startInteraction,a=es(),s=(0,i.useCallback)((n,i,s,l,c)=>o(n,i,s,t({errorBoundaryId:r},{...l,esComponent:e}),c?{...c,useRecordProtoFn:a}:{useRecordProtoFn:a}),[t,e,o,r,a]);return(0,i.useMemo)(()=>({...n,startInteraction:s}),[n,s])}(),s=B({recordEvent:t,recordProto:n,startInteraction:a});return(0,o.Y)(S.zI,{callback:s,children:r})}function ec(e){let{tags:r,id:t,context:n,children:i}=e;return(0,o.Y)(eu,{tags:r,id:t,context:n,override:!1,children:i})}let ed=()=>({});function eu(e){let{tags:r,id:t,context:n=ed,children:a,override:s}=e,{contextChain:l,tags:c,contextList:d}=(0,i.useContext)(g),u=(0,i.useMemo)(()=>[...l,t],[t,l]),m=function(){let e=(0,i.useRef)(b);if(e.current===b){let r=x.n.generateUuidV4();return e.current=r,r}return e.current}(),f=(0,i.useRef)(0),h=(0,i.useMemo)(()=>{f.current+=1;let e=`${m}:${f.current}`;return{tags:{...c,...r,activeRecordEventContextId:e},contextChain:u,contextList:[...d,{recordProtoContextFunc:r=>{var t,o,i;let a=n(r);return{...a,context:{...a.context,client_context:{...null==(t=a.context)?void 0:t.client_context,page_info_context:{...null==(i=a.context)||null==(o=i.client_context)?void 0:o.page_info_context,active_record_event_context_id:e}}}}},id:t}]}},[c,r,u,d,n,t,m,f]),E=y(u,"DuplicateRecordEventContextTag"),{activeRecordEventContextId:v,...S}=c;return(0,i.useEffect)(()=>{s||E(r,S)},[s,E,S,r]),p()(s||!l.includes(t),`Record event context ${t} cannot be redefined in the current chain ${u.join(",")}`),(0,o.Y)(g.Provider,{value:h,children:(0,o.Y)(el,{children:a})})}let ep="mlflow.trace_schema.version",eg="response",em="trace";var ef=function(e){return e.LLM="LLM",e.CHAIN="CHAIN",e.AGENT="AGENT",e.TOOL="TOOL",e.FUNCTION="FUNCTION",e.CHAT_MODEL="CHAT_MODEL",e.RETRIEVER="RETRIEVER",e.PARSER="PARSER",e.EMBEDDING="EMBEDDING",e.RERANKER="RERANKER",e.UNKNOWN="UNKNOWN",e}({}),eh=function(e){return e.MODELS="models",e.DOCUMENT="document",e.CONNECT="connect",e.SEARCH="search",e.SORT="sort",e.UNKNOWN="unknown",e.FUNCTION="function",e.CODE="code",e.NUMBERS="numbers",e.WRENCH="wrench",e.AGENT="agent",e.CHAIN="chain",e.USER="user",e.SYSTEM="system",e}({}),eE=function(e){return e.LLM="LLM",e.CHAIN="CHAIN",e.AGENT="AGENT",e.TOOL="TOOL",e.CHAT_MODEL="CHAT_MODEL",e.RETRIEVER="RETRIEVER",e.PARSER="PARSER",e.EMBEDDING="EMBEDDING",e.RERANKER="RERANKER",e.UNKNOWN="UNKNOWN",e}({}),ev=function(e){return e.JSON="json",e.TEXT="text",e.MARKDOWN="markdown",e}({}),ey=t(1378),eb=t(75057),ex=t(90710),eS=t(52779),eT=t(63096),eI=t(59718),e_=t(72020),eA=t(18134),eR=t(26571),ew=t(30103),eN=t(90833),eY=t(57959),eC=t(79305),eM=t(13433);let eD=e=>{let r,{type:t=eh.CONNECT,isInTooltip:n=!1,hasException:i=!1,isRootSpan:a=!1}=e,{theme:l}=(0,s.wn)();a?r="ai":i&&(r="danger");let c={[eh.MODELS]:(0,o.Y)(ey.A,{color:r}),[eh.DOCUMENT]:(0,o.Y)(eb.A,{color:r}),[eh.CONNECT]:(0,o.Y)(ex.A,{color:r}),[eh.CODE]:(0,o.Y)(eS.A,{color:r}),[eh.FUNCTION]:(0,o.Y)(eT.A,{color:r}),[eh.NUMBERS]:(0,o.Y)(eI.A,{color:r}),[eh.SEARCH]:(0,o.Y)(e_.A,{color:r}),[eh.SORT]:(0,o.Y)(eA.A,{color:r}),[eh.UNKNOWN]:(0,o.Y)(eR.A,{color:r}),[eh.WRENCH]:(0,o.Y)(ew.A,{color:r}),[eh.AGENT]:(0,o.Y)(eN.A,{color:r}),[eh.CHAIN]:(0,o.Y)(eY.A,{color:r}),[eh.USER]:(0,o.Y)(eC.A,{color:r}),[eh.SYSTEM]:(0,o.Y)(eM.A,{color:r})},d=l.colors.actionDefaultIconDefault,u=l.colors.actionPrimaryIcon,p=l.colors.backgroundSecondary;switch(t){case eh.SEARCH:d=l.colors.textValidationSuccess,u=l.colors.green500,p=l.isDarkMode?l.colors.green800:l.colors.green100;break;case eh.MODELS:d=l.isDarkMode?l.colors.blue500:l.colors.turquoise,u=l.isDarkMode?l.colors.turquoise:l.colors.blue500,p=l.isDarkMode?l.colors.blue800:l.colors.blue100;break;case eh.WRENCH:d=l.isDarkMode?l.colors.red500:l.colors.red700,u=l.isDarkMode?l.colors.red700:l.colors.red500,p=l.isDarkMode?l.colors.red800:l.colors.red100}return(0,o.FD)("div",{css:{position:"relative",width:l.general.iconSize,height:l.general.iconSize,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:l.borders.borderRadiusSm,background:n?l.colors.tooltipBackgroundTooltip:p,color:n?u:d,svg:{width:l.general.iconFontSize,height:l.general.iconFontSize},flexShrink:0},children:[i&&(0,o.Y)("div",{css:{position:"absolute",top:-l.spacing.xs,right:-l.spacing.xs,height:l.spacing.sm,width:l.spacing.sm,borderRadius:l.borders.borderRadiusSm,backgroundColor:l.colors.actionDangerPrimaryBackgroundDefault,zIndex:5}}),c[t]]})};function eO(e){switch(e){case ef.LLM:return eh.MODELS;case ef.CHAIN:return eh.CHAIN;case ef.AGENT:return eh.AGENT;case ef.TOOL:return eh.WRENCH;case ef.CHAT_MODEL:return eh.MODELS;case ef.RETRIEVER:return eh.SEARCH;case ef.PARSER:return eh.CODE;case ef.EMBEDDING:return eh.NUMBERS;case ef.RERANKER:return eh.SORT;case ef.FUNCTION:return eh.FUNCTION;case ef.UNKNOWN:return eh.UNKNOWN;default:return eh.FUNCTION}}function ek(e){try{return JSON.parse(e)}catch(r){return e}}let eL=(e,r)=>{let t=e.events;if(!t)return[];let n=[];return t.forEach((t,o)=>{let i=t.attributes;if(!i)return;Object.keys(i).forEach(a=>{let s=a.toLowerCase().includes(r),l=e4(t.name,o,a);s&&n.push({span:e,section:"events",key:l,isKeyMatch:!0,matchIndex:0});let c=JSON.stringify(i[a]).toLowerCase().split(r).length-1;for(let r=0;r<c;r++)n.push({span:e,section:"events",key:l,isKeyMatch:!1,matchIndex:r})})}),n},eP=(e,r)=>{if(!r)return[];let t=[],n={inputs:null==e?void 0:e.inputs,outputs:null==e?void 0:e.outputs,attributes:null==e?void 0:e.attributes,events:null==e?void 0:e.events};return(0,Z.map)(n,(n,o)=>{if("events"===o)return void t.push(...eL(e,r));e1(n).forEach(n=>{n.key.toLowerCase().includes(r)&&t.push({span:e,section:o,key:n.key,isKeyMatch:!0,matchIndex:0});let i=n.value.toLowerCase().split(r).length-1;for(let r=0;r<i;r++)t.push({span:e,section:o,key:n.key,isKeyMatch:!1,matchIndex:r})})}),t},eU=(e,r,t)=>{var n,o;if(Array.isArray(e)&&e.every(ra))return(0,Z.compact)(e.map(rb));let i=null!=(n=rg(r))?n:[],a=null!=(o=rg(t))?o:[];if(0===i.length||0===a.length)return;return i.concat(a)},eF=(e,r)=>{var t;if(Array.isArray(e)&&e.every(rr))return e;if(Array.isArray(null==r?void 0:r.tools)&&(null==r||null==(t=r.tools)?void 0:t.every(rr)))return r.tools},eB=(e,r,t,n,i,a)=>{var s,l,c,d,u,p,g,m;let f=ek(null==(s=e.attributes)?void 0:s["mlflow.spanType"]),h=ek(null==(l=e.attributes)?void 0:l["mlflow.spanInputs"]),E=ek(null==(c=e.attributes)?void 0:c["mlflow.spanOutputs"]),v=eK(e),y=e$(e),b=null!=(p=i[y])?p:[];v||b.push(...null!=(g=i[""])?g:[]);let x=eU(ek(null==(d=e.attributes)?void 0:d["mlflow.chat.messages"]),h,E),S=eF(ek(null==(u=e.attributes)?void 0:u["mlflow.chat.tools"]),h),T=(0,Z.mapValues)((0,Z.omitBy)(e.attributes,(e,r)=>r.startsWith("mlflow.")),e=>ek(e)),I=e.events,_=(Number(eH(e))-r)/1e3,A=(Number(null!=(m=eV(e))?m:t)-r)/1e3;return{title:e.name,icon:(0,o.Y)(eD,{type:eO(f),hasException:e6(e)>0,isRootSpan:!v}),type:f,key:y,start:_,end:A,children:n,inputs:h,outputs:E,attributes:T,events:I,chatMessages:x,chatTools:S,parentId:v,assessments:b,traceId:a}},eW=e=>{let r=atob(e),t=r.length,n="";for(let e=0;e<t;e++)n+=r.charCodeAt(e).toString(16).padStart(2,"0");return n},ej=(e,r)=>{if(r)try{return eW(e)}catch(r){return e}if(e.startsWith("0x"))return e.slice(2);return e};function ez(e){return"trace_metadata"in e}function eG(e){return"start_time_unix_nano"in e}function e$(e){var r,t;return eG(e)?ej(e.span_id,!0):ej(null!=(t=null==(r=e.context)?void 0:r.span_id)?t:"",!1)}function eK(e){var r;return eG(e)?ej(e.parent_span_id,!0):ej(null!=(r=e.parent_id)?r:"",!1)}function eH(e){return eG(e)?Number(e.start_time_unix_nano):Number(e.start_time)}function eV(e){return eG(e)?Number(e.end_time_unix_nano):Number(e.end_time)}function eZ(e){var r;return ez(e.info)?e.info.trace_id:null!=(r=e.info.request_id)?r:""}let eq=e=>{let r=[];if(ez(e)){var t;r=null!=(t=e.assessments)?t:[]}else r=eJ(e.tags);let n=(0,Z.keyBy)(r,"assessment_id");Object.values(n).forEach(e=>{if(e.overrides){let r=n[e.overrides];e.overriddenAssessment=r}});let o=(r=Object.values(n)).reduce((e,r)=>{var t;let n=null!=(t=r.span_id)?t:"";return e[n]||(e[n]=[]),e[n].push(r),e},{});return Object.keys(o).forEach(e=>{o[e].sort((e,r)=>new Date(r.last_update_time).getTime()-new Date(e.last_update_time).getTime())}),o},eJ=e=>{if(!e)return[];return(Array.isArray(e)?e:Object.entries(e).map(e=>{let[r,t]=e;return{key:r,value:t}})).filter(e=>{let{key:r}=e;return r.startsWith("mlflow.assessment.")}).map(e=>{let{value:r}=e;return JSON.parse(r)})};function eX(){var e;return null!=(e=(0,d.W)("mlflow_tracing",null))?e:(0,d.W)("databricks.fe.mlflow.enableTracingUI",!1)}function eQ(e){if(!e)return;if((0,Z.isArray)(e)){var r;return null==(r=e.find(e=>e.key===ep))?void 0:r.value}return e[ep]}let e0=e=>{var r;let t=null==e?void 0:e.info,n=null==e?void 0:e.data;if(!t||!n||!(null==n?void 0:n.spans))return!1;let o=null!=(r=null==t?void 0:t.request_metadata)?r:null==t?void 0:t.trace_metadata;if(o&&eQ(o))return!0;let i=null==t?void 0:t.tags;if(i&&eQ(i))return!0;return!1},e1=e=>{if((0,Z.isNil)(e))return[];if(Array.isArray(e)||(0,Z.isString)(e)||(0,Z.isNumber)(e)||(0,Z.isBoolean)(e))return[{key:"",value:JSON.stringify(e,null,2)}];return Object.entries(e).map(e=>{let[r,t]=e;return{key:r,value:JSON.stringify(t,null,2)}})},e2=e=>{let{searchFilter:r,data:t,activeMatchBackgroundColor:n,inactiveMatchBackgroundColor:i,containsActiveMatch:a,activeMatch:s,scrollToActiveMatch:l}=e,c=RegExp(`(${(0,Z.escapeRegExp)(r.trim())})`,"gi"),d=t.split(c),u=[],p=0;for(let e=0;e<d.length;e++)if(d[e].toLowerCase().includes(r.toLowerCase().trim())){let r=a&&s.matchIndex===p,t=r?n:i,c=(0,o.Y)("span",{ref:r?l:null,css:{backgroundColor:t,scrollMarginTop:50},children:d[e]},e);p++,u.push(c)}else u.push(d[e]);return u},e3=e=>(0,Z.has)(e,"page_content"),e5=e=>e.type===ef.RETRIEVER&&Array.isArray(e.outputs)&&e.outputs.length>0&&(0,Z.every)(e.outputs,e3),e4=(e,r,t)=>`${e}-${r}-${t}`,e7=e=>{var r;return(null!=(r=e.events)?r:[]).filter(e=>"exception"===e.name)},e6=e=>e7(e).length,e9=e=>{var r;let t;switch(e.type){case"user":case"human":t="user";break;case"assistant":case"ai":t="assistant";break;case"system":t="system";break;case"tool":t="tool";break;case"function":t="function";break;default:return null}let n={content:e.content,role:t},o=e.tool_calls,i=null==(r=e.additional_kwargs)?void 0:r.tool_calls;return!(0,Z.isNil)(o)&&Array.isArray(o)&&o.length>0&&o.every(rd)?n.tool_calls=(0,Z.compact)(o.map(e8)):!(0,Z.isNil)(i)&&Array.isArray(i)&&i.length>0&&i.every(rt)&&(n.tool_calls=i.map(rv)),(0,Z.isNil)(e.tool_call_id)||(n.tool_call_id=e.tool_call_id),n},e8=e=>({id:e.id,function:{arguments:JSON.stringify(e.args,null,2),name:e.name}}),re=e=>{if((0,Z.isNil)(e)||!(0,Z.isNil)(e.type)&&!(0,Z.isString)(e.type)||!(0,Z.isNil)(e.description)&&!(0,Z.isString)(e.description)||!(0,Z.isNil)(e.enum)&&!Array.isArray(e.enum))return!1;return!0},rr=e=>{var r;if((0,Z.isNil)(e)||"function"!==e.type||!(0,Z.has)(e,"function.name"))return!1;let t=null==(r=e.function)?void 0:r.parameters;if(!(0,Z.isNil)(t)){let e=t.required;if(!(0,Z.isNil)(e)&&(!Array.isArray(e)||!e.every(Z.isString)))return!1;let r=t.properties;if(!(0,Z.isNil)(r)&&!Object.values(r).every(re))return!1}return!0},rt=e=>{var r,t;return e&&(0,Z.isString)(e.id)&&(0,Z.isString)(null==(r=e.function)?void 0:r.arguments)&&(0,Z.isString)(null==(t=e.function)?void 0:t.name)},rn=e=>{switch(e.type){case"text":case"input_text":case"output_text":return(0,Z.isString)(e.text);case"image_url":let{image_url:r}=e;if((0,Z.isNil)(r))return!1;return(0,Z.isString)(r.url)&&((0,Z.isNil)(r.detail)||["auto","low","high"].includes(r.detail));case"input_audio":let{input_audio:t}=e;if((0,Z.isNil)(t))return!1;return(0,Z.isString)(t.data)&&((0,Z.isNil)(t.format)||["wav","mp3"].includes(t.format));default:return!1}},ro=e=>{if((0,Z.isNil)(e)||(0,Z.isString)(e))return!0;if((0,Z.isArray)(e))return e.every(e=>rn(e));return!1},ri=e=>{if(!ra(e))return!1;return(0,Z.isNil)(e.content)||(0,Z.isString)(e.content)},ra=e=>{if(!e||e.tool_calls&&(!Array.isArray(e.tool_calls)||!e.tool_calls.every(rt)))return!1;if("reasoning"===e.type)return!0;if(!ro(e.content))return!1;return"user"===e.role||"assistant"===e.role||"system"===e.role||"tool"===e.role},rs=e=>Array.isArray(e)&&e.length>0&&e.every(e=>(0,Z.has)(e,"message")&&ri(e.message)),rl=e=>e&&rs(e.choices),rc=e=>{if(!e||!(0,Z.isNil)(e.content)&&!(0,Z.isString)(e.content))return!1;return["human","user","assistant","ai","system","tool","function"].includes(e.type)},rd=e=>e&&(0,Z.isString)(e.name)&&(0,Z.has)(e,"args")&&(0,Z.isString)(e.id),ru=e=>e&&rc(e.message),rp=e=>e&&ri(e.message),rg=e=>{try{if(Array.isArray(e)&&e.length>0&&e.every(ra))return(0,Z.compact)(e.map(rb));let r=rm(e);if(r)return r;let t=rx(e);if(t)return t;let n=rE(e);if(n)return n;let o=rS(e);if(o)return o;let i=r_(e);if(i)return i;let a=rA(e);if(a)return a;return null}catch(e){return null}},rm=e=>{if(Array.isArray(e)&&1===e.length&&Array.isArray(e[0])&&e[0].length>0&&e[0].every(rc)){let r=e[0].map(e9);if(r.some(e=>null===e))return null;return r}if(Array.isArray(null==e?void 0:e.messages)&&e.messages.length>0&&e.messages.every(rc)){let r=e.messages.map(e9);if(r.some(e=>null===e))return null;return r}return null},rf=e=>{if(!Array.isArray(e)||e.length<1||!Array.isArray(e[0])||e[0].length<1)return!1;return e[0].every(ru)},rh=e=>{let r=e.map(e=>e9(e.message));if(r.some(e=>null===e))return null;return r},rE=e=>{if(rf(e))return rh(e[0]);if(!Array.isArray(null==e?void 0:e.generations)||!(e.generations.length>0)||!e.generations[0].every(ru))return null;return rh(e.generations[0])},rv=e=>{var r;let t=null==(r=e.function)?void 0:r.arguments;try{t=JSON.stringify(JSON.parse(t),null,2)}catch(e){}return{id:e.id,function:{arguments:t,name:e.function.name}}},ry=e=>{if((0,Z.isNil)(e)||(0,Z.isString)(e))return e;return e.map(e=>{switch(e.type){case"text":case"input_text":case"output_text":return e.text;case"image_url":return"[image]";case"input_audio":return"[audio]"}}).join("\n")},rb=e=>{var r;if("reasoning"===e.type)return null;return{...e,content:ry(e.content),tool_calls:null==(r=e.tool_calls)?void 0:r.map(rv)}},rx=e=>{var r;if(!e)return null;let t=null!=(r=e.messages)?r:e.input;if(!Array.isArray(t)||0===t.length||!t.every(ra))return null;return(0,Z.compact)(t.map(rb))},rS=e=>{if(rs(e))return e.map(e=>{var r;return{...e.message,tool_calls:null==(r=e.message.tool_calls)?void 0:r.map(rv)}});if(!rl(e))return null;return e.choices.map(e=>{var r;return{...e.message,tool_calls:null==(r=e.message.tool_calls)?void 0:r.map(rv)}})},rT=e=>{if(!e)return!1;if("message"===e.type)return ra(e);if("function_call"===e.type)return(0,Z.isString)(e.call_id)&&(0,Z.isString)(e.name)&&(0,Z.isString)(e.arguments);if("function_call_output"===e.type)return(0,Z.isString)(e.call_id)&&(0,Z.isString)(e.output);return!1},rI=e=>{if("message"===e.type)return rb(e);if("function_call"===e.type)return{role:"assistant",tool_calls:[rv({id:e.call_id,function:{arguments:e.arguments,name:e.name}})]};if("function_call_output"===e.type)return{role:"tool",tool_call_id:e.call_id,content:e.output};return null},r_=e=>{if(!e)return null;if(Array.isArray(e)&&e.length>0&&e.every(rT))return(0,Z.compact)(e.map(rI));if(Array.isArray(e)&&e.length>0&&e.every(e=>"response.output_item.done"===e.type&&rT(e.item)))return(0,Z.compact)(e.map(e=>rI(e.item)));return null},rA=e=>{if(!rp(e))return null;return[e.message]};var rR=t(71218),rw=t(57488);function rN(e){let{ref:r,debounceTimeMs:t}=e,n=(0,i.useRef)({width:-1,height:-1}),o=(0,i.useRef)(),[a,s]=(0,i.useState)(null),l=(0,i.useCallback)(e=>{if(0===e.length)return;let r=e[0].contentRect;if(-1===n.current.width){n.current={width:r.width,height:r.height},s(n.current);return}if(r.width!==n.current.width||r.height!==n.current.height){if(n.current.width=r.width,n.current.height=r.height,!t)return void s({...n.current});clearTimeout(o.current),o.current=setTimeout(()=>{s({...n.current})},t)}},[t]),c=(0,i.useRef)();return c.current||(c.current=new ResizeObserver(l)),(0,i.useEffect)(()=>{let e="function"==typeof r?r():r.current;if(e){let r=c.current;return r.observe(e),()=>r.unobserve(e)}}),a}let rY=(0,i.forwardRef)((e,r)=>{var t;let{initialRatio:n,paneWidth:a,setPaneWidth:l,leftChild:c,leftMinWidth:d,rightChild:u,rightMinWidth:p}=e,[g,m]=(0,i.useState)(!1),f=(0,i.useRef)(null),h=null==(t=rN({ref:f}))?void 0:t.width,E=(null!=h?h:1/0)-p,v=(0,i.useRef)(n),{theme:y}=(0,s.wn)(),b=(0,i.useCallback)(e=>{h&&(v.current=e/h)},[h]);return(0,i.useImperativeHandle)(r,()=>({updateRatio:b})),(0,i.useLayoutEffect)(()=>{h&&l((0,Z.clamp)(h*v.current,d,E))},[h,E,d,p,l]),(0,o.FD)("div",{ref:f,css:{display:"flex",flex:1,overflow:"hidden",flexDirection:"row"},children:[g&&(0,o.Y)(rR.mL,{styles:[{"body, :host":{userSelect:"none"}}]}),(0,o.Y)(rw.ResizableBox,{axis:"x",width:a,css:{display:"flex",flex:`0 0 ${a}px`},handle:(0,o.Y)("div",{css:{width:0,position:"relative"},children:(0,o.Y)("div",{css:{position:"relative",width:y.spacing.sm,marginLeft:-y.spacing.xs,minHeight:"100%",cursor:"ew-resize",backgroundColor:"rgba(0,0,0,0)",zIndex:1,":hover":{backgroundColor:"rgba(0,0,0,0.1)"}}})}),onResize:(e,r)=>{let{size:t}=r,n=(0,Z.clamp)(t.width,d,E);l(n),h&&(v.current=n/h)},onResizeStart:()=>m(!0),onResizeStop:()=>m(!1),minConstraints:[d,1/0],maxConstraints:[E,1/0],children:c}),u]})});var rC=t(27714),rM=t(48774),rD=t(74353),rO=t(39827),rk=t(43942),rL=t(58365);let rP=e=>{let{searchFilter:r,setSearchFilter:t,matchData:n,handleNextSearchMatch:a,handlePreviousSearchMatch:l}=e,[c,d]=(0,i.useState)(r),u=(0,rC.YQ)(t,350),{theme:p}=(0,s.wn)();return(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",justifyContent:"space-between",gap:p.spacing.sm},children:[(0,o.Y)(rM.p,{componentId:"shared.model-trace-explorer.search-input",allowClear:!0,placeholder:"Search",value:c,onClear:()=>{t(""),d("")},onChange:e=>{d(e.target.value),u(e.target.value.toLowerCase())},prefix:(0,o.Y)(e_.A,{}),css:{width:"100%",boxSizing:"border-box"}}),n.match&&(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",marginLeft:p.spacing.xs,marginRight:p.spacing.sm,alignItems:"center"},children:[(0,o.FD)(rD.o.Text,{css:{whiteSpace:"nowrap",marginRight:p.spacing.sm},children:[n.currentMatchIndex+1," / ",n.totalMatches]}),(0,o.Y)(rO.$n,{"data-testid":"prev-search-match",icon:(0,o.Y)(rk.A,{}),onClick:l,componentId:"shared.model-trace-explorer.prev-search-match"}),(0,o.Y)(rO.$n,{"data-testid":"next-search-match",icon:(0,o.Y)(rL.A,{}),onClick:a,componentId:"shared.model-trace-explorer.next-search-match"})]})]})},rU=1/0,rF={HIGH:5,NORMAL:3,LOW:1},rB=(e,r)=>{let t=[],n=e=>{if(!e)return;if(t.push(e),r.has(e.key)){var o;null==(o=e.children)||o.forEach(n)}};return e.forEach(n),t},rW=e=>{let r=[],t=e=>{var n;if(!e)return;r.push(e),null==(n=e.children)||n.forEach(t)};return e.forEach(t),r},rj=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,t={},n=(e,o)=>{var i;if(!e||o>r)return;t[e.key]=e,null==(i=e.children)||i.forEach(e=>n(e,o+1))};return e.forEach(n,0),t},rz=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[r,t]=(0,i.useState)(()=>{if(e.rootNodes)return new Set((0,Z.values)(rj(e.rootNodes,e.initialExpandDepth)).map(e=>e.key));return new Set});return{expandedKeys:r,setExpandedKeys:t}},rG=e=>{if(0===e)return"0s";if(e>=60*1e6)return`${(e/1e6/60).toFixed(2)}m`;if(e>=1e5)return`${(e/1e6).toFixed(2)}s`;return`${(e/1e3).toFixed(2)}ms`},r$=(e,r)=>{var t;if(e.key===r)return 0;return(null!=(t=e.children)?t:[]).findIndex(e=>r$(e,r)>-1)},rK=e=>{var r;if(!e.children||(null==(r=e.children)?void 0:r.length)===0)return 0;return Math.max(...e.children.map(rK))+1},rH=(e,r)=>{let t=new Set,n=e;for(;n&&n.parentId;)t.add(n.parentId),n=r[n.parentId];return t},rV=(0,i.createContext)({rootNode:null,nodeMap:{},activeView:"summary",setActiveView:()=>{},selectedNode:void 0,setSelectedNode:()=>{},activeTab:"content",setActiveTab:()=>{},showTimelineTreeGantt:!1,setShowTimelineTreeGantt:()=>{},assessmentsPaneExpanded:!1,setAssessmentsPaneExpanded:()=>{},assessmentsPaneEnabled:!0}),rZ=()=>(0,i.useContext)(rV),rq=e=>{var r,t,n;let{modelTrace:a,initialActiveView:s,selectedSpanIdOnRender:l,assessmentsPaneEnabled:c,children:d}=e,u=(0,i.useMemo)(()=>(function(e){var r,t;let n=eZ(e),i=null!=(t=null==(r=e.trace_data)?void 0:r.spans)?t:e.data.spans,a={},s={};i.forEach(e=>{let r=e$(e);a[r]=e,s[r]=[]}),i.forEach(e=>{let r=e$(e),t=eK(e);if(t){if(!s[t])throw Error("Tree structure is malformed!");s[t].push(r)}});let l=i.find(e=>!eK(e));if((0,Z.isNil)(l))return null;return function r(t){var i,c,d;let u=a[t],p=Number(eH(l)),g=Number(eV(l)),m=s[t].map(r),f=eq(e.info);if(eG(u)||"parent_id"in u)return eB(u,p,g,m,f,n);let h=null!=(i=u.span_type)?i:ef.UNKNOWN;return{title:u.name,icon:(0,o.Y)(eD,{type:eO(h)}),type:h,key:u.context.span_id,start:Number(u.start_time)-p,end:Number(null!=(c=u.end_time)?c:g)-p,children:m,inputs:u.inputs,outputs:u.outputs,attributes:u.attributes,events:u.events,parentId:null!=(d=u.parent_id)?d:u.parent_span_id,assessments:[],traceId:n}}(e$(l))})(a),[a]),p=(0,i.useMemo)(()=>u?rj([u]):{},[u]),g=function e(r,t){var n;if((0,Z.isNil)(t)||(0,Z.isNil)(r))return;if(r.key===t)return r;for(let o of null!=(n=r.children)?n:[]){let r=e(o,t);if(r)return r}}(u,l),m=null!=(t=null!=g?g:u)?t:void 0,f=(null!=(n=null==m||null==(r=m.assessments)?void 0:r.length)?n:0)>0,[h,E]=(0,i.useState)(s),[v,y]=(0,i.useState)(m),[b,x]=(0,i.useState)((null==v?void 0:v.chatMessages)?"chat":"content"),[S,T]=(0,i.useState)(!1),[I,_]=(0,i.useState)(f),A=(0,i.useMemo)(()=>({rootNode:u,nodeMap:p,activeView:h,setActiveView:E,activeTab:b,setActiveTab:x,selectedNode:v,setSelectedNode:y,showTimelineTreeGantt:S,setShowTimelineTreeGantt:T,assessmentsPaneExpanded:I,setAssessmentsPaneExpanded:_,assessmentsPaneEnabled:c}),[h,p,b,u,v,S,T,I,_,c]);return(0,o.Y)(rV.Provider,{value:A,children:d})},rJ=e=>{let r={};return e&&(0,Z.compact)(rW([e]).map(e=>e.type)).forEach(e=>{r[e]=!0}),{showParents:!0,showExceptions:!0,spanTypeDisplayState:r}},rX=e=>{switch(e.section){case"inputs":case"outputs":default:return"content";case"attributes":return"attributes";case"events":return"events"}},rQ=e=>{var r;let{treeNode:t,selectedNode:n,setSelectedNode:o,setActiveTab:a,setExpandedKeys:s,modelTraceInfo:l}=e,[c,d]=(0,i.useState)(""),[u,p]=(0,i.useState)(()=>rJ(t)),[g,m]=(0,i.useState)(0),{filteredTreeNodes:f,matches:h}=(0,i.useMemo)(()=>{if((0,Z.isNil)(t))return{filteredTreeNodes:[],matches:[]};return function e(r,t,n){var o,i;let a=t.toLowerCase().trim(),s=Object.values(n.spanTypeDisplayState).every(e=>e);if(""===a&&s)return{filteredTreeNodes:[r],matches:[]};let l=null!=(o=r.children)?o:[],c=[],d=[];l.forEach(r=>{let{filteredTreeNodes:t,matches:o}=e(r,a,n);c.push(...t),d.push(...o)});let u=(null!=(i=r.title)?i:"").toLowerCase(),p=eP(r,a),g=p.length>0||u.includes(a),m=!r.type||n.spanTypeDisplayState[r.type],f=c.length>0,h=e6(r)>0;if(g&&m||n.showParents&&f||n.showExceptions&&h)return{filteredTreeNodes:[{...r,children:c}],matches:p.concat(d)};return{filteredTreeNodes:c,matches:d}}(t,c,u)},[null==t?void 0:t.key,c,u,l]),E=(0,i.useMemo)(()=>rj(f),[f]),v=(0,i.useCallback)(e=>{if(e>=h.length||e<0)return;m(e);let r=h[e];o(r.span),a(rX(r));let t=rH(r.span,E);s(e=>new Set([...e,...t]))},[h,o,a,E,s]),y=(0,i.useCallback)(()=>{v(g+1)},[g,v]),b=(0,i.useCallback)(()=>{v(g-1)},[g,v]);return(0,i.useLayoutEffect)(()=>{if(0===f.length)return;if(0===h.length){var e;let r=null!=(e=null==n?void 0:n.key)?e:"";if(r in E)o(E[r]);else{let e=f[0];o(e),a((null==e?void 0:e.chatMessages)?"chat":"content")}return}m(0),o(h[0].span),a(rX(h[0]))},[f,h,o]),{matchData:{match:null!=(r=h[g])?r:null,totalMatches:h.length,currentMatchIndex:g},searchFilter:c.toLowerCase().trim(),setSearchFilter:d,spanFilterState:u,setSpanFilterState:p,filteredTreeNodes:f,handleNextSearchMatch:y,handlePreviousSearchMatch:b}};var r0=t(24037),r1=t(53179),r2=t(36909);let r3="yellow500",r5="yellow200",r4=e=>{let{searchFilter:r,data:t,activeMatch:n,containsActiveMatch:a}=e,{theme:l}=(0,s.wn)(),c=(0,i.useCallback)(e=>{null==e||e.scrollIntoView({block:"nearest",inline:"nearest"})},[]),d=(0,i.useMemo)(()=>{if(!r)return[];return e2({data:t,searchFilter:r,activeMatchBackgroundColor:l.colors[r3],inactiveMatchBackgroundColor:l.colors[r5],containsActiveMatch:a,activeMatch:n,scrollToActiveMatch:c})},[r,t,l,a,n,c]);return(0,o.Y)("pre",{css:{whiteSpace:"pre-wrap",backgroundColor:l.colors.backgroundSecondary,padding:l.spacing.sm,fontSize:l.typography.fontSizeSm},children:d})};var r7=t(53633),r6=t(24162),r9=t(9991),r8=t(12876),te=t(76991),tr=t(83214),tt=t(8153),tn=t(66164),to=t(22919),ti=t(30136),ta=t(70549),ts=t(21733),tl=t(60700);let tc=(0,rR.AH)("margin-right:16px;text-align:right;position:absolute;right:0;padding-top:2px;padding-right:2px;");function td(e){let{children:r,style:t}=e;return(0,o.Y)("div",{css:tc,style:t,children:r})}let tu=a().createContext({});function tp(e){let{children:r,theme:t={}}=e;return(0,o.Y)(tu.Provider,{value:t,children:r})}function tg(e){let{theme:r="light",actions:t,children:n,style:i}=e;return(0,o.FD)(o.FK,{children:[(0,o.Y)(td,{style:i,children:(0,o.Y)(tp,{theme:"duotoneDark"===r?{color:"rgba(255, 255, 255, 0.84)",hoverColor:"#8ccbffcc",backgroundColor:"rgba(140, 203, 255, 0)",hoverBackgroundColor:"rgba(140, 203, 255, 0.08)"}:void 0,children:t})}),n]})}function tm(e){e.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:BASE64|PARSE_URL|UPPER|LOWER|INITCAP|FORMAT_NUMBER|FORMAT_STRING|TRIM|UNBASE64|CONCAT|MAP|MAP_KEYS|MAP_VALUES|MAP_ENTRIES|MAP_FILTER|MAP_FROM_ARRAYS|MAP_FROM_ENTRIES|MAP_ZIP_WITH|ARRAY|AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:COPY|DESCRIBE HISTORY|DESCRIBE DETAIL|STORAGE CREDENTIALS?|URL|CACHE|UNCACHE|VACUUM|MSCK|CATALOGS?|CREDENTIALS?|FILES?|RECIPIENTS?|PROVIDERS?|TBLPROPERTIES|SHARES|VIEWS|EXTERNAL|REPAIR|REFRESH|COMMENT|LIST|PARQUET|LOCATIONS?|OPTIONS|JAR|ARCHIVE|ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR|AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?/i,punctuation:/[;[\]()`,.]/}}tm.displayName="databricks-runtime-sql",tm.aliases=["sql","dbr-sql","dbsql","databricks-sql"],tr.A.registerLanguage("sql",tm),tr.A.registerLanguage("java",to.A),tr.A.registerLanguage("python",ts.A),tr.A.registerLanguage("go",tt.A),tr.A.registerLanguage("javascript",ti.A),tr.A.registerLanguage("yaml",tl.A),tr.A.registerLanguage("json",ta.A),tr.A.registerLanguage("hcl",tn.A);let tf={light:{'code[class*="language-"]':{textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",wordWrap:"normal",color:"rgb(77, 77, 76)",background:"#fafafa",fontFamily:"'Menlo', 'Monaco', 'Consolas', 'Ubuntu Mono', 'Source Code Pro', monospace",fontSize:"12px",lineHeight:"1.5em",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none"},'pre[class*="language-"]':{textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",wordWrap:"normal",color:"rgb(77, 77, 76)",background:"#fafafa",fontFamily:"'Menlo', 'Monaco', 'Consolas', 'Ubuntu Mono', 'Source Code Pro', monospace",fontSize:"12px",lineHeight:"1.5em",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",overflow:"auto",position:"relative",margin:"0.5em 0",padding:"1.25em 1em"},'code[class*="language-"]::-moz-selection':{background:"#cceae7",color:"#263238"},'pre[class*="language-"]::-moz-selection':{background:"#cceae7",color:"#263238"},'code[class*="language-"] ::-moz-selection':{background:"#cceae7",color:"#263238"},'pre[class*="language-"] ::-moz-selection':{background:"#cceae7",color:"#263238"},'code[class*="language-"]::selection':{background:"#cceae7",color:"#263238"},'pre[class*="language-"]::selection':{background:"#cceae7",color:"#263238"},'code[class*="language-"] ::selection':{background:"#cceae7",color:"#263238"},'pre[class*="language-"] ::selection':{background:"#cceae7",color:"#263238"},':not(pre) > code[class*="language-"]':{whiteSpace:"normal",borderRadius:"0.2em",padding:"0.1em"},".language-css > code":{color:"#f5871f"},".language-sass > code":{color:"#f5871f"},".language-scss > code":{color:"#f5871f"},'[class*="language-"] .namespace':{Opacity:"0.7"},atrule:{color:"#7c4dff"},"attr-name":{color:"#39adb5"},"attr-value":{color:"#f6a434"},attribute:{color:"#f6a434"},boolean:{color:"#7c4dff"},builtin:{color:"#39adb5"},cdata:{color:"#39adb5"},char:{color:"#39adb5"},class:{color:"#39adb5"},"class-name":{color:"#6182b8"},comment:{color:"#8e908c"},constant:{color:"#7c4dff"},deleted:{color:"#e53935"},doctype:{color:"#aabfc9"},entity:{color:"#e53935"},function:{color:"#4271ae"},hexcode:{color:"#f5871f"},id:{color:"#7c4dff",fontWeight:"bold"},important:{color:"#7c4dff",fontWeight:"bold"},inserted:{color:"#39adb5"},keyword:{color:"#8959a8"},number:{color:"#f5871f"},operator:{color:"#3e999f"},prolog:{color:"#aabfc9"},property:{color:"#39adb5"},"pseudo-class":{color:"#f6a434"},"pseudo-element":{color:"#f6a434"},punctuation:{color:"rgb(77, 77, 76)"},regex:{color:"#6182b8"},selector:{color:"#e53935"},string:{color:"#3ba85f"},symbol:{color:"#7c4dff"},tag:{color:"#e53935"},unit:{color:"#f5871f"},url:{color:"#e53935"},variable:{color:"#c72d4c"}},duotoneDark:{'code[class*="language-"]':{fontFamily:"'Menlo', 'Monaco', 'Consolas', 'Ubuntu Mono', 'Andale Mono WT', 'Andale Mono', 'Lucida Console', 'Lucida Sans Typewriter', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Liberation Mono', 'Nimbus Mono L', 'Courier New', 'Courier', 'Source Code Pro', monospace",fontSize:"14px",lineHeight:"1.375",direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",background:"#2a2734",color:"#5DFAFC"},'pre[class*="language-"]':{fontFamily:"'Menlo', 'Monaco', 'Consolas', 'Ubuntu Mono', 'Andale Mono WT', 'Andale Mono', 'Lucida Console', 'Lucida Sans Typewriter', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Liberation Mono', 'Nimbus Mono L', 'Courier New', 'Courier', 'Source Code Pro', monospace",fontSize:"14px",lineHeight:"1.375",direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",background:"#2a2734",color:"#5DFAFC",padding:"1em",margin:".5em 0",overflow:"auto"},'pre > code[class*="language-"]':{fontSize:"1em"},'pre[class*="language-"]::-moz-selection':{textShadow:"none",background:"#6a51e6"},'pre[class*="language-"] ::-moz-selection':{textShadow:"none",background:"#6a51e6"},'code[class*="language-"]::-moz-selection':{textShadow:"none",background:"#6a51e6"},'code[class*="language-"] ::-moz-selection':{textShadow:"none",background:"#6a51e6"},'pre[class*="language-"]::selection':{textShadow:"none",background:"#6a51e6"},'pre[class*="language-"] ::selection':{textShadow:"none",background:"#6a51e6"},'code[class*="language-"]::selection':{textShadow:"none",background:"#6a51e6"},'code[class*="language-"] ::selection':{textShadow:"none",background:"#6a51e6"},':not(pre) > code[class*="language-"]':{padding:".1em",borderRadius:".3em"},comment:{color:"#6c6783"},prolog:{color:"#6c6783"},doctype:{color:"#6c6783"},cdata:{color:"#6c6783"},punctuation:{color:"#6c6783"},namespace:{Opacity:".7"},tag:{color:"#3AACE2"},operator:{color:"#3AACE2"},number:{color:"#3AACE2"},property:{color:"#5DFAFC"},function:{color:"#5DFAFC"},"tag-id":{color:"#eeebff"},selector:{color:"#eeebff"},"atrule-id":{color:"#eeebff"},"code.language-javascript":{color:"#c4b9fe"},"attr-name":{color:"#c4b9fe"},"code.language-css":{color:"#ffffff"},"code.language-scss":{color:"#ffffff"},boolean:{color:"#ffffff"},string:{color:"#ffffff"},entity:{color:"#ffffff",cursor:"help"},url:{color:"#ffffff"},".language-css .token.string":{color:"#ffffff"},".language-scss .token.string":{color:"#ffffff"},".style .token.string":{color:"#ffffff"},"attr-value":{color:"#ffffff"},keyword:{color:"#ffffff"},control:{color:"#ffffff"},directive:{color:"#ffffff"},unit:{color:"#ffffff"},statement:{color:"#ffffff"},regex:{color:"#ffffff"},atrule:{color:"#ffffff"},placeholder:{color:"#ffffff"},variable:{color:"#ffffff"},deleted:{textDecoration:"line-through"},inserted:{borderBottom:"1px dotted #eeebff",textDecoration:"none"},italic:{fontStyle:"italic"},important:{fontWeight:"bold",color:"#c4b9fe"},bold:{fontWeight:"bold"},"pre > code.highlight":{Outline:".4em solid #8a75f5",OutlineOffset:".4em"},".line-numbers.line-numbers .line-numbers-rows":{borderRightColor:"#2c2937"},".line-numbers .line-numbers-rows > span:before":{color:"#3c3949"},".line-highlight.line-highlight":{background:"linear-gradient(to right, rgba(224, 145, 66, 0.2) 70%, rgba(224, 145, 66, 0))"}}};function th(e){let{theme:r="light",language:t,actions:n,style:i,children:a,...s}=e,l={border:"none",borderRadius:0,margin:0,padding:"24px",...i};return(0,o.Y)(tg,{theme:r,actions:n,children:(0,o.Y)(tr.A,{language:t,style:tf[r],customStyle:l,codeTagProps:{style:(0,Z.pick)(i,"backgroundColor")},...s,children:a})})}var tE=t(49165);function tv(e){return e&&`${e} !important`}function ty(e){let{tooltipMessage:r,...t}=e,{color:n,hoverColor:a,hoverBackgroundColor:s,backgroundColor:l,borderColor:c}=(0,i.useContext)(tu),d=(0,rR.AH)({zIndex:1,color:tv(n),borderColor:tv(c),backgroundColor:tv(l),":hover":{color:tv(a),backgroundColor:tv(s)}});return(0,o.Y)(tE.p,{title:r,children:(0,o.Y)(rO.$n,{componentId:"codegen_web-shared_src_snippet_actions_snippetactionbutton.tsx_33",...t,css:d})})}var tb=t(48091),tx=t(37672),tS=t(64019);function tT(e){let{copyText:r,onClick:t,...n}=e,{actionIcon:a,tooltipMessage:s,copy:l}=function(e,r,t){let n=(0,c.tz)(),a=n.formatMessage({id:"hBAhI8",defaultMessage:"Copy"}),s=n.formatMessage({id:"g4hHzO",defaultMessage:"Copied"}),l=(0,tb.useClipboard)(),d=(0,i.useRef)(),[u,p]=(0,i.useState)(!1);return(0,i.useEffect)(()=>()=>{window.clearTimeout(d.current)},[]),{actionIcon:u?(0,o.Y)(tx.A,{}):(0,o.Y)(tS.A,{}),tooltipMessage:u?s:a,copy:()=>{l.copy(e),window.clearTimeout(d.current),p(!0),d.current=window.setTimeout(()=>{p(!1)},3e3)},copied:u,ariaLabel:a}}(r);return(0,o.Y)(ty,{tooltipMessage:s,icon:a,onClick:e=>{l(),null==t||t(e)},...n})}var tI=t(33543),t_=t(19627);let tA=()=>(0,d.W)("databricks.fe.genai.enable-virtualized-markdown-tables",!1),tR=e=>{let{children:r}=e;return(0,o.Y)("div",{"data-testid":"basic-table",css:{overflow:"auto"},children:(0,o.Y)(t_.X,{scrollable:!0,css:{height:"auto",minHeight:"initial",display:"inline-flex",minWidth:"100%",zIndex:0},children:r})})},tw=e=>{let{children:r,node:t}=e,{header:n,rows:i,isValid:s}=function(e){var r;let{children:t}=e;if(!t)return{header:void 0,rows:[],isValid:!1};let n=a().Children.toArray(t);return{header:null!=(r=n[0])?r:void 0,rows:n.slice(1).flatMap(e=>{if(a().isValidElement(e))return a().Children.toArray(e.props.children).filter(e=>a().isValidElement(e));return[]}),isValid:!0}}({children:r,node:t});if(!s)return(0,o.Y)(tR,{children:r,node:t});return tA()?(0,o.Y)(tN,{header:n,rows:i}):(0,o.Y)(tR,{children:r,node:t})},tN=e=>{let{header:r,rows:t}=e,{theme:n}=(0,s.wn)(),i=a().useRef(null),{virtualItems:l,totalSize:c}=(0,tI.z)({size:t.length,parentRef:i,overscan:20});return(0,o.Y)("div",{"data-testid":"virtualized-table",ref:i,css:{overflow:"auto",maxHeight:420,border:"1px solid",borderColor:n.colors.border,borderRadius:n.borders.borderRadiusMd,marginBottom:n.spacing.md,zIndex:0},children:(0,o.FD)(t_.X,{css:{height:"auto",minHeight:"initial",display:"inline-flex",minWidth:"100%"},children:[r,(0,o.Y)("div",{css:{position:"relative",height:`${c}px`,width:"100%",'& > div:last-child [role="cell"]':{borderBottom:"none"}},children:l.map(e=>{let r=e.index,n=t[r];return(0,o.Y)("div",{ref:e.measureRef,css:{position:"absolute",top:`${e.start}px`,width:"100%"},children:n},r)})})]})})},tY=e=>{let{children:r,node:t}=e,n=null==t?void 0:t.children.some(e=>"th"===e.tagName),{theme:i}=(0,s.wn)();return(0,o.Y)(r9.H,{style:n?{position:"sticky",top:0,zIndex:1,backgroundColor:i.colors.backgroundPrimary}:void 0,children:r,isHeader:n})},tC=e=>{let{children:r,node:t}=e,n=(null==t?void 0:t.tagName)==="th",{theme:i}=(0,s.wn)();if(n)return(0,o.Y)(r8.A,{"data-testid":"virtualized-table-header",componentId:"virtualized-table-header",css:{paddingLeft:i.spacing.sm,borderColor:i.colors.border,color:i.colors.textPrimary},children:r});return(0,o.Y)(te.n,{children:r})},tM=e=>{let r=(0,i.useMemo)(()=>tP({extensions:e.components}),[e.components]);return(0,o.Y)(r7.oz,{components:r,remarkPlugins:tL,children:e.children})},tD=e=>{var r,t;let{codeBlock:n,codeInline:o,node:i,...s}=e,l=a().useMemo(()=>{var e;let r=/language-(\w+)/.exec(null!=(e=s.className)?e:"");return r&&r[1]?r[1]:void 0},[s.className]);if((null==i||null==(r=i.position)?void 0:r.start.line)===(null==i||null==(t=i.position)?void 0:t.end.line))return a().createElement(o,s);return a().createElement(n,{...s,language:l})},tO=e=>{let{children:r}=e;return(0,o.Y)(rD.o.Text,{code:!0,children:r})},tk=a().memo(e=>{let{children:r,language:t}=e,{theme:n}=(0,s.wn)(),i=String(r).replace(/\n$/,"");return(0,o.Y)("div",{css:{position:"relative"},children:(0,o.Y)(th,{actions:(0,o.Y)(tT,{componentId:"genai.util.markdown-copy-code-block",copyText:i}),theme:n.isDarkMode?"duotoneDark":"light",children:i,language:t&&tU(t)?t:"text",style:{padding:"8px 0",borderRadius:8,width:"100%",boxSizing:"border-box",maxHeight:640,display:"flex",flexDirection:"column-reverse"},showLineNumbers:!0})})}),tL=[r6.A],tP=e=>({a:e=>{let{href:r,children:t}=e;return(0,o.Y)(rD.o.Link,{componentId:"codegen_webapp_js_genai_util_markdown.tsx_71",href:r,id:(null==r?void 0:r.startsWith("#user-content-fn-"))?r.replace("#user-content-fn-","user-content-fnref-"):void 0,disabled:null==r?void 0:r.startsWith("."),children:(null==r?void 0:r.startsWith("#user-content-fn-"))?(0,o.FD)(o.FK,{children:["[",t,"]"]}):t,openInNewTab:!(r&&r.startsWith("#"))})},code:r=>{var t,n,i,a;return(0,o.Y)(tD,{...r,codeBlock:null!=(i=null==(t=e.extensions)?void 0:t.codeBlock)?i:tk,codeInline:null!=(a=null==(n=e.extensions)?void 0:n.codeInline)?a:tO})},p:e=>{let{children:r}=e;return(0,o.Y)(rD.o.Paragraph,{children:r})},h1:e=>{let{children:r}=e;return(0,o.Y)(rD.o.Title,{level:1,children:r})},h2:e=>{let{children:r}=e;return(0,o.Y)(rD.o.Title,{level:2,children:r})},h3:e=>{let{children:r}=e;return(0,o.Y)(rD.o.Title,{level:3,children:r})},h4:e=>{let{children:r}=e;return(0,o.Y)(rD.o.Title,{level:4,children:r})},h5:e=>{let{children:r}=e;return(0,o.Y)(rD.o.Title,{level:5,children:r})},table:e=>{let{children:r,node:t}=e;return(0,o.Y)(tw,{children:r,node:t})},tr:e=>{let{children:r,node:t}=e;return tA()?(0,o.Y)(tY,{children:r,node:t}):(0,o.Y)(r9.H,{children:r,isHeader:null==t?void 0:t.children.some(e=>"th"===e.tagName)})},th:e=>{let{children:r,node:t}=e;return tA()?(0,o.Y)(tC,{children:r,node:t}):(0,o.Y)(r8.A,{componentId:"codegen_webapp_js_genai_util_markdown.tsx_90",children:r})},td:e=>{let{children:r}=e;return(0,o.Y)(te.n,{children:r,multiline:!0})},thead:e=>{let{children:r}=e;return(0,o.Y)(o.FK,{children:r})},tbody:e=>{let{children:r}=e;return(0,o.Y)(o.FK,{children:r})},img:e=>{let{src:r,alt:t}=e;return(0,o.Y)("img",{src:r,alt:t,css:{maxWidth:"100%"}})}}),tU=e=>{switch(e){case"go":case"hcl":case"java":case"javascript":case"json":case"python":case"sql":case"text":case"yaml":return!0;default:return!1}};function tF(e){let{data:r,searchFilter:t="",activeMatch:n=null,containsActiveMatch:a=!1,renderMode:l=ev.JSON}=e,d=!!t&&!(0,Z.isNil)(n)&&r.toLowerCase().includes(t),{theme:u}=(0,s.wn)(),[p,g]=(0,i.useState)("json"===l),[m,f]=(0,i.useState)(d),h=(0,i.useRef)(null),E=(0,i.useMemo)(()=>{if("json"===l)return r;let e=JSON.parse(r);if((0,Z.isString)(e))return e;return r},[r,l]),v=p||E.split("\n").length>4||E.length>300,y=(0,i.useMemo)(()=>{if(v&&!m){let e=E.split("\n").slice(0,4).join("\n");return e.length>300?e.slice(0,300):e}return E},[E,v,m]);(0,i.useEffect)(()=>{h.current&&g(h.current.scrollWidth>h.current.clientWidth)},[r]);let b=(0,i.useCallback)(e=>(0,o.Y)("pre",{...e,ref:h}),[]);if(d)return(0,o.Y)(r4,{data:r,searchFilter:t,activeMatch:n,containsActiveMatch:!n.isKeyMatch&&a});return(0,o.FD)("div",{css:{position:"relative"},children:["markdown"===l?(0,o.Y)("div",{css:{padding:u.spacing.md,backgroundColor:u.colors.backgroundSecondary,marginBottom:-u.spacing.md},children:(0,o.Y)(tM,{children:y})}):(0,o.FD)(o.FK,{children:[(0,o.Y)(tT,{componentId:"shared.model-trace-explorer.copy-snippet",copyText:r,size:"small",css:{position:"absolute",top:u.spacing.xs,right:u.spacing.xs,zIndex:1}},"copy-snippet"),(0,o.Y)(th,{PreTag:b,showLineNumbers:!0,language:l,lineProps:{style:{wordBreak:"break-word",whiteSpace:"pre-wrap"}},wrapLines:m,theme:u.isDarkMode?"duotoneDark":"light",style:{backgroundColor:u.colors.backgroundSecondary,padding:u.spacing.sm,paddingBottom:v?0:u.spacing.sm,paddingRight:2*u.spacing.md,overflow:m?"auto":"hidden",textOverflow:"ellipsis",fontSize:u.typography.fontSizeSm,lineHeight:u.typography.lineHeightBase},children:y})]}),v&&(0,o.Y)("div",{css:{backgroundColor:u.colors.backgroundSecondary},children:(0,o.Y)(rO.$n,{css:{width:"100%",padding:0},componentId:m?"shared.model-trace-explorer.snippet-see-less":"shared.model-trace-explorer.snippet-see-more",icon:m?(0,o.Y)(rk.A,{}):(0,o.Y)(rL.A,{}),type:"tertiary",onClick:()=>f(!m),children:m?(0,o.Y)(c.sA,{id:"AgjhWE",defaultMessage:"See less"}):(0,o.Y)(c.sA,{id:"HYQHVk",defaultMessage:"See more"})})})]})}let tB=e=>{let{title:r,searchFilter:t,isActiveMatch:n}=e,{theme:a}=(0,s.wn)(),l=(0,i.useCallback)(e=>{null==e||e.scrollIntoView({block:"nearest",inline:"nearest"})},[]),c=r.toLowerCase();if(!c.includes(t))return(0,o.Y)("div",{children:r});let d=c.indexOf(t),u=d+t.length,p=n?a.colors[r3]:a.colors[r5];return(0,o.FD)("div",{children:[r.slice(0,d),(0,o.Y)("span",{ref:n?l:null,css:{backgroundColor:p,scrollMarginTop:50},children:r.slice(d,u)}),r.slice(u)]})};function tW(e,r){if(r)return r;if(e)return ev.MARKDOWN;return ev.JSON}function tj(e){switch(e){case ev.JSON:return"JSON";case ev.TEXT:return"Text";case ev.MARKDOWN:return"Markdown"}}function tz(e){var r;let{title:t,tokens:n,data:a,searchFilter:l="",activeMatch:c=null,containsActiveMatch:d=!1,initialRenderMode:u}=e,p=(0,i.useMemo)(()=>JSON.parse(a),[a]),g=(0,Z.isString)(p),{theme:m}=(0,s.wn)(),[f,h]=(0,i.useState)(tW(g,u)),E=d&&null!=(r=null==c?void 0:c.isKeyMatch)&&r,v=g&&!l;return(0,i.useEffect)(()=>{h(tW(g,u))},[g,u]),(0,o.Y)("div",{css:{position:"relative"},children:(0,o.FD)("div",{css:{borderRadius:m.borders.borderRadiusSm,border:`1px solid ${m.colors.border}`,overflow:"hidden"},children:[(t||v)&&(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:m.spacing.sm},children:[(0,o.Y)(rD.o.Title,{css:{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},level:4,color:"secondary",withoutMargins:!0,children:(0,o.Y)(tB,{title:t,searchFilter:l,isActiveMatch:E})}),(0,o.Y)("div",{css:{display:"flex",flexDirection:"row",alignItems:"center"},children:v&&(0,o.FD)(r1.Root,{children:[(0,o.Y)(r1.Trigger,{asChild:!0,children:(0,o.Y)(r2.v,{componentId:"shared.model-trace-explorer.snippet-render-mode-tag",css:{height:"min-content",margin:0},children:(0,o.FD)("div",{css:{paddingLeft:m.spacing.xs,marginRight:m.spacing.xs,cursor:"pointer"},children:[(0,o.Y)(rD.o.Text,{size:"sm",color:"secondary",children:tj(f)}),(0,o.Y)(rL.A,{})]})})}),(0,o.FD)(r1.Content,{children:[(0,o.Y)(r1.RadioGroup,{componentId:"shared.model-trace-explorer.snippet-render-mode-radio",value:f,onValueChange:e=>h(e),children:Object.values(ev).map(e=>(0,o.FD)(r1.RadioItem,{value:e,children:[(0,o.Y)(r1.ItemIndicator,{}),tj(e)]},e))}),(0,o.Y)(r1.Arrow,{})]})]})})]}),(0,o.Y)(tF,{data:a,searchFilter:l,activeMatch:c,containsActiveMatch:d,renderMode:f})]})})}function tG(e){let{activeSpan:r,searchFilter:t,activeMatch:n}=e,{theme:i}=(0,s.wn)(),{attributes:a}=r,l=(0,Z.keys)(a).length>0,d=!(0,Z.isNil)(n)&&n.span.key===r.key;if(!l||(0,Z.isNil)(a))return(0,o.Y)("div",{css:{marginTop:i.spacing.md},children:(0,o.Y)(r0.S,{description:(0,o.Y)(c.sA,{id:"B5K1Ix",defaultMessage:"No attributes found"})})});return(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:i.spacing.sm,padding:i.spacing.md},children:Object.entries(a).map(e=>{let[r,i]=e;return(0,o.Y)(tz,{title:r,data:JSON.stringify(i,null,2),searchFilter:t,activeMatch:n,containsActiveMatch:d&&"attributes"===n.section&&n.key===r},r)})})}var t$=t(6277);function tK(e){let{paramName:r,paramProperties:t,isRequired:n}=e,{theme:i}=(0,s.wn)(),{type:a,description:l,enum:d}=t,u=a||l||d,p=u?{borderTopLeftRadius:i.borders.borderRadiusMd,borderTopRightRadius:i.borders.borderRadiusMd,borderBottom:`1px solid ${i.colors.border}`}:{borderRadius:i.borders.borderRadiusMd};return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",width:"100%",borderRadius:i.borders.borderRadiusMd,border:`1px solid ${i.colors.border}`},children:[(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",alignItems:"center",backgroundColor:i.colors.backgroundSecondary,padding:`${i.spacing.sm}px ${i.spacing.md}px`,gap:i.spacing.sm,...p},children:[(0,o.Y)(rD.o.Title,{withoutMargins:!0,style:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:r}),n&&(0,o.Y)(rD.o.Text,{withoutMargins:!0,color:"error",children:(0,o.Y)(c.sA,{id:"JmNdE4",defaultMessage:"required"})})]}),u&&(0,o.FD)("div",{css:{display:"grid",gridTemplateColumns:"auto 1fr",gridTemplateRows:"auto",gap:i.spacing.md,padding:`${i.spacing.sm}px ${i.spacing.md}px`},children:[a&&(0,o.FD)(o.FK,{children:[(0,o.Y)(rD.o.Text,{withoutMargins:!0,bold:!0,children:(0,o.Y)(c.sA,{id:"CbRDlp",defaultMessage:"Type"})}),(0,o.Y)(rD.o.Text,{withoutMargins:!0,code:!0,children:a})]}),l&&(0,o.FD)(o.FK,{children:[(0,o.Y)(rD.o.Text,{withoutMargins:!0,bold:!0,children:(0,o.Y)(c.sA,{id:"SLjN1/",defaultMessage:"Description"})}),(0,o.Y)(rD.o.Text,{withoutMargins:!0,children:l})]}),d&&(0,o.FD)(o.FK,{children:[(0,o.Y)(rD.o.Text,{withoutMargins:!0,bold:!0,children:(0,o.Y)(c.sA,{id:"/WK1x1",defaultMessage:"Enum Values"})}),(0,o.Y)("div",{css:{display:"flex",flexDirection:"row",gap:i.spacing.sm,flexWrap:"wrap"},children:d.map(e=>(0,o.Y)(rD.o.Text,{withoutMargins:!0,code:!0,children:e},e))})]})]})]})}function tH(e){var r,t,n;let{tool:a}=e,{theme:l}=(0,s.wn)(),[c,d]=(0,i.useState)(!1),u=a.function.description,p=null==(r=a.function.parameters)?void 0:r.properties,g=null!=(n=null==(t=a.function.parameters)?void 0:t.required)?n:[],m=u||p,f=m?{":hover":{backgroundColor:l.colors.actionIconBackgroundHover,cursor:"pointer"}}:{};return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",width:"100%",borderRadius:l.borders.borderRadiusMd,border:`1px solid ${l.colors.border}`,backgroundColor:l.colors.backgroundPrimary},"data-testid":"model-trace-explorer-chat-tool",children:[(0,o.FD)("div",{role:"button",css:{display:"flex",flexDirection:"row",gap:l.spacing.sm,alignItems:"center",borderBottom:m&&c?`1px solid ${l.colors.border}`:"none",padding:l.spacing.sm,...f},onClick:()=>d(!c),"data-testid":"model-trace-explorer-chat-tool-toggle",children:[m&&(c?(0,o.Y)(rL.A,{}):(0,o.Y)(t$.A,{})),(0,o.Y)(rD.o.Text,{bold:!0,withoutMargins:!0,style:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:a.function.name})]}),m&&c&&(0,o.FD)("div",{css:{padding:l.spacing.sm},children:[u&&(0,o.Y)(rD.o.Paragraph,{style:{whiteSpace:"pre-wrap",marginBottom:l.spacing.sm,padding:`0px ${l.spacing.xs}px`},children:a.function.description}),p&&(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:l.spacing.sm},children:Object.keys(p).map(e=>(0,o.Y)(tK,{paramName:e,paramProperties:p[e],isRequired:g.includes(e)},e))})]})]})}var tV=t(16426);let tZ=e=>{switch(e){case"system":return(0,o.Y)(eD,{type:eh.SYSTEM});case"user":return(0,o.Y)(eD,{type:eh.USER});case"tool":case"function":return(0,o.Y)(eD,{type:eh.WRENCH});default:return(0,o.Y)(eD,{type:eh.MODELS})}},tq=e=>{switch(e.role){case"system":return(0,o.Y)(c.sA,{id:"+gqcru",defaultMessage:"System"});case"user":return(0,o.Y)(c.sA,{id:"t+aG6y",defaultMessage:"User"});case"assistant":return(0,o.Y)(c.sA,{id:"Hvznjh",defaultMessage:"Assistant"});case"tool":if(e.name)return e.name;return(0,o.Y)(c.sA,{id:"dPn3az",defaultMessage:"Tool"});case"function":return(0,o.Y)(c.sA,{id:"5ZUAC2",defaultMessage:"Function"});default:return e.role}},tJ=e=>{let{isExpandable:r,expanded:t,setExpanded:n,message:i}=e,{theme:a}=(0,s.wn)(),l=r?{":hover":{backgroundColor:a.colors.actionIconBackgroundHover,cursor:"pointer"}}:{};return(0,o.FD)("div",{role:"button",css:{display:"flex",flexDirection:"row",alignItems:"center",padding:a.spacing.sm,gap:a.spacing.sm,...l},onClick:()=>n(!t),children:[r&&(t?(0,o.Y)(rL.A,{}):(0,o.Y)(t$.A,{})),tZ(i.role),i.tool_call_id?(0,o.Y)(rD.o.Text,{color:"secondary",css:{whiteSpace:"nowrap",display:"inline-flex",alignItems:"center",flex:1,minWidth:0},children:(0,o.Y)(c.sA,{id:"mWl3Qv",defaultMessage:"{toolName} was called in {toolCallId}",values:{toolName:(0,o.Y)(rD.o.Text,{css:{marginRight:a.spacing.xs},bold:!0,children:tq(i)}),toolCallId:(0,o.Y)(tV.m,{componentId:"test",content:i.tool_call_id,children:(0,o.Y)("div",{css:{display:"inline-flex",flexShrink:1,overflow:"hidden",marginLeft:a.spacing.xs},children:(0,o.Y)(rD.o.Text,{css:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},code:!0,children:i.tool_call_id})})})}})}):(0,o.Y)(rD.o.Text,{bold:!0,children:tq(i)})]})};function tX(e){let{toolCall:r}=e,{theme:t}=(0,s.wn)();return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:t.spacing.sm},children:[(0,o.Y)(rD.o.Text,{color:"secondary",css:{display:"flex",flexDirection:"row",alignItems:"center",padding:`0px ${t.spacing.sm+t.spacing.xs}px`},children:(0,o.Y)(c.sA,{id:"hV4vVj",defaultMessage:"called {functionName} in {toolCallId}",values:{functionName:(0,o.FD)(r2.v,{color:"purple",componentId:"shared.model-trace-explorer.function-name-tag",css:{margin:`0px ${t.spacing.xs}px`},children:[(0,o.Y)(eT.A,{}),(0,o.Y)(rD.o.Text,{css:{whiteSpace:"nowrap",marginLeft:t.spacing.xs},children:r.function.name})]}),toolCallId:(0,o.Y)(tV.m,{componentId:"test",content:r.id,children:(0,o.Y)("div",{css:{display:"inline-flex",flexShrink:1,overflow:"hidden",marginLeft:t.spacing.xs},children:(0,o.Y)(rD.o.Text,{css:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},code:!0,color:"secondary",children:r.id})})})}})}),(0,o.Y)(tF,{data:r.function.arguments})]},r.id)}let tQ=e=>{try{return{content:JSON.stringify(JSON.parse(e),null,2),isJson:!0}}catch(r){return{content:e,isJson:!1}}};function t0(e){let{content:r,shouldDisplayCodeSnippet:t}=e,{theme:n}=(0,s.wn)();if(!r)return null;if(t)return(0,o.Y)(tF,{data:r,searchFilter:"",activeMatch:null,containsActiveMatch:!1,renderMode:ev.JSON});return(0,o.Y)("div",{css:{padding:n.spacing.sm,paddingTop:0,marginBottom:-n.typography.fontSizeBase},children:(0,o.Y)(tM,{children:r})})}function t1(e){var r;let{message:t,className:n}=e,{theme:a}=(0,s.wn)(),[l,d]=(0,i.useState)(!1),{content:u,isJson:p}=tQ(null!=(r=t.content)?r:""),g=p&&("tool"===t.role||"function"===t.role),m=!g&&u.length>300,f=m&&!l?`${u.slice(0,300)}...`:u;return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",width:"100%",borderRadius:a.borders.borderRadiusSm,border:`1px solid ${a.colors.border}`,backgroundColor:a.colors.backgroundPrimary,overflow:"hidden"},className:n,children:[(0,o.Y)(tJ,{isExpandable:m,expanded:l,setExpanded:d,message:t}),(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:a.spacing.sm},children:[!(0,Z.isNil)(t.tool_calls)&&t.tool_calls.map(e=>(0,o.Y)(tX,{toolCall:e},e.id)),(0,o.Y)(t0,{content:f,shouldDisplayCodeSnippet:g})]}),m&&(0,o.Y)(rO.$n,{componentId:l?"shared.model-trace-explorer.chat-message-see-less":"shared.model-trace-explorer.chat-message-see-more",icon:l?(0,o.Y)(rk.A,{}):(0,o.Y)(rL.A,{}),type:"tertiary",onClick:()=>d(!l),css:{display:"flex",width:"100%",padding:a.spacing.md,borderRadius:"0px !important"},children:l?(0,o.Y)(c.sA,{id:"gTEFCD",defaultMessage:"See less"}):(0,o.Y)(c.sA,{id:"6fP+8o",defaultMessage:"See more"})})]})}function t2(e){let{messages:r}=e,{theme:t}=(0,s.wn)();if((0,Z.isNil)(r))return null;return(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:t.spacing.sm},children:r.map((e,r)=>(0,o.Y)(t1,{message:e},r))})}let t3=e=>{let{sectionKey:r,title:t,children:n,withBorder:a=!1,className:l}=e,[c,d]=(0,i.useState)(!0),{theme:u}=(0,s.wn)();return(0,o.FD)("div",{className:l,css:{display:"flex",flexDirection:"column",borderRadius:u.borders.borderRadiusMd},children:[(0,o.FD)("div",{css:{alignItems:"center",display:"flex",flexDirection:"row",gap:u.spacing.xs,padding:a?u.spacing.sm:0,background:a?u.colors.backgroundSecondary:void 0,borderTopLeftRadius:u.borders.borderRadiusMd,borderTopRightRadius:u.borders.borderRadiusMd,borderBottomLeftRadius:c?0:u.borders.borderRadiusMd,borderBottomRightRadius:c?0:u.borders.borderRadiusMd,border:a?`1px solid ${u.colors.border}`:void 0,marginBottom:a?0:u.spacing.sm},children:[(0,o.Y)(rO.$n,{size:"small",componentId:`shared.model-trace-explorer.expand-${r}`,type:"tertiary",icon:c?(0,o.Y)(rL.A,{}):(0,o.Y)(t$.A,{}),onClick:()=>d(!c)}),(0,o.Y)(rD.o.Title,{withoutMargins:!0,level:4,css:{width:"100%"},children:t})]}),c&&(0,o.Y)("div",{css:{border:a?`1px solid ${u.colors.border}`:void 0,borderTop:"none",borderBottomLeftRadius:a?u.borders.borderRadiusMd:void 0,borderBottomRightRadius:a?u.borders.borderRadiusMd:void 0,padding:a?u.spacing.sm:0},children:n})]})};function t5(e){let{chatMessages:r,chatTools:t}=e,{theme:n}=(0,s.wn)();return(0,o.FD)("div",{css:{overflowY:"auto",padding:n.spacing.md},"data-testid":"model-trace-explorer-chat-tab",children:[t&&(0,o.Y)(t3,{css:{marginBottom:n.spacing.sm},title:(0,o.Y)(c.sA,{id:"Cjq57+",defaultMessage:"Tools"}),sectionKey:"messages",children:(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:n.spacing.sm},children:t.map(e=>(0,o.Y)(tH,{tool:e},e.function.name))})}),(0,o.Y)(t3,{title:(0,o.Y)(c.sA,{id:"AAdQxU",defaultMessage:"Messages"}),sectionKey:"messages",children:(0,o.Y)(t2,{messages:r})})]})}function t4(e){let{activeSpan:r,className:t,searchFilter:n,activeMatch:a}=e,{theme:l}=(0,s.wn)(),d=(0,i.useMemo)(()=>e1(null==r?void 0:r.inputs),[r]),u=(0,i.useMemo)(()=>e1(null==r?void 0:r.outputs),[r]);if((0,Z.isNil)(r))return null;let p=d.length>0,g=u.length>0,m=!(0,Z.isNil)(a)&&a.span.key===r.key;return(0,o.FD)("div",{"data-testid":"model-trace-explorer-default-span-view",children:[p&&(0,o.Y)(t3,{withBorder:!0,css:{marginBottom:l.spacing.sm},sectionKey:"input",title:(0,o.Y)("div",{css:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},children:(0,o.Y)(c.sA,{id:"/TX1Az",defaultMessage:"Inputs"})}),children:(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:l.spacing.sm},children:d.map((e,r)=>{let{key:t,value:i}=e;return(0,o.Y)(tz,{title:t,data:i,searchFilter:n,activeMatch:a,containsActiveMatch:m&&"inputs"===a.section&&a.key===t},t||r)})})}),g&&(0,o.Y)(t3,{withBorder:!0,sectionKey:"output",title:(0,o.Y)("div",{css:{display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%"},children:(0,o.Y)(c.sA,{id:"ZstVNI",defaultMessage:"Outputs"})}),children:(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:l.spacing.sm},children:u.map(e=>{let{key:r,value:t}=e;return(0,o.Y)(tz,{title:r,data:t,searchFilter:n,activeMatch:a,containsActiveMatch:m&&"outputs"===a.section&&a.key===r},r)})})})]})}let t7=e=>e?{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}:{whiteSpace:"nowrap"},t6=e=>{let{itemKey:r,itemValue:t,charLimit:n=18,maxWidth:i=150,className:a}=e,{shouldTruncateKey:s,shouldTruncateValue:l}=function(e,r,t){let n=e.length+r.length,o=e.length>r.length,i=o?r.length:e.length;if(n<=t)return{shouldTruncateKey:!1,shouldTruncateValue:!1};if(i>t/2)return{shouldTruncateKey:!0,shouldTruncateValue:!0};return{shouldTruncateKey:o,shouldTruncateValue:!o}}(r,t,n);return(0,o.Y)(tV.m,{componentId:"shared.model-trace-explorer.key-value-tag.hover-tooltip",content:`${r}: ${t}`,children:(0,o.Y)(r2.v,{componentId:"shared.model-trace-explorer.key-value-tag",className:a,children:(0,o.FD)("span",{css:{maxWidth:i,display:"inline-flex"},children:[(0,o.Y)(rD.o.Text,{bold:!0,css:t7(s),size:"sm",children:r}),":\xa0",(0,o.Y)(rD.o.Text,{css:t7(l),size:"sm",children:t})]})})})};function t9(e){let{text:r,metadataTags:t,setExpanded:n,logDocumentClick:i}=e,{theme:a}=(0,s.wn)();return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column"},children:[(0,o.Y)("div",{role:"button",onClick:()=>{n(!1),i("collapse")},css:{display:"flex",flexDirection:"row",alignItems:"center",cursor:"pointer",padding:`${a.spacing.sm}px ${a.spacing.md}px`,height:a.typography.lineHeightBase,boxSizing:"content-box","&:hover":{backgroundColor:a.colors.backgroundSecondary}},children:(0,o.Y)(eb.A,{})}),(0,o.Y)("div",{css:{padding:a.spacing.md,paddingBottom:0},children:(0,o.Y)(tM,{children:r})}),(0,o.Y)("div",{css:{padding:a.spacing.md,paddingTop:0},children:t.map(e=>{let{key:r,value:t}=e;return(0,o.Y)(t6,{itemKey:r,itemValue:t},r)})}),(0,o.Y)(rO.$n,{css:{width:"100%",padding:a.spacing.sm},componentId:"shared.model-trace-explorer.retriever-document-collapse",icon:(0,o.Y)(rk.A,{}),type:"tertiary",onClick:()=>n(!1),children:(0,o.Y)(c.sA,{id:"AgjhWE",defaultMessage:"See less"})})]})}function t8(e){let{text:r,metadataTags:t,setExpanded:n,logDocumentClick:i}=e,{theme:a}=(0,s.wn)();return(0,o.FD)("div",{role:"button",onClick:()=>{n(!0),i("expand")},css:{display:"flex",flexDirection:"row",padding:`${a.spacing.sm}px ${a.spacing.md}px`,gap:a.spacing.sm,alignItems:"center",justifyContent:"space-between",cursor:"pointer","&:hover":{backgroundColor:a.colors.backgroundSecondary}},children:[(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",gap:a.spacing.sm,alignItems:"center",minWidth:0,flexShrink:1},children:[(0,o.Y)(eb.A,{}),(0,o.Y)(rD.o.Text,{ellipsis:!0,size:"md",children:r})]}),(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",gap:a.spacing.sm},children:[t.length>0?(0,o.Y)(t6,{css:{margin:0},itemKey:t[0].key,itemValue:t[0].value}):null,t.length>1?(0,o.Y)(tV.m,{componentId:"shared.model-trace-explorer.tag-count.hover-tooltip",content:t.slice(1).map(e=>{let{key:r,value:t}=e;return(0,o.Y)("span",{css:{display:"inline-block"},children:`${r}: ${t}`},r)}),children:(0,o.FD)(r2.v,{componentId:"shared.model-trace-explorer.tag-count",css:{whiteSpace:"nowrap",margin:0},children:["+",t.length-1]})}):null]})]})}function ne(e){let{text:r,metadata:t}=e,[n,a]=(0,i.useState)(!1),s=e1(t),l=V(),c=en(),d=(0,i.useCallback)(e=>{O(l,c,{eventType:"component_click",eventEntity:{entityType:"component",entitySubType:"div",entityId:`shared.model-trace-explorer.retriever-document-${e}`},eventPayload:{interactionSubject:!0}})},[l,c]);return n?(0,o.Y)(t9,{text:r,metadataTags:s,setExpanded:a,logDocumentClick:d}):(0,o.Y)(t8,{text:r,metadataTags:s,setExpanded:a,logDocumentClick:d})}var nr=t(98026),nt=t(36376),nn=t(79429);function no(e){let{shouldRenderMarkdown:r,setShouldRenderMarkdown:t}=e,{theme:n}=(0,s.wn)();return(0,o.FD)(nr.d,{"data-testid":"model-trace-explorer-render-mode-toggle",name:"render-mode",size:"small",componentId:`shared.model-trace-explorer.toggle-markdown-rendering-${!r}`,value:r,onChange:e=>{t(e.target.value)},children:[(0,o.Y)(nr.E,{"data-testid":"model-trace-explorer-render-raw-input-button",value:!1,children:(0,o.Y)(tV.m,{componentId:"shared.model-trace-explorer.raw-input-rendering-tooltip",content:(0,o.Y)(c.sA,{id:"NMxAot",defaultMessage:"Raw input"}),children:(0,o.Y)("div",{css:{display:"flex",alignItems:"center"},children:(0,o.Y)(nt.A,{css:{fontSize:n.typography.fontSizeLg}})})})}),(0,o.Y)(nr.E,{"data-testid":"model-trace-explorer-render-default-button",value:!0,children:(0,o.Y)(tV.m,{componentId:"shared.model-trace-explorer.default-rendering-tooltip",content:(0,o.Y)(c.sA,{id:"xwe7WH",defaultMessage:"Default rendering"}),children:(0,o.Y)("div",{css:{display:"flex",alignItems:"center"},children:(0,o.Y)(nn.A,{css:{fontSize:n.typography.fontSizeLg}})})})})]})}function ni(e){let{activeSpan:r,className:t,searchFilter:n,activeMatch:a}=e,{theme:l}=(0,s.wn)(),[d,u]=(0,i.useState)(!0),p=(0,i.useMemo)(()=>e1(r.inputs),[r]),g=r.outputs,m=p.length>0,f=!(0,Z.isNil)(a)&&a.span.key===r.key,h=f&&"outputs"===a.section;return(0,o.FD)("div",{className:t,"data-testid":"model-trace-explorer-retriever-span-view",children:[m&&(0,o.Y)(t3,{sectionKey:"input",css:{marginBottom:l.spacing.sm},title:(0,o.Y)(c.sA,{id:"/TX1Az",defaultMessage:"Inputs"}),children:(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:l.spacing.sm},children:p.map((e,r)=>{let{key:t,value:i}=e;return(0,o.Y)(tz,{title:t,data:i,searchFilter:n,activeMatch:a,containsActiveMatch:f&&"inputs"===a.section&&a.key===t},t||r)})})}),(0,o.Y)(t3,{sectionKey:"output",title:(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",gap:l.spacing.sm},children:[(0,o.Y)(c.sA,{id:"ThYYz6",defaultMessage:"Documents"}),(0,o.Y)(r2.v,{componentId:"shared.model-trace-explorer.document-count",children:g.length})]}),!h&&(0,o.Y)(no,{shouldRenderMarkdown:d,setShouldRenderMarkdown:u})]}),children:d&&!h?(0,o.Y)("div",{css:{border:`1px solid ${l.colors.border}`,borderRadius:l.legacyBorders.borderRadiusMd},children:g.map((e,r)=>(0,o.Y)("div",{css:{borderBottom:r!==g.length-1?`1px solid ${l.colors.border}`:""},children:(0,o.Y)(ne,{text:e.page_content,metadata:e.metadata},r)},r))}):(0,o.Y)("div",{css:{border:`1px solid ${l.colors.border}`,borderRadius:l.legacyBorders.borderRadiusMd,padding:l.spacing.md},children:(0,o.Y)(tz,{title:"",data:JSON.stringify(g,null,2),searchFilter:n,activeMatch:a,containsActiveMatch:f&&"outputs"===a.section})})})]})}function na(e){let{activeSpan:r,className:t,searchFilter:n,activeMatch:i}=e,{theme:a}=(0,s.wn)();if(!(0,Z.isNil)(r)&&e5(r))return(0,o.Y)("div",{css:{overflowY:"auto",padding:a.spacing.md},className:t,"data-testid":"model-trace-explorer-content-tab",children:(0,o.Y)(ni,{activeSpan:r,className:t,searchFilter:n,activeMatch:i})});return(0,o.Y)("div",{css:{overflowY:"auto",padding:a.spacing.md},className:t,"data-testid":"model-trace-explorer-content-tab",children:(0,o.Y)(t4,{activeSpan:r,className:t,searchFilter:n,activeMatch:i})})}var ns=t(77252);function nl(e){let{activeSpan:r,searchFilter:t,activeMatch:n}=e,{theme:i}=(0,s.wn)(),{events:a}=r,l=!(0,Z.isNil)(n)&&n.span.key===r.key;if(!Array.isArray(a)||0===a.length)return(0,o.Y)("div",{css:{marginTop:i.spacing.md},children:(0,o.Y)(r0.S,{description:(0,o.Y)(c.sA,{id:"xnr5KT",defaultMessage:"No events found"})})});return(0,o.Y)("div",{css:{padding:i.spacing.md},children:a.map((e,r)=>{let a=e.attributes,s="exception"===e.name?(0,o.FD)(o.FK,{children:[(0,o.Y)(ns.A,{css:{marginRight:i.spacing.sm},color:"danger"}),(0,o.Y)(rD.o.Text,{color:"error",bold:!0,children:"Exception"})]}):e.name;if(!a)return null;return(0,o.Y)(t3,{sectionKey:e.name,title:s,withBorder:!0,children:(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:i.spacing.sm},children:Object.keys(a).map(i=>{let s=e4(e.name,r,i);return(0,o.Y)(tz,{title:i,data:JSON.stringify(a[i],null,2),searchFilter:t,activeMatch:n,containsActiveMatch:l&&"events"===n.section&&n.key===s,initialRenderMode:ev.TEXT},s)})})},`${e.name}-${r}`)})})}function nc(e){let{count:r}=e,{theme:t}=(0,s.wn)();return(0,o.Y)("div",{css:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:t.typography.fontSizeBase,height:t.typography.fontSizeBase,backgroundColor:t.colors.actionDangerPrimaryBackgroundDefault,padding:t.spacing.xs,marginLeft:t.spacing.xs,boxSizing:"border-box"},children:(0,o.Y)("span",{css:{color:t.colors.actionPrimaryTextDefault,fontSize:11},children:r})})}var nd=t(12469);let nu=()=>{let{assessmentsPaneExpanded:e,setAssessmentsPaneExpanded:r,assessmentsPaneEnabled:t}=rZ();return(0,o.Y)(nr.d,{css:{display:"block"},name:"shared.model-trace-explorer.assessments-pane-toggle",componentId:"shared.model-trace-explorer.assessments-pane-toggle",value:e,size:"small",children:(0,o.Y)(nr.E,{value:!0,disabled:!t,icon:(0,o.Y)(nd.A,{}),onClick:()=>null==r?void 0:r(!e),css:{"& > span":{display:"flex",alignItems:"center"}},children:!e&&(0,o.Y)(c.sA,{id:"r/fxMt",defaultMessage:"Assessments"})})})};var np=t(94748),ng=t(7024),nm=t(27805),nf=t(59574),nh=t(51165),nE=t(91236),nv=t(44958);let ny=(0,nv.fH)("Dubois::NotificationOpen");(0,nv.fH)("Dubois::NotificationClose"),(0,nE.g)("Dubois::notificationChanged");var nb=t(73733);let nx=e=>{let r=e.split("/");if(1===r.length)return e;if(2===r.length)return r[1];return r.slice(2).join("/")},nS=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,t=Math.max(0,Math.floor((r.getTime()-e)/1e3)),n=Math.floor(t/31536e3);if(n>=1)return(0,o.Y)(c.sA,{id:"16BvfJ",defaultMessage:"{timeSince, plural, =1 {1 year} other {# years}} ago",values:{timeSince:n}});if((n=Math.floor(t/2592e3))>=1)return(0,o.Y)(c.sA,{id:"5ZAXeS",defaultMessage:"{timeSince, plural, =1 {1 month} other {# months}} ago",values:{timeSince:n}});if((n=Math.floor(t/86400))>=1)return(0,o.Y)(c.sA,{id:"tLb7+M",defaultMessage:"{timeSince, plural, =1 {1 day} other {# days}} ago",values:{timeSince:n}});if((n=Math.floor(t/3600))>=1)return(0,o.Y)(c.sA,{id:"aOW396",defaultMessage:"{timeSince, plural, =1 {1 hour} other {# hours}} ago",values:{timeSince:n}});if((n=Math.floor(t/60))>=1)return(0,o.Y)(c.sA,{id:"7jsqqe",defaultMessage:"{timeSince, plural, =1 {1 minute} other {# minutes}} ago",values:{timeSince:n}});return(0,o.Y)(c.sA,{id:"93iLUV",defaultMessage:"{timeSince, plural, =1 {1 second} other {# seconds}} ago",values:{timeSince:t}})},nT=e=>{if("value"in e)return e.value;try{return JSON.parse(e.serialized_value.value)}catch(r){return e.serialized_value.value}},nI=e=>{let{formValue:r,dataType:t,isFeedback:n}=e;if(n)return{feedback:{value:r}};if("json"===t)return{expectation:{serialized_value:{value:String(r),serialization_format:"JSON_FORMAT"}}};return{expectation:{value:r}}};var n_=function(e){return e.UserInputError="UserInputError",e.UnexpectedSystemStateError="UnexpectedSystemStateError",e.ServerError="ServerError",e.SessionError="SessionError",e.NetworkError="NetworkError",e.ExternalClientError="ExternalClientError",e.ApplicationError="ApplicationError",e.UnknownError="UnknownError",e}({});_.jZ.ErrorType_Type.USER_INPUT_ERROR,_.jZ.ErrorType_Type.UNEXPECTED_SYSTEM_STATE_ERROR,_.jZ.ErrorType_Type.SERVER_ERROR,_.jZ.ErrorType_Type.SESSION_ERROR,_.jZ.ErrorType_Type.NETWORK_ERROR,_.jZ.ErrorType_Type.EXTERNAL_CLIENT_ERROR,_.jZ.ErrorType_Type.APPLICATION_ERROR,_.jZ.ErrorType_Type.UNKNOWN_ERROR;var nA=function(e){return e.AppsDeletedMarketplaceListingError="AppsDeletedMarketplaceListingError",e.AwsQuickstartError="AwsQuickstartError",e.BadRequestError="BadRequestError",e.BillingFormValidationError="BillingFormValidationError",e.CeSignUpAADUnauthorizedError="CeSignUpAADUnauthorizedError",e.CeSignUpAlreadyExistsError="CeSignUpAlreadyExistsError",e.CeSignUpMicrosoftDisabledError="CeSignUpMicrosoftDisabledError",e.CeSignUpSignUpError="CeSignUpSignUpError",e.CeSignUpKarmaRejectionError="CeSignUpKarmaRejectionError",e.CeSignUpUnknownError="CeSignUpUnknownError",e.ComputeCreateError="ComputeCreateError",e.CsrfTokenExpiredError="CsrfTokenExpiredError",e.CsrfTokenRefreshFailed="CsrfTokenRefreshFailed",e.CybersourceSubmissionError="CybersourceSubmissionError",e.DabsCancelledCommandError="DabsCancelledCommandError",e.DabsCliSummaryError="DabsCliSummaryError",e.DabsNoInternetConnectionError="DabsNoInternetConnectionError",e.DabsNoTargetError="DabsNoTargetError",e.DabsParseOutputError="DabsParseOutputError",e.DabsServerlessNotAvailableError="DabsServerlessNotAvailableError",e.DabsServerlessPermissionError="DabsServerlessPermissionError",e.DabsServerlessTerminatedError="DabsServerlessTerminatedError",e.DabsServerlessResourceExhaustedError="DabsServerlessResourceExhaustedError",e.DabsRunnerRateLimitError="DabsRunnerRateLimitError",e.DabsUnexpectedRunnerError="DabsUnexpectedRunnerError",e.DatasetRunNotFoundError="DatasetRunNotFoundError",e.FeatureNotEnabledError="FeatureNotEnabledError",e.FormValidationError="FormInputError",e.GenericFetchDataError="GenericFetchDataError",e.GenericNetworkRequestError="GenericNetworkRequestError",e.GraphQLGenericError="GraphQLGenericError",e.GraphQLNetworkError="GraphQLNetworkError",e.IngestionBrickstoreDeleteGatewayPipelineError="IngestionBrickstoreDeleteGatewayPipelineError",e.IngestionBrickstoreDeleteApplierPipelineError="IngestionBrickstoreDeleteApplierPipelineError",e.IngestionBrickstoreDeletePipelinesError="IngestionBrickstoreDeletePipelinesError",e.IngestionBrickstoreDeleteStopGatewayPipelineError="IngestionBrickstoreDeleteStopGatewayPipelineError",e.IngestionBrickstorePipelinePageFindApplierPipelineFromGatewayError="IngestionBrickstorePipelinePageFindApplierPipelineFromGatewayError",e.IngestionBrickstorePipelinePageGetApplierPipelineError="IngestionBrickstorePipelinePageGetApplierPipelineError",e.IngestionCreateTableError="IngestionCreateTableError",e.IngestionCreateTablePreviewError="IngestionCreateTablePreviewError",e.IngestionCreateTableUploadError="IngestionCreateTableUploadError",e.IngestionSetupUnsupportedSpecificationError="IngestionSetupUnsupportedSpecificationError",e.IngestionSetupWizardConnectionFormOauthLoginError="IngestionSetupWizardConnectionFormOauthLoginError",e.IngestionSetupWizardCreateGatewayError="IngestionSetupWizardCreateGatewayError",e.IngestionSetupWizardCreatePipelineError="IngestionSetupWizardCreatePipelineError",e.IngestionSetupWizardCreatePipelineErrorMissingId="IngestionSetupWizardCreatePipelineErrorMissingId",e.IngestionSetupWizardCreateConnectionError="IngestionSetupWizardCreateConnectionError",e.IngestionSetupWizardEditPipelineError="IngestionSetupWizardEditPipelineError",e.IngestionSetupWizardErrorCreatePipelineSchedule="IngestionSetupWizardErrorCreatePipelineSchedule",e.IngestionSetupWizardErrorFetchPipelineUpdateDetails="IngestionSetupWizardErrorFetchPipelineUpdateDetails",e.IngestionSetupWizardErrorFetchSourceObjects="IngestionSetupWizardErrorFetchSourceObjects",e.IngestionSetupWizardPipelineUpdateError="IngestionSetupWizardPipelineUpdateError",e.IngestionSetupWizardStartPipelineError="IngestionSetupWizardStartPipelineError",e.IngestionSetupWizardStartPipelineErrorMissingId="IngestionSetupWizardStartPipelineErrorMissingId",e.IngestionSetupWizardStopPipelineError="IngestionSetupWizardStopPipelineError",e.IngestionSetupWizardPatchManagedCatalogError="IngestionSetupWizardPatchManagedCatalogError",e.IngestionVolumesUploadDuplicateFileNameError="IngestionVolumesUploadDuplicateFileNameError",e.IngestionVolumesUploadFileError="IngestionVolumesUploadFileError",e.IngestionVolumesUploadFileSizeExceededError="IngestionVolumesUploadFileSizeExceededError",e.IngestionVolumesUploadMaxNumFilesExceededError="IngestionVolumesUploadMaxNumFilesExceededError",e.InternalServerError="InternalServerError",e.DbsqlUiInvalidUserSession="DbsqlUiInvalidUserSession",e.LongFormCreateWorkspaceV2FormValidationError="LongFormCreateWorkspaceV2FormValidationError",e.MaxAccountsError="MaxAccounts",e.NotebookCreationError="NotebookCreationError",e.NotebookCreationUserError="NotebookCreationUserError",e.NotFoundError="NotFoundError",e.PermissionError="PermissionError",e.PrefetchError="PrefetchError",e.PrefetchUserError="PrefetchUserError",e.RateLimitedError="RateLimitedError",e.RouteNotFoundError="RouteNotFoundError",e.ResourceAlreadyExistsError="ResourceAlreadyExistsError",e.ScriptInjectionError="ScriptInjectionError",e.ServiceUnavailableError="ServiceUnavailableError",e.ServerUnreachableError="ServerUnreachableError",e.SessionExpiredError="SessionExpiredError",e.SignInInvalidUsernamePasswordError="SignInInvalidUsernamePasswordError",e.SignInExpiredPasswordError="SignInExpiredPasswordError",e.SignInMethodUnauthorizedError="SignInMethodUnauthorizedError",e.SignInMismatchAuthMethod="SignInMismatchAuthMethod",e.SignInGeoIPAccessDeniedError="SignInGeoIPAccessDeniedError",e.SignInUserNotRegisteredError="SignInUserNotRegisteredError",e.SignInSAMLAuthError="SignInSAMLAuthError",e.SignInSAMLLoginError="SignInSAMLLoginError",e.SignInSAMLNotEnabledError="SignInSAMLNotEnabledError",e.SignInSAMLAndUnifiedLoginEnabledError="SignInSAMLAndUnifiedLoginEnabledError",e.SignInNotAccountUserError="SignInNotAccountUserError",e.SignInMagicCodeInvalidError="SignInMagicCodeInvalidError",e.SignInMagicCodeUserNotInAccountError="SignInMagicCodeUserNotInAccountError",e.SignInMagicCodeMissingTosError="SignInMagicCodeMissingTosError",e.SignInMissingAccountIdError="SignInMissingAccountIdError",e.SignInMissingLoginCodeOptionError="SignInMissingLoginCodeOptionError",e.SignInInvalidAccountIdError="SignInInvalidAccountIdError",e.SignInPasswordLoginDisabledError="SignInPasswordLoginDisabledError",e.SignInInvalidAuthorizationError="SignInInvalidAuthorizationError",e.SignInInvalidUserStateError="SignInInvalidUserStateError",e.SignInInvalidAccountUserAssociationError="SignInInvalidAccountUserAssociationError",e.SignInMfaNotEnabledError="SignInMfaNotEnabledError",e.SignInAccountNotFoundError="SignInAccountNotFoundError",e.SignInWebAuthnError="SignInWebAuthnError",e.SignInOIDCLoginError="SignInOIDCLoginError",e.SignInOIDCAuthError="SignInOIDCAuthError",e.SignInUnknownError="SignInUnknownError",e.SignUpAlreadyExistsError="SignUpAlreadyExistsError",e.SignUpGetAccountAlreadyExistsError="SignUpGetAccountAlreadyExistsError",e.SignUpMicrosoftDisabledError="SignUpMicrosoftDisabledError",e.SignUpAADUnauthorizedError="SignUpAADUnauthorizedError",e.SignUpInvalidInviteCodeError="SignUpInvalidInviteCodeError",e.SignUpInvalidLinkError="SignUpInvalidLinkError",e.SignUpSignUpError="SignUpSignUpError",e.SignUpUnknownError="SignUpUnknownError",e.StorageCreateError="StorageCreateError",e.SubscriptionUpgradeError="SubscriptionUpgradeError",e.UnauthorizedError="UnauthorizedError",e.UnknownError="UnknownError",e.WorkspaceCreateError="WorkspaceCreateError",e.WorkspaceCreationModalFormValidationError="WorkspaceCreationModalFormValidationError",e.WorkspaceMetastoreAssignmentError="WorkspaceMetastoreAssignmentError",e}({});function nR(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class nw extends Error{constructor(e,r){let t=r;if("object"==typeof r){let e=Object.keys(r);1===e.length&&"cause"===e[0]&&function(e){return"string"==typeof e||e instanceof Error||"object"==typeof e&&null!==e}(r.cause)&&(t=r.cause)}super(e,{cause:t}),nR(this,"isUserError",!1)}}let nN=e=>{if(e instanceof nw)return e;if(e instanceof Error&&("networkError"in e||"graphQLErrors"in e))return nY(e);if(e instanceof Response)return nC(e);return new nz(e)},nY=e=>{if("networkError"in e&&function(e){return e instanceof Error&&e.hasOwnProperty("response")}(e.networkError))return nC(e.networkError.response,e.networkError);return new nk(e)},nC=(e,r)=>{if((0,d.W)("databricks.fe.infra.detectNonDatabricksResponse",!1)&&!function(e){let r=e.headers;return"databricks"===(r instanceof Headers?r.get("server"):r.server)}(e))return new nM(e.status);let t=nD.getNetworkRequestErrorDetailsFromResponse(e);switch(e.status){case 400:return new nL(t,r);case 401:return new nj(t,r);case 403:return new nF(t,r);case 404:return new nU(t,r);case 429:return new nB(t,r);case 500:return new nP(t,r);case 503:return new nW(t,r);default:return new nO(t,r)}};class nM extends nw{constructor(e,r){super("The server cannot be reached. Please check your network connection.",{cause:r}),nR(this,"errorLogType",n_.NetworkError),nR(this,"errorName",nA.ServerUnreachableError),nR(this,"displayMessage",(0,o.Y)(c.sA,{id:"NG6t6F",defaultMessage:"The server cannot be reached. Please check your network connection."})),nR(this,"isUserError",!0),nR(this,"status",void 0),this.status=e}}class nD extends nw{constructor(e,r,t){super(e,t),nR(this,"status",void 0),nR(this,"requestId",void 0),nR(this,"response",void 0),nR(this,"errorCode",void 0),nR(this,"metadata",void 0),nR(this,"reason",void 0),this.status=r.status,this.response=r.response,this.requestId=r.requestId,this.errorCode=r.errorCode,this.metadata=r.metadata,this.reason=r.reason}}nR(nD,"getNetworkRequestErrorDetailsFromResponse",e=>{var r;let t=null!=(r=e.headers.get("x-request-id"))?r:void 0;return{status:e.status,requestId:t,response:e}});class nO extends nD{constructor(e,r){super("A network error occurred.",e,r),nR(this,"errorLogType",n_.ServerError),nR(this,"errorName",nA.GenericNetworkRequestError),nR(this,"displayMessage",(0,o.Y)(c.sA,{id:"/CaNq/",defaultMessage:"A network error occurred."}))}}class nk extends nw{constructor(e){super("A GraphQL error occurred.",e),nR(this,"errorLogType",n_.ApplicationError),nR(this,"errorName",nA.GraphQLGenericError),nR(this,"displayMessage",(0,o.Y)(c.sA,{id:"PPPbd+",defaultMessage:"A GraphQL error occurred."}))}}class nL extends nD{constructor(e,r){super("The request was invalid.",e,r),nR(this,"errorLogType",n_.UserInputError),nR(this,"errorName",nA.BadRequestError),nR(this,"displayMessage",(0,o.Y)(c.sA,{id:"Id2mFI",defaultMessage:"The request was invalid."}))}}class nP extends nD{constructor(e,r){super("Internal server error",e,r),nR(this,"errorLogType",n_.ServerError),nR(this,"errorName",nA.InternalServerError),nR(this,"displayMessage",(0,o.Y)(c.sA,{id:"nY1YrF",defaultMessage:"Internal server error"}))}}class nU extends nD{constructor(e,r){super("The requested resource was not found.",e,r),nR(this,"errorLogType",n_.UserInputError),nR(this,"errorName",nA.NotFoundError),nR(this,"displayMessage",(0,o.Y)(c.sA,{id:"R3Lb6z",defaultMessage:"The requested resource was not found."})),nR(this,"isUserError",!0)}}class nF extends nD{constructor(e,r){super("You do not have permission to access this resource.",e,r),nR(this,"errorLogType",n_.UnexpectedSystemStateError),nR(this,"errorName",nA.PermissionError),nR(this,"displayMessage",(0,o.Y)(c.sA,{id:"G6IQTa",defaultMessage:"You do not have permission to access this resource."})),nR(this,"isUserError",!0)}}class nB extends nD{constructor(e,r){super("This request exceeds the maximum queries per second limit. Please wait and try again.",e,r),nR(this,"errorLogType",n_.ServerError),nR(this,"errorName",nA.RateLimitedError),nR(this,"displayMessage",(0,o.Y)(c.sA,{id:"5PlfiT",defaultMessage:"This request exceeds the maximum queries per second limit. Please wait and try again."}))}}class nW extends nD{constructor(e,r){super("Internal server error",e,r),nR(this,"errorLogType",n_.ServerError),nR(this,"errorName",nA.InternalServerError),nR(this,"displayMessage",(0,o.Y)(c.sA,{id:"/XlqZA",defaultMessage:"Service unavailable error"}))}}class nj extends nD{constructor(e,r){super("This request exceeds the maximum queries per second limit. Please wait and try again.",e,r),nR(this,"errorLogType",n_.SessionError),nR(this,"errorName",nA.UnauthorizedError),nR(this,"displayMessage",(0,o.Y)(c.sA,{id:"gqfk5C",defaultMessage:"User is not authorized."}))}}class nz extends nw{constructor(e){super("An unknown error occurred.",e),nR(this,"errorLogType",n_.UnknownError),nR(this,"errorName",nA.UnknownError),nR(this,"displayMessage",(0,o.Y)(c.sA,{id:"bKSd3c",defaultMessage:"An unknown error occurred."}))}}var nG=t(69807),n$=function(e){return e.Axios="unifiedFetchData-axios",e.Fetch="unifiedFetchData-fetch",e}({}),nK=t(41198),nH=t.n(nK),nV=t(87998),nZ=t.n(nV),nq=t(42933),nJ=t.n(nq),nX=t(7159),nQ=t.n(nX),n0=function(e){return e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE",e.PATCH="PATCH",e.HEAD="HEAD",e}({}),n1=function(e){return e.TEXT="TEXT",e.JSON="JSON",e.BLOB="BLOB",e.STREAM="STREAM",e}({}),n2=function(e){return e.EXPIRED_SESSION="expired-session",e.EXPIRED_CSRF_TOKEN="expired-csrf-token",e.JSON_PARSE="json-parse",e}({});let n3=(0,nv.fH)("Data::fetch");function n5(e,r,t,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){t(e);return}s.done?r(l):Promise.resolve(l).then(n,o)}function n4(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}let n7={EXPIRED_SESSION:"Fetch request failed due expired user session"};class n6 extends nw{constructor(e,r){super(r),n4(this,"errorLogType",n_.SessionError),n4(this,"isUserError",!0),n4(this,"displayMessage",void 0),n4(this,"errorName",void 0),this.displayMessage=(0,o.Y)(c.sA,{id:"c/KhOk",defaultMessage:"Your session have expired. Please refresh the page or login again."}),this.errorName=e}}class n9 extends nw{constructor(e){super(`Fetch request failed due to unexpected error: ${e}`),n4(this,"errorLogType",n_.UnknownError),n4(this,"errorName",nA.GenericFetchDataError),n4(this,"displayMessage",void 0),n4(this,"isUserError",!1),n4(this,"fetchErrorType",void 0),this.displayMessage=(0,o.Y)(c.sA,{id:"EprwHD",defaultMessage:"Fetch request failed due to unexpected error"}),this.fetchErrorType=e}}function n8(e,r){let{status:t,statusText:n,body:o,text:i,errorType:a,headers:s,url:l,redirected:c}=e;if(a){var u;let e;switch(a){case n2.EXPIRED_CSRF_TOKEN:e=new n6(nA.CsrfTokenExpiredError,"Fetch request failed due to expired CSRF token");break;case n2.EXPIRED_SESSION:e=new n6(nA.SessionExpiredError,n7.EXPIRED_SESSION);break;default:e=new n9(a)}throw u=e,r.stack&&!u.__initiatorStack&&(u.__initiatorStack=r.stack),e}let p=new Response((0,d.W)("databricks.fe.wexp.enableStreamSupportAtMfeFetch",!0)&&null!=o&&!o.locked?o:i,{status:t,statusText:n,headers:new Headers(s)});return Object.defineProperty(p,"url",{value:l}),Object.defineProperty(p,"redirected",{value:c}),p}function oe(e,r,t,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){t(e);return}s.done?r(l):Promise.resolve(l).then(n,o)}let or=()=>({ABORTED_MSG:"Aborted",NETWORK_ERROR_MSG:"Network Error",NETWORK_ERROR_CODE:"ERR_NETWORK"});function ot(e,r){let{status:t,statusText:n,text:o,blob:i,headers:a}=e;return{config:r,status:t,statusText:n,data:"blob"===r.responseType?i:o,headers:a}}let on=e=>r=>{var t;return(t=function*(){let t=(0,d.W)("databricks.fe.infra.useCustomAxiosErrorProcessing",!1);try{let{method:n=n0.GET,data:o,headers:i,onUploadProgress:a}=r,s=yield n3.call({resource:function(e){let{url:r,baseURL:t,params:n,paramsSerializer:o}=e;p()(void 0!==r,"URL must be specified");let i=nZ()(t,r);return nQ()(i,n,o)}(r),options:{method:function(e){let r=e.toUpperCase();if(!Object.values(n0).includes(r))throw Error(`Fetch request method ${e} is not supported. Only ${Object.values(n0).join(", ")} are supported.`);return r}(n),body:o,responseFormat:"blob"===r.responseType?n1.BLOB:n1.TEXT,headers:i,onUploadProgress:a,requestContext:e}}),l=new Promise((e,n)=>{if(t){let t=ot(s,r);if(!s.ok){var o;let e=n8(s,function(e){if(e.__initiatorStack)return{stack:e.__initiatorStack};return{}}(r)),i=(o=nC(e),Object.defineProperties(o,{config:{value:t.config},isAxiosError:{value:!0},response:{value:t},toJSON:{value:()=>({})}}),o);n(i);return}e(t);return}return nJ()(e,n,ot(s,r))});return m.iT.sev2BurnRate(f.Es.Navigation,n$.Axios,nG.i1.P999,nG.Ip.Min10,!0),l}catch(e){throw oS(e)&&(oI(e)?m.iT.log("unifiedFetchData-ignored-axios",f.Es.Navigation,e):m.iT.sev2BurnRate(f.Es.Navigation,n$.Axios,nG.i1.P999,nG.Ip.Min10,!1,e)),e}},function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(e){oe(i,n,o,a,s,"next",e)}function s(e){oe(i,n,o,a,s,"throw",e)}a(void 0)})})()},oo=on();((e,r)=>{let t=e?on(e):oo,n=nH().create({...r,adapter:t});return n.interceptors.request.use(e=>(e.__initiatorStack=Error().stack,e))})();var oi=t(55266),oa=function(e){return e.AccountsConsoleMonolithUi="accounts-console-monolith-ui",e.DbsqlUi="dbsql-ui",e.JobsUi="jobs-ui",e.MonolithUi="monolith-ui",e.NotSet="not-set",e}({});let os={currentValue:!1};function ol(){return os.currentValue}let oc={esComponent:f.Es.DbsqlUi,isExceptionKnown:function(e){let r=(0,d.W)("databricks.fe.ui.knownUncaughtJsExceptionMessageRegexes.dbsqlUi","[]");return(0,oi.o)(e,r,f.Es.DbsqlUi)},shouldIgnoreException:function(e){let r=(0,d.W)("databricks.fe.ui.uncaughtJsExceptionMessageRegexesToIgnore.dbsqlUi","[]");return(0,oi.o)(e,r,f.Es.DbsqlUi)},uiDeployableId:oa.DbsqlUi,uiVersionId:"dbsql"},od={esComponent:f.Es.WorkflowsAuthoring,isExceptionKnown:function(e){let r=(0,d.W)("databricks.fe.ui.knownUncaughtJsExceptionMessageRegexes.jobsUi","[]");return(0,oi.o)(e,r,f.Es.WorkflowsAuthoring)},shouldIgnoreException:function(e){let r=(0,d.W)("databricks.fe.ui.uncaughtJsExceptionMessageRegexesToIgnore.jobsUi","[]");return(0,oi.o)(e,r,f.Es.WorkflowsAuthoring)},uiDeployableId:oa.JobsUi,uiVersionId:"jaws"},ou={esComponent:f.Es.UiInfra,isExceptionKnown:function(e){let r=(0,d.W)("databricks.fe.ui.knownUncaughtJsExceptionMessageRegexes.monolithUi","[]");return(0,oi.o)(e,r,f.Es.UiInfra)},shouldIgnoreException:function(e){let r=(0,d.W)("databricks.fe.ui.uncaughtJsExceptionMessageRegexesToIgnore.monolithUi","[]");return(0,oi.o)(e,r,f.Es.UiInfra)},uiDeployableId:oa.MonolithUi,uiVersionId:"monolith"},op={esComponent:f.Es.UiInfra,isExceptionKnown:()=>!1,shouldIgnoreException:()=>!1,uiDeployableId:oa.NotSet,uiVersionId:"unknown"},og={esComponent:f.Es.CustomerPlatform,isExceptionKnown:()=>!1,shouldIgnoreException:()=>!1,uiDeployableId:oa.AccountsConsoleMonolithUi,uiVersionId:"monolith"},om=(oa.AccountsConsoleMonolithUi,oa.DbsqlUi,oa.JobsUi,oa.MonolithUi,oa.NotSet,"Failed to execute 'removeChild' on 'Node': The node to be removed is not a child of this node"),of="Node.removeChild: The node to be removed is not a child of this node",oh="Failed to execute 'insertBefore' on 'Node': The node before which the new node is to be inserted is not a child of this node",oE=[{prefix:["Fetch request failed due to expired CSRF token","Invalid CSRF token"],component:f.Es.UiInfra,eventId:"fetch-after-csrf-token-expired",minFailures:nG.Ip.Min100},{prefix:"Uncaught Error: Minified React error #188",component:f.Es.UiInfra,eventId:"react-error-188"},{prefix:"Uncaught Error: Minified React error #185",component:f.Es.UiInfra,eventId:"react-error-185"},{prefix:"Uncaught Error: Minified React error #311",component:f.Es.UiInfra,eventId:"react-error-311"},{prefix:"Fetch request failed due expired user session",component:f.Es.UiInfra,eventId:"fetch-after-session-expired",useAlertUtilsLog:!0,minFailures:nG.Ip.Min100},{prefix:om,component:f.Es.UiInfra,eventId:"remove-node-not-child",minFailures:nG.Ip.Min100,predicate:()=>!ol()},{prefix:of,component:f.Es.UiInfra,eventId:"remove-node-not-child-firefox",minFailures:nG.Ip.Min100,predicate:()=>!ol()},{prefix:oh,component:f.Es.UiInfra,eventId:"insert-before-node-not-child",predicate:()=>!ol()},{prefix:om,component:f.Es.UiInfra,eventId:"remove-node-not-child-google-translate",minFailures:nG.Ip.Min100,predicate:()=>ol()},{prefix:of,component:f.Es.UiInfra,eventId:"remove-node-not-child-firefox-google-translate",minFailures:nG.Ip.Min100,predicate:()=>ol()},{prefix:oh,component:f.Es.UiInfra,eventId:"insert-before-node-not-child-google-translate",minFailures:nG.Ip.Min100,predicate:()=>ol()},{prefix:["Failed to fetch","TypeError: Error while fetching /config: Failed to fetch","TypeError: Failed to fetch","ui-flags fetch failed","TypeError: Error while fetching /ui-flags: Failed to fetch","NetworkError when attempting to fetch resource","TypeError: NetworkError when attempting to fetch resource","[Unknown error] TypeError: Failed to fetch"],component:f.Es.UiInfra,eventId:"failed-to-fetch",useAlertUtilsLog:!0,minFailures:nG.Ip.Min100},{prefix:"Request Failed",component:f.Es.UiInfra,eventId:"request-failed",useAlertUtilsLog:!0,minFailures:nG.Ip.Min100},{prefix:["Load failed","TypeError: Load failed"],component:f.Es.UiInfra,eventId:"load-failed",useAlertUtilsLog:!0,minFailures:nG.Ip.Min100},{prefix:"The object can not be found here.",component:f.Es.UiInfra,eventId:"remove-node-not-child-safari",predicate(e,r){var t;return null!=(t=null==r?void 0:r.startsWith("removeChild@[native code]"))&&t}},{prefix:"Loading chunk",component:f.Es.UiInfra,eventId:"chunk-loading-failures",useAlertUtilsLog:!0,minFailures:nG.Ip.Min100,predicate:(e,r)=>/Loading chunk .* failed after .* retries/.test(e)||/Loading chunk .* failed\./.test(e)},{prefix:"timeout of 0ms exceeded",component:f.Es.UiInfra,eventId:"axios-default-timeout-error",useAlertUtilsLog:!0,minFailures:nG.Ip.Min100},{prefix:"Request aborted",component:f.Es.UiInfra,eventId:"axios-request-aborted-error",useAlertUtilsLog:!0,predicate:(e,r)=>"Request aborted"===e},{prefix:"Network Error",component:f.Es.UiInfra,eventId:"axios-network-error",minFailures:nG.Ip.Min100,useAlertUtilsLog:!0,predicate:(e,r)=>"Network Error"===e},{prefix:"settings-internal: Request failed with status code 503",component:f.Es.RedashCore,eventId:"sqlgw-settings-internal-503"},{prefix:"null is not an object (evaluating 'localStorage.getItem')",component:f.Es.UiInfra,eventId:"localstorage-obj-is-null-error"},{prefix:"NS_BINDING_ABORTED",component:f.Es.UiInfra,eventId:"ns-binding-aborted"},{prefix:["NetworkError: Load failed","NetworkError: A network error occurred."],component:f.Es.UiInfra,eventId:"network-error-load-failed"},{prefix:"TypeError: undefined is not an object (evaluating '__gCrWeb",component:f.Es.UiInfra,eventId:"chrome-for-ios-undefined-internal-object-error"},{prefix:"The user aborted a request.",component:f.Es.UiInfra,eventId:"user-aborted-request",useAlertUtilsLog:!0,minFailures:nG.Ip.Min100},{prefix:"",component:f.Es.UiInfra,eventId:"unifiedFetchData-exception-user-abort",useAlertUtilsLog:!0,predicate:(e,r)=>null!=r&&r.includes("Error: Failed to execute 'fetch' on 'Window': The user aborted a request.")},{prefix:"Response not successful: Received status code",component:f.Es.UiInfra,eventId:"response-not-successful",useAlertUtilsLog:!0,minFailures:nG.Ip.Min100},{prefix:"signal is aborted without reason",component:f.Es.UiInfra,eventId:"signal-aborted-without-reason",useAlertUtilsLog:!0,minFailures:nG.Ip.Min100},{prefix:"User",component:f.Es.UiInfra,predicate:(e,r)=>/User .* has insufficient privileges to access object .*/.test(e),eventId:"user-permissions-error"},{prefix:"Error while fetching model version for run",component:f.Es.UiInfra,eventId:"mlflow-error-while-fetching-model-version",minFailures:nG.Ip.Min100},{prefix:"Uncaught NetworkError: Failed to execute 'importScripts' on 'WorkerGlobalScope'",component:f.Es.UiInfra,eventId:"worker-importscripts-failed",minFailures:nG.Ip.Min100},{prefix:"Error: Attempted to get command that was not found",component:f.Es.UiInfra,eventId:"command-not-found"},{prefix:"Error: Current session is invalid",component:f.Es.UiInfra,eventId:"current-session-invalid"},{prefix:"Error: Failed to convert invalid state",component:f.Es.UiInfra,eventId:"convert-invalid-state"},{prefix:"Error: Action",component:f.Es.UiInfra,eventId:"action-already-defined",predicate:(e,r)=>/Error: Action .* is already defined for id/.test(e)},{prefix:"Error: Talisman extension has not been configured yet",component:f.Es.UiInfra,eventId:"talisman-extension-not-configured",useAlertUtilsLog:!0},{prefix:["Error: Unexpected token '<'","Error: <!doctype html><html>","Error: <html>",'<!doctype "... is not valid JSON',"Unexpected token '<'","Unexpected '<'","Unexpected ''"],component:f.Es.UiInfra,eventId:"unexpected-token-html",useAlertUtilsLog:!0},{prefix:"Unexpected end of JSON input",component:f.Es.UiInfra,eventId:"unexpected-end-of-json",useAlertUtilsLog:!0,predicate:(e,r)=>null!==r&&/ServerParseError/.test(r)},{prefix:"Loading script failed",component:f.Es.UiInfra,eventId:"loading-script-failed"},{prefix:"Error: INKApi Error",component:f.Es.UiInfra,eventId:"inkapi-error"},{prefix:"TypeError: Cannot redefine property: googletag",component:f.Es.UiInfra,eventId:"cannot-redefine-property-googletag"},{prefix:"SyntaxError: Unexpected end of input",component:f.Es.UiInfra,eventId:"syntax-error-unexpected-end-of-input"},{prefix:"Uncaught SyntaxError: Identifier",component:f.Es.UiInfra,eventId:"identifier-has-already-been-declared",predicate:(e,r)=>/Uncaught SyntaxError: Identifier .* has already been declared/.test(e)},{prefix:["TEMPORARILY_UNAVAILABLE","Error: TEMPORARILY_UNAVAILABLE"],component:f.Es.UiInfra,eventId:"service-temporarily-unavailable",useAlertUtilsLog:!0,minFailures:nG.Ip.Min100},{prefix:"",component:f.Es.MlFlow,eventId:"mlflow-ui-error-legacy",predicate:(e,r,t,n)=>null!==n&&"string"!=typeof n&&"isMlflowUiError"in n&&!0===n.isMlflowUiError},{prefix:["Uncaught TypeError: Cannot redefine property: hidden","TypeError: Cannot redefine property: hidden"],component:f.Es.UiInfra,eventId:"cannot-redefine-property-hidden",minFailures:nG.Ip.Min10,predicate:(e,r)=>!(null==r?void 0:r.includes(".js")),useAlertUtilsLog:!0},{prefix:"Cannot destructure property 'ok' of 'e' as it is undefined.",component:f.Es.Navigation,eventId:"cannot-destructure-property-ok",minFailures:nG.Ip.Min100},{prefix:'["objectsPermissions",{"name""dashboardsv3',component:f.Es.Lakeview,eventId:"lakeview-dashboards-objects-permissions-error",predicate(e,r){var t;return null!=(t=null==r?void 0:r.includes("data is undefined"))&&t}},{prefix:'["revisionHistory"',component:f.Es.Notebooks,eventId:"notebooks-revision-history-error",predicate(e,r){var t;return null!=(t=null==r?void 0:r.includes("data is undefined"))&&t||e.includes("data is undefined")}},{prefix:"Restricted access",component:f.Es.DataExplorer,eventId:"data-explorer-restricted-access-error",useAlertUtilsLog:!0,predicate(e,r){var t;return null!=(t=null==r?void 0:r.includes("chunk.js"))&&t}},{prefix:"timeout of 15000ms exceeded",component:f.Es.Notebooks,eventId:"notebooks-timeout-error",predicate(e,r){var t;return null!=(t=null==r?void 0:r.includes("chunk.js"))&&t}},{prefix:"Request failed to send. Check your internet connection",component:f.Es.Notebooks,eventId:"notebooks-request-failed-internet-error",useAlertUtilsLog:!0},{prefix:"Call failed to /ajax-api/2.0/preview/admin/scim/v2/",component:f.Es.UiInfra,eventId:"ajax-api-undefined-response",predicate:e=>e.includes("Response text: undefined"),useAlertUtilsLog:!0},{prefix:["RBAC: access denied","Unexpected token 'R'"],component:f.Es.UiInfra,eventId:"fetch-during-vpn-disconnect",useAlertUtilsLog:!0,minFailures:nG.Ip.Min100},{prefix:"queryKey: dataroom",component:f.Es.DataRooms,eventId:"dataroom-error",predicate(e,r){var t;return null!=(t=null==r?void 0:r.includes("data is undefined"))&&t||e.includes("data is undefined")}},{prefix:"queryKey: pipeline-root-tree-node",component:f.Es.WorkflowsAuthoring,eventId:"pipeline-root-tree-node-403",useAlertUtilsLog:!0,predicate:e=>e.includes("failed with 403")}];function ov(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;for(let i of oE){var o;if((Array.isArray(i.prefix)?i.prefix:[i.prefix]).some(r=>e.startsWith(r))&&(null==(o=i.predicate)?void 0:o.call(i,e,r,t,n))!==!1)return(null==i?void 0:i.useAlertUtilsLog)?m.iT.log(`[ConvertedToAlert] ${i.eventId}`,i.component,{message:e,stack:r,componentStack:t}):m.iT.sev2BurnRate(i.component,`[ConvertedToAlert] ${i.eventId}`,i.sloTarget||nG.i1.P99,i.minFailures||nG.Ip.Min10,!1,{message:e,stack:r,componentStack:t},!1,!0),!0}return!1}function oy(e,r,t){var n,o;let i,a,s,l,c,d=!(arguments.length>3)||void 0===arguments[3]||arguments[3],u={parsingFailed:!0};if(!(AlertUtils.isError(e)||"string"==typeof e||AlertUtils.isStringRecord(e)))return d&&AlertUtils.sev2(Es.UiInfra,`${r}: error is not an Error, a string, or a string record`,{error:e,typeofError:typeof e,stack:Error().stack,...t}),u;if(e instanceof Error){if("string"!=typeof e.message)return d&&AlertUtils.sev2(Es.UiInfra,`${r}: error.message is not a string`,{error:e,typeofErrorMessage:typeof e.message,stack:Error().stack,...t}),u;if(a=e.message,void 0!==e.stack&&"string"!=typeof e.stack)return d&&AlertUtils.sev2(Es.UiInfra,`${r}: error.stack is not a string`,{error:e,typeofErrorStack:typeof e.stack,stack:Error().stack,...t}),u;s=null!=(n=e.stack)?n:"<stack is undefined>";let o=getInitiatorStack(e);l=s+(o?`

${o}`:"")}else if(AlertUtils.isStringRecord(e)){if("string"!=typeof e.message&&"string"!=typeof e.error)return d&&AlertUtils.sev2(Es.UiInfra,`${r}: error is a string record but error.message & error.error are not a string`,{error:e,typeofErrorMessage:typeof e.message,typeofErrorError:typeof e.error,stack:Error().stack,...t}),u;a="string"==typeof e.message?e.message:e.error,"string"==typeof e.stack?(s=e.stack,l=e.stack):(s=null,l="error.stack was not a string")}else a=e,s=null,l="error is a string so error.stack is not available";return c=null===s?"error is a string so error.stack and thus source are not available":null!=(o=function(e){let r=e.match(/(?:at|@)\s*(?:[^(:]+\s+\()?(https?[^)]+):\d+:\d+\)?/);if(null===r)return;return r[1]}(s))?o:"error.stack does not match the expected format and source is not available",e instanceof PredefinedError&&(i=e.isUserError),{message:a,source:c,stack:s,stackString:l,isUserError:i}}function ob(e){var r;return"object"==typeof e&&null!==e&&"response"in e&&"number"==typeof(null==(r=e.response)?void 0:r.status)}function ox(e){if(!e)return!0;if(0===e.status)return!1;let r=e.status>=200&&e.status<300;if("errorType"in e)return e.errorType===n2.JSON_PARSE&&r;var t=e.status;if(0===t||t>=400&&t<600)return!1;return!0}function oS(e){var r,t;if(!e)return!1;if(!((e=function(e){if(null!==e&&!(e instanceof Error)&&"object"==typeof e&&"message"in e)return Error(`${e.message}, Stringified Non-Error object: ${m.iT.jsonStringifyWithJavaScriptTypes(e)}`);return e}(e))instanceof Error))return!0;if(e instanceof nw&&e.isUserError)return!1;let n=(null==e||null==(r=e.stack)?void 0:r.toString())||null;if(ov(e.message,n))return!1;if(e instanceof TypeError)return"Failed to fetch"!==e.message&&!e.message.includes("NetworkError");if("object"==typeof(t=e)&&null!==t&&"isAxiosError"in t&&"boolean"==typeof t.isAxiosError&&t.isAxiosError){if(e.message===or().ABORTED_MSG||e.message===or().NETWORK_ERROR_MSG||e.code===or().NETWORK_ERROR_CODE)return!1;return ox(e.response)}if(ob(e))return ox(e.response);return!0}let oT=[e=>{var r;return null==(r=e.message)?void 0:r.startsWith("AbortError: Fetch is aborted")},e=>{var r,t;return(null==(r=e.message)?void 0:r.startsWith("Aborted"))&&(null==(t=e.stack)?void 0:t.includes("ui-assets"))},e=>{var r;return null==(r=e.message)?void 0:r.startsWith("Content-Length header of network response exceeds response Body.")}];function oI(e){if(!e||"object"!=typeof e)return!1;if(!m.iT.isError(e)&&m.iT.isStringRecord(e)&&"{}"===m.iT.jsonStringifyWithJavaScriptTypes(e))return!0;let r="sourceURL"in e&&(e.sourceURL.startsWith("https://ui-assets")||e.sourceURL.startsWith("https://databricks-ui-assets.azureedge.net/js"));if("__initiatorStack"in e||r)return!0;if(!(e instanceof Error))return!1;if(oT.some(r=>r(e)))return!0;return!1}function o_(e,r,t,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){t(e);return}s.done?r(l):Promise.resolve(l).then(n,o)}function oA(e,r,t,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){t(e);return}s.done?r(l):Promise.resolve(l).then(n,o)}let oR=function(e){var r;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2?arguments[2]:void 0;return(r=function*(){var r,o,i;let a=yield(r=e,o={method:t,body:function(e){if(void 0===e)return;return"string"==typeof e||e instanceof FormData||e instanceof Blob?e:JSON.stringify(e)}(n),headers:n?{"Content-Type":"application/json"}:{}},(i=function*(){try{let e="string"==typeof r?r:r instanceof URL?r.toString():r.url,t=function(){var e;let r=null==(e=Error().stack)?void 0:e.split("\n");if(!r)return{stack:void 0};return{stack:r.filter(e=>!/^(Error|.*captureInitiatorStack.*)/.test(e)).join("\n")}}(),n=yield n3.call({resource:e,options:function(e){var r;if(void 0===e)return{responseFormat:n1.STREAM};let t=function(e){var r;if(!e)return e;let t=e.method?e.method:n0.GET,n=Array.isArray(e.headers)?new Headers(e.headers):e.headers;return{...e,headers:n,method:t,signal:null!=(r=e.signal)?r:void 0}}(e);return{...t,method:t.method,responseFormat:null!=(r=t.responseFormat)?r:n1.STREAM}}(o)}),i=n8(n,t);return m.iT.sev2BurnRate(f.Es.Navigation,n$.Fetch,nG.i1.P999,nG.Ip.Min10,!0),i}catch(e){throw oS(e)&&(oI(e)?m.iT.log("unifiedFetchData-ignored-fetch",f.Es.Navigation,e):m.iT.sev2BurnRate(f.Es.Navigation,n$.Fetch,nG.i1.P999,nG.Ip.Min10,!1,e)),e}},function(){var e=this,r=arguments;return new Promise(function(t,n){var o=i.apply(e,r);function a(e){o_(o,t,n,a,s,"next",e)}function s(e){o_(o,t,n,a,s,"throw",e)}a(void 0)})})());if(!a.ok){let e=nN(a);if(e){try{let r=(yield a.json()).message;e.message=null!=r?r:e.message}catch{}throw e}}return a.json()},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){oA(i,n,o,a,s,"next",e)}function s(e){oA(i,n,o,a,s,"throw",e)}a(void 0)})})()},ow=e=>{let{traceId:r,assessmentId:t}=e;return oR(`/ajax-api/3.0/mlflow/traces/${r}/assessments/${t}`,"DELETE")},oN=e=>{let{payload:r}=e;return oR(`/ajax-api/3.0/mlflow/traces/${r.assessment.trace_id}/assessments`,"POST",r)},oY=e=>{let{traceId:r}=e;return oR(`/ajax-api/3.0/mlflow/traces/${r}`)},oC=e=>{let{traceId:r,assessmentId:t,payload:n}=e;return oR(`/ajax-api/3.0/mlflow/traces/${r}/assessments/${t}`,"PATCH",n)},oM=(0,i.createContext)({refetchTraceInfo:null}),oD=()=>(0,i.useContext)(oM);function oO(e,r,t,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){t(e);return}s.done?r(l):Promise.resolve(l).then(n,o)}let ok=e=>{let{assessmentName:r,spanId:t,traceId:n,setExpanded:a}=e,l=(0,c.tz)(),{theme:d}=(0,s.wn)(),[u,p]=(0,i.useState)(""),[g,m]=(0,i.useState)("feedback"),[f,h]=(0,i.useState)("boolean"),[E,v]=(0,i.useState)(!0),[y,b]=(0,i.useState)(""),[x,S]=(0,i.useState)(null),{refetchTraceInfo:T}=oD(),{mutate:I,isLoading:_}=(0,nb.n)({mutationFn:e=>oN({payload:e}),onSuccess:()=>{null==T||T()},onError:e=>{ny.call({isCloseable:!0,root:{componentId:"shared.model-trace-explorer.assessment-create-error",duration:5e3,severity:"error"},title:{value:l.formatMessage({id:"L3szkg",defaultMessage:"Failed to create assessment. Error: {error}"},{error:e instanceof Error?e.message:String(e)})}})},onSettled:()=>{a(!1)}}),A=!(0,Z.isNil)(r),R=(0,i.useCallback)(()=>{var e;return(e=function*(){if("json"===f)try{JSON.parse(E)}catch(e){S((0,o.Y)(c.sA,{id:"VXduJD",defaultMessage:"The provided value is not valid JSON"}));return}let e=nI({formValue:E,dataType:f,isFeedback:"feedback"===g}),i={assessment:{assessment_name:A?r:u,trace_id:n,source:{source_type:"HUMAN",source_id:(0,nh.d)("user_new","")},span_id:t,rationale:y,...e}};yield I(i)},function(){var r=this,t=arguments;return new Promise(function(n,o){var i=e.apply(r,t);function a(e){oO(i,n,o,a,s,"next",e)}function s(e){oO(i,n,o,a,s,"throw",e)}a(void 0)})})()},[f,E,g,A,r,u,n,t,y,I]);return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:d.spacing.xs,marginTop:d.spacing.sm,border:`1px solid ${d.colors.border}`,padding:d.spacing.sm,borderRadius:d.borders.borderRadiusSm},children:[(0,o.Y)(rD.o.Text,{size:"sm",color:"secondary",children:(0,o.Y)(c.sA,{id:"+SBxBK",defaultMessage:"Assessment Type"})}),(0,o.FD)(nm.XA,{id:"shared.model-trace-explorer.assessment-type-select",componentId:"shared.model-trace-explorer.assessment-type-select",value:g,disabled:_,onChange:e=>m(e.target.value),children:[(0,o.Y)(nm.wS,{value:"feedback",children:(0,o.Y)(c.sA,{id:"0AOcOr",defaultMessage:"Feedback"})}),(0,o.Y)(nm.wS,{value:"expectation",children:(0,o.Y)(c.sA,{id:"tEaqGu",defaultMessage:"Expectation"})})]}),(0,o.Y)(rD.o.Text,{css:{marginTop:d.spacing.xs},size:"sm",color:"secondary",children:(0,o.Y)(c.sA,{id:"AdlJNW",defaultMessage:"Assessment Name"})}),A?(0,o.Y)(rD.o.Text,{children:r}):(0,o.Y)(rM.p,{componentId:"shared.model-trace-explorer.assessment-name-input",value:u,disabled:_,onKeyDown:e=>e.stopPropagation(),onChange:e=>p(e.target.value)}),(0,o.Y)(rD.o.Text,{css:{marginTop:d.spacing.xs},size:"sm",color:"secondary",children:(0,o.Y)(c.sA,{id:"q8rYCQ",defaultMessage:"Data Type"})}),(0,o.FD)(nm.XA,{id:"shared.model-trace-explorer.assessment-data-type-select",componentId:"shared.model-trace-explorer.assessment-data-type-select",value:f,disabled:_,onChange:e=>{h(e.target.value),S(null)},children:["expectation"===g&&(0,o.Y)(nm.wS,{value:"json",children:(0,o.Y)(c.sA,{id:"GKVTw4",defaultMessage:"JSON"})}),(0,o.Y)(nm.wS,{value:"string",children:(0,o.Y)(c.sA,{id:"cBSSLp",defaultMessage:"String"})}),(0,o.Y)(nm.wS,{value:"boolean",children:(0,o.Y)(c.sA,{id:"k0l8lF",defaultMessage:"Boolean"})}),(0,o.Y)(nm.wS,{value:"number",children:(0,o.Y)(c.sA,{id:"C9ccNu",defaultMessage:"Number"})})]}),(0,o.Y)(rD.o.Text,{css:{marginTop:d.spacing.xs},size:"sm",color:"secondary",children:(0,o.Y)(c.sA,{id:"ms+6Z2",defaultMessage:"Value"})}),"json"===f&&(0,o.FD)(o.FK,{children:[(0,o.Y)(rM.p.TextArea,{componentId:"shared.model-trace-explorer.assessment-edit-value-string-input",value:String(E),autoSize:{minRows:1,maxRows:5},onKeyDown:e=>e.stopPropagation(),onChange:e=>{v(e.target.value),S(null)},validationState:x?"error":void 0,disabled:_}),x&&(0,o.Y)(nf.D.Message,{id:"shared.model-trace-explorer.assessment-edit-value-json-error",message:x,type:"error"})]}),"string"===f&&(0,o.Y)(rM.p,{componentId:"shared.model-trace-explorer.assessment-value-string-input",value:String(E),onKeyDown:e=>e.stopPropagation(),onChange:e=>{v(e.target.value),S(null)},disabled:_,allowClear:!0}),"boolean"===f&&(0,o.FD)(nr.d,{componentId:"shared.model-trace-explorer.assessment-value-boolean-input",name:"shared.model-trace-explorer.assessment-value-boolean-input",value:E,disabled:_,onChange:e=>{v(e.target.value),S(null)},children:[(0,o.Y)(nr.E,{value:!0,children:"True"}),(0,o.Y)(nr.E,{value:!1,children:"False"})]}),"number"===f&&(0,o.Y)(rM.p,{componentId:"shared.model-trace-explorer.assessment-value-number-input",value:String(E),onKeyDown:e=>e.stopPropagation(),onChange:e=>{v(e.target.value?Number(e.target.value):""),S(null)},type:"number",disabled:_,allowClear:!0}),(0,o.Y)(rD.o.Text,{css:{marginTop:d.spacing.xs},size:"sm",color:"secondary",children:(0,o.Y)(c.sA,{id:"wDMTm8",defaultMessage:"Rationale"})}),(0,o.Y)(rM.p.TextArea,{componentId:"shared.model-trace-explorer.assessment-rationale-input",value:y,autoSize:{minRows:1,maxRows:5},disabled:_,onKeyDown:e=>e.stopPropagation(),onChange:e=>b(e.target.value)}),(0,o.FD)("div",{css:{display:"flex",justifyContent:"flex-end",marginTop:d.spacing.xs},children:[(0,o.Y)(rO.$n,{componentId:"shared.model-trace-explorer.assessment-create-button",disabled:_,onClick:()=>a(!1),children:(0,o.Y)(c.sA,{id:"+33ShX",defaultMessage:"Cancel"})}),(0,o.Y)(rO.$n,{css:{marginLeft:d.spacing.sm},type:"primary",componentId:"shared.model-trace-explorer.assessment-create-button",onClick:R,loading:_,children:(0,o.Y)(c.sA,{id:"Me7xpG",defaultMessage:"Create"})})]})]})},oL=e=>{let{title:r,assessmentName:t,spanId:n,traceId:a}=e,[s,l]=(0,i.useState)(!1);return(0,o.FD)("div",{children:[(0,o.Y)(rO.$n,{size:"small",componentId:"shared.model-trace-explorer.add-new-assessment",icon:(0,o.Y)(ng.A,{}),onClick:()=>l(!0),children:r}),s&&(0,o.Y)(ok,{assessmentName:t,spanId:n,traceId:a,setExpanded:l})]})};var oP=t(1318),oU=t(75147),oF=t(81010);let oB=e=>{let{assessment:r,setIsEditing:t,setShowDeleteModal:n}=e,i="feedback"in r,a=(0,nh.d)("user_new",""),s=(0,d.W)("databricks.fe.traceExplorer.enableAssessmentEditing",!1),l=a===r.source.source_id||i&&"HUMAN"!==r.source.source_type;return(0,o.FD)(r1.Root,{children:[(0,o.Y)(r1.Trigger,{asChild:!0,children:(0,o.Y)(rO.$n,{componentId:"shared.model-trace-explorer.assessment-more-button",icon:(0,o.Y)(oP.A,{}),size:"small"})}),(0,o.FD)(r1.Content,{minWidth:100,children:[s&&l&&t&&(0,o.FD)(r1.Item,{componentId:"shared.model-trace-explorer.assessment-edit-button",onClick:()=>null==t?void 0:t(!0),children:[(0,o.Y)(r1.IconWrapper,{children:(0,o.Y)(oU.A,{})}),(0,o.Y)(c.sA,{id:"UQhorr",defaultMessage:"Edit"})]}),(0,o.FD)(r1.Item,{componentId:"shared.model-trace-explorer.assessment-delete-button",onClick:()=>n(!0),children:[(0,o.Y)(r1.IconWrapper,{children:(0,o.Y)(oF.A,{})}),(0,o.Y)(c.sA,{id:"aZV8M7",defaultMessage:"Delete"})]})]})]})};var oW=t(53049);function oj(e,r,t,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){t(e);return}s.done?r(l):Promise.resolve(l).then(n,o)}let oz=e=>{let{assessment:r,isModalVisible:t,setIsModalVisible:n}=e,a=(0,c.tz)(),{refetchTraceInfo:s}=oD(),{mutate:l,isLoading:d}=(0,nb.n)({mutationFn:()=>ow({traceId:r.trace_id,assessmentId:r.assessment_id}),onSuccess:()=>{null==s||s()},onError:e=>{ny.call({isCloseable:!0,root:{componentId:"shared.model-trace-explorer.assessment-delete-error",duration:5e3,severity:"error"},title:{value:a.formatMessage({id:"iRNZkJ",defaultMessage:"Failed to delete assessment. Error: {error}"},{error:e instanceof Error?e.message:String(e)})}})},onSettled:()=>{n(!1)}}),u=(0,i.useCallback)(()=>{var e;return(e=function*(){yield l()},function(){var r=this,t=arguments;return new Promise(function(n,o){var i=e.apply(r,t);function a(e){oj(i,n,o,a,s,"next",e)}function s(e){oj(i,n,o,a,s,"throw",e)}a(void 0)})})()},[l]);return(0,o.Y)(oW.aF,{componentId:"shared.model-trace-explorer.assessment-delete-modal",visible:t,onOk:u,okButtonProps:{danger:!0,loading:d},okText:(0,o.Y)(c.sA,{id:"vlUEAo",defaultMessage:"Delete"}),onCancel:()=>{n(!1)},cancelText:(0,o.Y)(c.sA,{id:"gFYM0j",defaultMessage:"Cancel"}),confirmLoading:d,title:(0,o.Y)(c.sA,{id:"mqqEUj",defaultMessage:"Delete assessment"}),children:(0,o.Y)(c.sA,{id:"puATD8",defaultMessage:"Are you sure you want to delete this assessment?"})})},oG=e=>{let{refetchTraceInfo:r,onSuccess:t,onError:n,onSettled:o}=e,i=(0,c.tz)(),{mutate:a,isLoading:s}=(0,nb.n)({mutationFn:e=>{let{oldAssessment:r,value:t,rationale:n}=e,o={...r,...t,rationale:n,source:{source_id:(0,nh.d)("user_new",""),source_type:"HUMAN"},overrides:r.assessment_id};return oN({payload:{assessment:(0,Z.omit)(o,"assessment_id","create_time","last_update_time","overriddenAssessments")}})},onError:e=>{ny.call({isCloseable:!0,root:{componentId:"shared.model-trace-explorer.assessment-override-error",duration:5e3,severity:"error"},title:{value:i.formatMessage({id:"X11caV",defaultMessage:"Failed to override assessment. Error: {error}"},{error:e instanceof Error?e.message:String(e)})}}),null==n||n(e)},onSuccess:()=>{null==r||r(),null==t||t()},onSettled:()=>{null==o||o()}});return{overrideAssessmentMutation:a,isLoading:s}},o$=e=>{let{assessment:r,refetchTraceInfo:t,onSuccess:n,onError:o,onSettled:i}=e,a=(0,c.tz)(),{mutate:s,isLoading:l}=(0,nb.n)({mutationFn:e=>oC({traceId:r.trace_id,assessmentId:r.assessment_id,payload:e}),onError:e=>{ny.call({isCloseable:!0,root:{componentId:"shared.model-trace-explorer.assessment-update-error",duration:5e3,severity:"error"},title:{value:a.formatMessage({id:"+hZB4c",defaultMessage:"Failed to update assessment. Error: {error}"},{error:e instanceof Error?e.message:String(e)})}}),null==o||o(e)},onSuccess:()=>{null==t||t(),null==n||n()},onSettled:()=>{null==i||i()}});return{updateAssessmentMutation:s,isLoading:l}};function oK(e,r,t,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){t(e);return}s.done?r(l):Promise.resolve(l).then(n,o)}let oH=(e,r)=>{if("string"==typeof e){if(""===e)return"boolean";if(r)return"string";try{return JSON.parse(e),"json"}catch(e){return"string"}}if("boolean"==typeof e||"number"==typeof e)return typeof e;return"boolean"},oV=e=>{if("string"==typeof e)return e||null;if("boolean"==typeof e||"number"==typeof e)return e;return null},oZ=e=>{if("feedback"in e)return e.feedback.value;if("value"in e.expectation)return e.expectation.value;return e.expectation.serialized_value.value},oq=e=>{let{assessment:r,onSuccess:t,onSettled:n,onCancel:a}=e,l="feedback"in r,d=oZ(r),u=oH(d,l),p=oV(d),g=(0,nh.d)("user_new",""),{theme:m}=(0,s.wn)(),[f,h]=(0,i.useState)(u),[E,v]=(0,i.useState)(p),[y,b]=(0,i.useState)(r.rationale),[x,S]=(0,i.useState)(null),{refetchTraceInfo:T}=oD(),{updateAssessmentMutation:I,isLoading:_}=o$({assessment:r,refetchTraceInfo:T,onSuccess:t,onSettled:n}),{overrideAssessmentMutation:A,isLoading:R}=oG({refetchTraceInfo:T,onSuccess:t,onSettled:n}),w=_||R,N=(0,i.useCallback)(()=>{var e;return(e=function*(){if("json"===f)try{JSON.parse(E)}catch(e){S((0,o.Y)(c.sA,{id:"8I9ipd",defaultMessage:"The provided value is not valid JSON"}));return}let e=nI({formValue:E,dataType:f,isFeedback:l});if(g!==r.source.source_id&&l)yield A({oldAssessment:r,value:e,...y?{rationale:y}:{}});else{let r={assessment:{...e,rationale:y},update_mask:`${l?"feedback":"expectation"},rationale`};yield I(r)}},function(){var r=this,t=arguments;return new Promise(function(n,o){var i=e.apply(r,t);function a(e){oK(i,n,o,a,s,"next",e)}function s(e){oK(i,n,o,a,s,"throw",e)}a(void 0)})})()},[f,E,l,g,r,y,I,A]);return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:m.spacing.xs,marginTop:m.spacing.sm,border:`1px solid ${m.colors.border}`,padding:m.spacing.sm,borderRadius:m.borders.borderRadiusSm},children:[(0,o.Y)(rD.o.Text,{css:{marginTop:m.spacing.xs},size:"sm",color:"secondary",children:(0,o.Y)(c.sA,{id:"b7OpMB",defaultMessage:"Data Type"})}),(0,o.FD)(nm.XA,{id:"shared.model-trace-explorer.assessment-edit-data-type-select",componentId:"shared.model-trace-explorer.assessment-edit-data-type-select",value:f,disabled:w,onChange:e=>{h(e.target.value),S(null)},children:[!l&&(0,o.Y)(nm.wS,{value:"json",children:(0,o.Y)(c.sA,{id:"GKVTw4",defaultMessage:"JSON"})}),(0,o.Y)(nm.wS,{value:"string",children:(0,o.Y)(c.sA,{id:"cBSSLp",defaultMessage:"String"})}),(0,o.Y)(nm.wS,{value:"boolean",children:(0,o.Y)(c.sA,{id:"k0l8lF",defaultMessage:"Boolean"})}),(0,o.Y)(nm.wS,{value:"number",children:(0,o.Y)(c.sA,{id:"C9ccNu",defaultMessage:"Number"})})]}),(0,o.Y)(rD.o.Text,{css:{marginTop:m.spacing.xs},size:"sm",color:"secondary",children:(0,o.Y)(c.sA,{id:"e2AObB",defaultMessage:"Value"})}),"json"===f&&(0,o.FD)(o.FK,{children:[(0,o.Y)(rM.p.TextArea,{componentId:"shared.model-trace-explorer.assessment-edit-value-string-input",value:String(E),rows:3,onKeyDown:e=>e.stopPropagation(),onChange:e=>{v(e.target.value),S(null)},validationState:x?"error":void 0,disabled:w}),x&&(0,o.Y)(nf.D.Message,{id:"shared.model-trace-explorer.assessment-edit-value-json-error",message:x,type:"error"})]}),"string"===f&&(0,o.Y)(rM.p,{componentId:"shared.model-trace-explorer.assessment-edit-value-string-input",value:String(E),onKeyDown:e=>e.stopPropagation(),onChange:e=>{v(e.target.value),S(null)},disabled:w,allowClear:!0}),"boolean"===f&&(0,o.FD)(nr.d,{componentId:"shared.model-trace-explorer.assessment-edit-value-boolean-input",name:"shared.model-trace-explorer.assessment-edit-value-boolean-input",value:E,disabled:w,onChange:e=>{v(e.target.value),S(null)},children:[(0,o.Y)(nr.E,{value:!0,children:"True"}),(0,o.Y)(nr.E,{value:!1,children:"False"})]}),"number"===f&&(0,o.Y)(rM.p,{componentId:"shared.model-trace-explorer.assessment-edit-value-number-input",value:String(E),onKeyDown:e=>e.stopPropagation(),onChange:e=>{v(e.target.value?Number(e.target.value):""),S(null)},type:"number",disabled:w,allowClear:!0}),(0,o.Y)(rD.o.Text,{css:{marginTop:m.spacing.xs},size:"sm",color:"secondary",children:(0,o.Y)(c.sA,{id:"6BRlPU",defaultMessage:"Rationale"})}),(0,o.Y)(rM.p.TextArea,{componentId:"shared.model-trace-explorer.assessment-edit-rationale-input",value:y,autoSize:{minRows:1,maxRows:5},disabled:w,onKeyDown:e=>e.stopPropagation(),onChange:e=>b(e.target.value)}),(0,o.FD)("div",{css:{display:"flex",justifyContent:"flex-end",marginTop:m.spacing.xs},children:[(0,o.Y)(rO.$n,{componentId:"shared.model-trace-explorer.assessment-edit-cancel-button",disabled:w,onClick:a,children:(0,o.Y)(c.sA,{id:"mIFcgu",defaultMessage:"Cancel"})}),(0,o.Y)(rO.$n,{css:{marginLeft:m.spacing.sm},type:"primary",componentId:"shared.model-trace-explorer.assessment-edit-save-button",onClick:N,loading:w,children:(0,o.Y)(c.sA,{id:"M+iC03",defaultMessage:"Save"})})]})]})},oJ=e=>{let{objectKey:r,value:t}=e,{theme:n}=(0,s.wn)(),i=(0,Z.isString)(t)?t:JSON.stringify(t);return(0,o.Y)(tV.m,{content:i,componentId:"shared.model-trace-explorer.expectation-value-preview-tooltip",children:(0,o.Y)(r2.v,{color:"indigo",componentId:"shared.model-trace-explorer.expectation-array-item-tag",css:{width:"min-content",maxWidth:"100%"},children:(0,o.FD)(rD.o.Text,{css:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[r&&(0,o.FD)(rD.o.Text,{bold:!0,css:{marginRight:n.spacing.xs},children:[r,":"]}),i]})})})},oX=e=>{var r;let{node:t}=e,{theme:n}=(0,s.wn)(),{setSelectedNode:i,setActiveView:a,setShowTimelineTreeGantt:l}=rZ(),c=e6(t)>0;return(0,o.FD)("div",{css:{display:"flex",alignItems:"center",marginRight:n.spacing.xs,gap:n.spacing.xs,"&:hover":{textDecoration:"underline",textDecorationColor:c?n.colors.actionDangerDefaultTextDefault:n.colors.actionDefaultTextDefault,cursor:"pointer"}},onClick:()=>{i(t),a("detail"),l(!1)},children:[(0,o.Y)(eD,{hasException:c,type:eO(null!=(r=t.type)?r:ef.UNKNOWN)}),(0,o.Y)(rD.o.Text,{color:c?"error":"primary",css:{marginLeft:n.spacing.xs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.title})]})},oQ=e=>{if(Array.isArray(e))return e.map((e,r)=>(0,o.Y)(oJ,{value:e},r));if((0,Z.isObject)(e))return Object.entries(e).map(e=>{let[r,t]=e;return(0,o.Y)(oJ,{objectKey:r,value:t},r)});return(0,o.Y)(oJ,{value:e})},o0=e=>{let{expectation:r}=e,{theme:t}=(0,s.wn)(),[n,a]=(0,i.useState)(!1),[l,d]=(0,i.useState)(!1),{nodeMap:u,activeView:p}=rZ(),g=r.span_id?u[r.span_id]:null,m="summary"===p&&g,f=nT(r.expectation);return(0,o.FD)("div",{css:{padding:t.spacing.sm+t.spacing.xs,paddingTop:t.spacing.sm,border:`1px solid ${t.colors.border}`,borderRadius:t.borders.borderRadiusMd,display:"flex",flexDirection:"column",gap:t.spacing.sm},children:[(0,o.FD)("div",{css:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,o.Y)(rD.o.Text,{bold:!0,css:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.assessment_name}),(0,o.Y)(oB,{assessment:r,setIsEditing:a,setShowDeleteModal:d}),(0,o.Y)(oz,{assessment:r,isModalVisible:l,setIsModalVisible:d})]}),n?(0,o.Y)(oq,{assessment:r,onSuccess:()=>a(!1),onCancel:()=>a(!1)}):oQ(f),m&&(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:t.spacing.xs},children:[(0,o.Y)(rD.o.Text,{size:"sm",color:"secondary",children:(0,o.Y)(c.sA,{id:"+hQbnS",defaultMessage:"Span"})}),(0,o.Y)(oX,{node:g})]})]})};var o1=t(90089),o2=t(85364);let o3=e=>{let r,{jsonValue:t}=e,{theme:n}=(0,s.wn)();if(!t||'""'===t)return null;try{r=JSON.parse(t)}catch(e){r=t}let i="default",a=JSON.stringify(r,null,2);return"yes"===r?(i="lime",a=(0,o.FD)(o.FK,{children:[(0,o.Y)(o2.A,{css:{marginRight:n.spacing.xs}}),(0,o.Y)(c.sA,{id:"MhOmZG",defaultMessage:"Yes"})]})):"no"===r?(i="coral",a=(0,o.FD)(o.FK,{children:[(0,o.Y)(ns.A,{css:{marginRight:n.spacing.xs}}),(0,o.Y)(c.sA,{id:"M8cEQy",defaultMessage:"No"})]})):"string"==typeof r?a=r:null===r?(i="coral",a=(0,o.FD)(o.FK,{children:[(0,o.Y)(o1.A,{css:{marginRight:n.spacing.xs}}),(0,o.Y)(c.sA,{id:"zEXwQL",defaultMessage:"Error"})]})):!0===r?(i="lime",a=(0,o.FD)(o.FK,{children:[(0,o.Y)(o2.A,{css:{marginRight:n.spacing.xs}}),(0,o.Y)(c.sA,{id:"hWHLjo",defaultMessage:"True"})]})):!1===r&&(i="coral",a=(0,o.FD)(o.FK,{children:[(0,o.Y)(ns.A,{css:{marginRight:n.spacing.xs}}),(0,o.Y)(c.sA,{id:"4U/RVz",defaultMessage:"False"})]})),(0,o.Y)(tV.m,{componentId:"shared.model-trace-explorer.assesment-value-tooltip",content:a,children:(0,o.Y)(r2.v,{css:{display:"inline-flex",maxWidth:"100%",minWidth:n.spacing.md,marginRight:0},componentId:"shared.model-trace-explorer.assesment-value-tag",color:i,children:(0,o.Y)("span",{css:{overflow:"hidden",textOverflow:"ellipsis",textWrap:"nowrap"},children:a})})})};var o5=t(92458);let o4=e=>{let{source:r}=e,{theme:t}=(0,s.wn)();return(0,o.Y)(tV.m,{componentId:"shared.model-trace-explorer.assessment-source-name",content:r.source_id,children:(0,o.Y)("span",{css:{flexShrink:1,overflow:"hidden",textOverflow:"ellipsis",textWrap:"nowrap",marginLeft:t.spacing.sm,minWidth:t.spacing.md},children:(0,o.Y)(rD.o.Text,{children:(0,o.Y)("span",{css:{color:t.colors.blue500},children:r.source_id})})})})},o7=e=>{switch(e.source_type){case"HUMAN":return eC.A;case"LLM_JUDGE":return o5.A;default:return eS.A}},o6=e=>{let{renderConnector:r=!0,assessment:t,setIsEditing:n}=e,{theme:a}=(0,s.wn)(),[l,c]=(0,i.useState)(!1),d=o7(t.source);return(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",alignItems:"center"},children:[r&&(0,o.Y)("div",{css:{position:"absolute",left:-1,top:0,width:10,height:a.typography.lineHeightBase,boxSizing:"border-box",borderBottomLeftRadius:a.borders.borderRadiusMd,borderBottom:`1px solid ${a.colors.border}`,borderLeft:`1px solid ${a.colors.border}`}}),(0,o.Y)(d,{size:a.typography.fontSizeSm,css:{padding:2,backgroundColor:a.colors.actionIconBackgroundHover,borderRadius:a.borders.borderRadiusFull}}),(0,o.Y)(o4,{source:t.source}),(0,o.FD)("div",{css:{marginLeft:"auto",display:"flex",flexDirection:"row",alignItems:"center",gap:a.spacing.xs},children:[t.last_update_time&&(0,o.Y)(rD.o.Text,{color:"secondary",size:"sm",css:{marginLeft:a.spacing.sm,overflow:"hidden",textOverflow:"ellipsis",textWrap:"nowrap"},children:nS(new Date(t.last_update_time))}),(0,o.Y)(oB,{assessment:t,setIsEditing:n,setShowDeleteModal:c}),(0,o.Y)(oz,{assessment:t,isModalVisible:l,setIsModalVisible:c})]})]})};var o9=t(62037);let o8=e=>{let{error:r}=e,{theme:t}=(0,s.wn)(),[n,a]=(0,i.useState)(!1);return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:t.spacing.xs},children:[(0,o.Y)(o9.F,{type:"error",closable:!1,message:r.error_code,componentId:"shared.model-trace-explorer.feedback-error-item",description:(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:t.spacing.xs},children:[(0,o.Y)("span",{children:r.error_message}),r.stack_trace&&(0,o.Y)(rD.o.Link,{componentId:"shared.model-trace-explorer.feedback-error-item-stack-trace-link",onClick:()=>a(!0),children:(0,o.Y)(c.sA,{id:"z/CjX4",defaultMessage:"View stack trace"})})]})}),r.stack_trace&&(0,o.Y)(oW.aF,{title:(0,o.Y)(c.sA,{id:"KqReh3",defaultMessage:"Error stack trace"}),visible:n,componentId:"shared.model-trace-explorer.feedback-error-stack-trace-modal",footer:null,onCancel:()=>a(!1),children:(0,o.Y)(tz,{data:JSON.stringify(r.stack_trace),title:"",initialRenderMode:ev.TEXT})})]})},ie=e=>{let{feedback:r}=e,{theme:t}=(0,s.wn)(),n=r.feedback.value;return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",position:"relative"},children:[(0,o.Y)(o6,{renderConnector:!1,assessment:r}),(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:t.spacing.xs,marginLeft:10,paddingLeft:t.spacing.md,paddingTop:t.spacing.sm,paddingBottom:t.spacing.md,paddingRight:t.spacing.lg,borderLeft:`1px solid ${t.colors.border}`},children:[(0,Z.isNil)(r.feedback.error)?(0,o.FD)(o.FK,{children:[(0,o.Y)(rD.o.Text,{size:"sm",color:"secondary",children:(0,o.Y)(c.sA,{id:"RGKRP9",defaultMessage:"Feedback"})}),(0,o.Y)("div",{children:(0,o.Y)(o3,{jsonValue:JSON.stringify(n)})})]}):(0,o.Y)(o8,{error:r.feedback.error}),r.rationale&&(0,o.FD)(o.FK,{children:[(0,o.Y)(rD.o.Text,{size:"sm",color:"secondary",css:{marginTop:t.spacing.xs},children:(0,o.Y)(c.sA,{id:"gYOuKs",defaultMessage:"Rationale"})}),(0,o.Y)(tM,{children:r.rationale})]})]})]})},ir=e=>{let r=new Set,t=[],n=e;for(;n&&!r.has(n.assessment_id);)r.add(n.assessment_id),t.push(n),n=n.overriddenAssessment;return t},it=e=>{let{isModalVisible:r,setIsModalVisible:t,feedback:n}=e,a=(0,i.useMemo)(()=>ir(n),[n]);return(0,o.Y)(oW.aF,{componentId:"shared.model-trace-explorer.feedback-history-modal",visible:r,footer:null,onCancel:()=>{t(!1)},title:(0,o.Y)(c.sA,{id:"n6SrIn",defaultMessage:"Edit history"}),children:a.map(e=>"feedback"in e?(0,o.Y)(ie,{feedback:e},e.assessment_id):null)})},io=e=>{let{feedback:r}=e,[t,n]=(0,i.useState)(!1),{theme:a}=(0,s.wn)(),{nodeMap:l,activeView:d}=rZ(),u=r.feedback.value,p=r.span_id?l[r.span_id]:null,g="summary"===d&&p;return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:a.spacing.sm,marginLeft:a.spacing.lg},children:[!(0,Z.isNil)(r.feedback.error)&&(0,o.Y)(o8,{error:r.feedback.error}),g&&(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:a.spacing.xs},children:[(0,o.Y)(rD.o.Text,{size:"sm",color:"secondary",children:(0,o.Y)(c.sA,{id:"+hQbnS",defaultMessage:"Span"})}),(0,o.Y)(oX,{node:p})]}),(0,Z.isNil)(r.feedback.error)&&(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:a.spacing.xs},children:[(0,o.Y)(rD.o.Text,{size:"sm",color:"secondary",children:(0,o.Y)(c.sA,{id:"RGKRP9",defaultMessage:"Feedback"})}),(0,o.FD)("div",{css:{display:"flex",gap:a.spacing.xs},children:[(0,o.Y)(o3,{jsonValue:JSON.stringify(u)}),r.overriddenAssessment&&(0,o.FD)(o.FK,{children:[(0,o.Y)("span",{onClick:()=>n(!0),children:(0,o.Y)(rD.o.Text,{css:{"&:hover":{textDecoration:"underline",cursor:"pointer"}},color:"secondary",children:(0,o.Y)(c.sA,{id:"f4CfIz",defaultMessage:"(edited)"})})}),(0,o.Y)(it,{isModalVisible:t,setIsModalVisible:n,feedback:r})]})]})]}),r.rationale&&(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:a.spacing.xs},children:[(0,o.Y)(rD.o.Text,{size:"sm",color:"secondary",children:(0,o.Y)(c.sA,{id:"gYOuKs",defaultMessage:"Rationale"})}),(0,o.Y)("div",{css:{"& > div:last-of-type":{marginBottom:0}},children:(0,o.Y)(tM,{children:r.rationale})})]})]})},ii=e=>{let{feedback:r}=e,{theme:t}=(0,s.wn)(),[n,a]=(0,i.useState)(!1);return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:t.spacing.xs,paddingLeft:t.spacing.lg/2,marginLeft:t.spacing.lg/2,paddingTop:t.spacing.sm,paddingBottom:t.spacing.sm,borderLeft:`1px solid ${t.colors.border}`,position:"relative"},children:[(0,o.Y)(o6,{assessment:r,setIsEditing:a}),n?(0,o.Y)(oq,{assessment:r,onSuccess:()=>a(!1),onCancel:()=>a(!1)}):(0,o.Y)(io,{feedback:r})]})},ia=e=>{let r={"& > svg":{width:12,height:12}};switch(e){case"HUMAN":return(0,o.Y)(eC.A,{css:r});case"LLM_JUDGE":return(0,o.Y)(o5.A,{css:r});case"CODE":return(0,o.Y)(eS.A,{css:r});default:return null}},is=e=>{let{feedbacks:r}=e,{theme:t}=(0,s.wn)();if(r.length<2)return null;let n=(0,Z.countBy)(r,e=>e.source.source_type);return(0,o.Y)("div",{css:{display:"flex",gap:t.spacing.xs,alignItems:"center",marginLeft:t.spacing.xs},children:Object.entries(n).map(e=>{let[r,n]=e;return(0,o.Y)(r2.v,{componentId:`shared.model-trace-explorer.feedback-source-count-${r}`,css:{margin:0},children:(0,o.FD)("div",{css:{display:"flex",alignItems:"center",gap:t.spacing.xs},children:[ia(r),(0,o.Y)(rD.o.Text,{children:n})]})},r)})})},il=e=>{let{jsonValue:r,feedbacks:t}=e,{theme:n}=(0,s.wn)(),[a,l]=(0,i.useState)(!1);return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column"},children:[(0,o.FD)("div",{css:{display:"flex",gap:n.spacing.xs,alignItems:"center"},children:[(0,o.Y)(rO.$n,{componentId:"shared.model-trace-explorer.toggle-assessment-expanded",css:{flexShrink:0},size:"small",icon:a?(0,o.Y)(rL.A,{}):(0,o.Y)(t$.A,{}),onClick:()=>l(!a)}),(0,o.Y)(o3,{jsonValue:r}),(0,o.Y)(is,{feedbacks:t})]}),a&&(0,o.Y)("div",{css:{display:"flex",flexDirection:"column"},children:t.map(e=>(null==e?void 0:e.valid)===!1?null:(0,o.Y)(ii,{feedback:e},e.assessment_id))})]})},ic=e=>{let{name:r,valuesMap:t,traceId:n,activeSpanId:a}=e,{theme:l}=(0,s.wn)(),c=nx(r),[d,u]=(0,i.useState)(!1),p=Object.values(t).flat().some(e=>!(0,Z.isNil)(e.feedback.error));return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",marginBottom:l.spacing.sm,border:`1px solid ${l.colors.border}`,borderRadius:l.borders.borderRadiusMd,padding:l.spacing.sm+l.spacing.xs,paddingTop:l.spacing.sm,gap:l.spacing.sm},children:[(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",gap:l.spacing.sm},children:[(0,o.FD)("div",{css:{display:"flex",alignItems:"center",gap:l.spacing.sm,flex:1,minWidth:0},children:[(0,o.Y)(rD.o.Text,{bold:!0,css:{overflow:"hidden",textOverflow:"ellipsis",textWrap:"nowrap"},children:c}),p&&(0,o.Y)(o1.A,{css:{flexShrink:0},color:"danger"})]}),(0,o.Y)(tV.m,{content:"Add new feedback",componentId:"shared.model-trace-explorer.add-feedback-in-group-tooltip",children:(0,o.Y)(rO.$n,{componentId:"shared.model-trace-explorer.add-feedback",css:{flexShrink:0,marginRight:-l.spacing.xs},size:"small",icon:(0,o.Y)(ng.A,{}),onClick:()=>u(!0)})})]}),Object.entries(t).map(e=>{let[r,t]=e;return(0,o.Y)(il,{jsonValue:r,feedbacks:t},r)}),d&&(0,o.Y)(ok,{assessmentName:r,spanId:a,traceId:n,setExpanded:u})]})},id=e=>{let r={};return e.forEach(e=>{if(!1===e.valid)return;let t=null;""!==e.feedback.value&&(t=JSON.stringify(e.feedback.value));let{assessment_name:n}=e;r[n]||(r[n]={});let o=r[n];(0,Z.isNil)(t)||(o[t]||(o[t]=[]),o[t].push(e))}),r},iu=e=>{let{assessments:r,traceId:t,activeSpanId:n}=e,{theme:a}=(0,s.wn)(),{setAssessmentsPaneExpanded:l}=rZ(),[d,u]=(0,i.useMemo)(()=>(0,Z.partition)(r,e=>"feedback"in e),[r]),p=(0,i.useMemo)(()=>id(d),[d]);return(0,o.FD)("div",{"data-testid":"assessments-pane",css:{display:"flex",flexDirection:"column",padding:a.spacing.sm,paddingTop:a.spacing.xs,height:"100%",borderLeft:`1px solid ${a.colors.border}`,overflowY:"scroll",minWidth:250,width:"100%",boxSizing:"border-box"},children:[(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[(0,o.Y)(rD.o.Text,{css:{marginBottom:a.spacing.sm},bold:!0,children:(0,o.Y)(c.sA,{id:"++Ydlz",defaultMessage:"Assessments"})}),l&&(0,o.Y)(tV.m,{componentId:"shared.model-trace-explorer.close-assessments-pane-tooltip",content:(0,o.Y)(c.sA,{id:"cQQnzX",defaultMessage:"Hide assessments"}),children:(0,o.Y)(rO.$n,{"data-testid":"close-assessments-pane-button",componentId:"shared.model-trace-explorer.close-assessments-pane",size:"small",icon:(0,o.Y)(np.A,{}),onClick:()=>l(!1)})})]}),Object.entries(p).map(e=>{let[r,i]=e;return(0,o.Y)(ic,{name:r,valuesMap:i,traceId:t,activeSpanId:n},r)}),u.length>0&&(0,o.FD)(o.FK,{children:[(0,o.Y)(rD.o.Text,{color:"secondary",css:{marginBottom:a.spacing.sm},children:(0,o.Y)(c.sA,{id:"UbXw8O",defaultMessage:"Expectations"})}),(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:a.spacing.sm,marginBottom:a.spacing.sm},children:u.map(e=>(0,o.Y)(o0,{expectation:e},e.assessment_id))})]}),(0,o.Y)(oL,{title:"Add new assessment",spanId:n,traceId:t})]})},ip=a().memo(function(e){let{activeSpan:r,searchFilter:t,activeMatch:n,activeTab:a,setActiveTab:d}=e,{theme:u}=(0,s.wn)(),[p,g]=(0,i.useState)(500),m={flex:1,marginTop:-u.spacing.md,overflowY:"auto"},{assessmentsPaneExpanded:f,assessmentsPaneEnabled:h}=rZ();if((0,Z.isNil)(r))return(0,o.Y)(r0.S,{description:"Please select a span to view more information"});let E=e6(r),v=(0,o.FD)(l.Root,{componentId:"shared.model-trace-explorer.right-pane-tabs",css:{display:"flex",flexDirection:"column",flex:1,borderLeft:`1px solid ${u.colors.border}`,minWidth:200,position:"relative"},value:a,onValueChange:e=>d(e),children:[(0,o.Y)("div",{css:{position:"absolute",right:f?u.spacing.xs:u.spacing.md,top:u.spacing.xs},children:(0,o.Y)(nu,{})}),(0,o.FD)(l.List,{css:{padding:0,paddingLeft:u.spacing.md,paddingRight:u.spacing.sm,boxSizing:"border-box",width:"100%"},children:[r.chatMessages&&(0,o.Y)(l.Trigger,{value:"chat",children:(0,o.Y)(c.sA,{id:"BkDhmT",defaultMessage:"Chat"})}),(0,o.Y)(l.Trigger,{value:"content",children:(0,o.Y)(c.sA,{id:"KW2dOC",defaultMessage:"Inputs / Outputs"})}),(0,o.Y)(l.Trigger,{value:"attributes",children:"Attributes"}),(0,o.FD)(l.Trigger,{value:"events",children:["Events ",E>0&&(0,o.Y)(nc,{count:E})]})]}),r.chatMessages&&(0,o.Y)(l.Content,{css:m,value:"chat",children:(0,o.Y)(t5,{chatMessages:r.chatMessages,chatTools:r.chatTools})}),(0,o.Y)(l.Content,{css:m,value:"content",children:(0,o.Y)(na,{activeSpan:r,searchFilter:t,activeMatch:n})}),(0,o.Y)(l.Content,{css:m,value:"attributes",children:(0,o.Y)(tG,{activeSpan:r,searchFilter:t,activeMatch:n})}),(0,o.Y)(l.Content,{css:m,value:"events",children:(0,o.Y)(nl,{activeSpan:r,searchFilter:t,activeMatch:n})})]});return h&&f?(0,o.Y)(rY,{initialRatio:.7,paneWidth:p,setPaneWidth:g,leftChild:v,leftMinWidth:250,rightChild:(0,o.Y)(iu,{assessments:r.assessments,traceId:r.traceId,activeSpanId:r.parentId?String(r.key):void 0}),rightMinWidth:250}):v});var ig=t(20054),im=t(77518),ih=t(52181),iE=t(97242),iv=t(78757),iy=t(25385);let ib=e=>{let{spanFilterState:r,setSpanFilterState:t}=e,{theme:n}=(0,s.wn)();return(0,o.FD)(ih.Root,{componentId:"shared.model-trace-explorer.timeline-tree-filter-popover",children:[(0,o.Y)(ih.Trigger,{asChild:!0,children:(0,o.Y)(rO.$n,{componentId:"shared.model-trace-explorer.timeline-tree-filter-button",icon:(0,o.Y)(iE.A,{}),size:"small",children:(0,o.Y)(c.sA,{id:"Dm4Ez0",defaultMessage:"Filter"})})}),(0,o.Y)(ih.Content,{align:"start",children:(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:n.spacing.sm,paddingBottom:n.spacing.xs},children:[(0,o.Y)(rD.o.Text,{bold:!0,children:(0,o.Y)(c.sA,{id:"oy2LTl",defaultMessage:"Filter"})}),(0,o.Y)(rD.o.Text,{color:"secondary",children:(0,o.Y)(c.sA,{id:"rgSaFx",defaultMessage:"Span type"})}),Object.entries(r.spanTypeDisplayState).map(e=>{let[i,a]=e,s=(0,o.Y)(eD,{type:eO(i)});return(0,o.FD)(iv.Sc,{componentId:`shared.model-trace-explorer.toggle-span-filter_${i}-${!a}`,style:{width:"100%"},isChecked:a,onChange:()=>t({...r,spanTypeDisplayState:{...r.spanTypeDisplayState,[i]:!a}}),children:[s,(0,o.Y)(rD.o.Text,{css:{marginLeft:n.spacing.xs},children:function(e){switch(e){case ef.LLM:return"LLM";case ef.CHAIN:return"Chain";case ef.AGENT:return"Agent";case ef.TOOL:return"Tool";case ef.CHAT_MODEL:return"Chat model";case ef.RETRIEVER:return"Retriever";case ef.PARSER:return"Parser";case ef.EMBEDDING:return"Embedding";case ef.RERANKER:return"Reranker";case ef.FUNCTION:return"Function";case ef.UNKNOWN:return"Unknown";default:return e}}(i)})]},i)}),(0,o.Y)(rD.o.Text,{color:"secondary",children:(0,o.Y)(c.sA,{id:"SrV58C",defaultMessage:"Settings"})}),(0,o.FD)(iv.Sc,{componentId:`shared.model-trace-explorer.toggle-show-parents_${!r.showParents}`,style:{width:"100%"},isChecked:r.showParents,onChange:()=>t({...r,showParents:!r.showParents}),children:[(0,o.Y)(rD.o.Text,{css:{marginRight:n.spacing.xs},children:(0,o.Y)(c.sA,{id:"nYSJgH",defaultMessage:"Show all parent spans"})}),(0,o.Y)(iy.I,{componentId:"shared.model-trace-explorer.show-parents-tooltip",content:(0,o.Y)(c.sA,{id:"H9MulE",defaultMessage:"Always show parents of matched spans, regardless of filter conditions"})})]}),(0,o.FD)(iv.Sc,{componentId:`shared.model-trace-explorer.toggle-show-parents_${!r.showExceptions}`,style:{width:"100%"},isChecked:r.showExceptions,onChange:()=>t({...r,showExceptions:!r.showExceptions}),children:[(0,o.Y)(rD.o.Text,{css:{marginRight:n.spacing.xs},children:(0,o.Y)(c.sA,{id:"/vhBCt",defaultMessage:"Show exceptions"})}),(0,o.Y)(iy.I,{componentId:"shared.model-trace-explorer.show-exceptions-tooltip",content:(0,o.Y)(c.sA,{id:"60b0vW",defaultMessage:"Always show spans with exceptions, regardless of filter conditions"})})]})]})})]})},ix=e=>{let{showTimelineInfo:r,setShowTimelineInfo:t,spanFilterState:n,setSpanFilterState:i}=e,{theme:a}=(0,s.wn)();return(0,o.FD)("div",{css:{padding:`${a.spacing.xs}px ${a.spacing.sm}px`,paddingBottom:3,borderBottom:`1px solid ${a.colors.border}`,boxSizing:"border-box",paddingLeft:a.spacing.sm,alignItems:"center",display:"flex",justifyContent:"space-between"},children:[(0,o.Y)(rD.o.Text,{bold:!0,children:(0,o.Y)(c.sA,{id:"w48V74",defaultMessage:"Trace breakdown"})}),(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",gap:a.spacing.sm},children:[(0,o.Y)(ib,{spanFilterState:n,setSpanFilterState:i}),(0,o.FD)(nr.d,{name:"size-story",value:r,onChange:e=>{t(e.target.value)},size:"small",componentId:"shared.model-trace-explorer.toggle-show-timeline",children:[(0,o.Y)(nr.E,{"data-testid":"hide-timeline-info-button",icon:(0,o.Y)(tV.m,{componentId:"shared.model-trace-explorer.hide-timeline-info-tooltip",content:(0,o.Y)(c.sA,{id:"E9fsRD",defaultMessage:"Show span tree"}),children:(0,o.Y)(ig.A,{})}),value:!1}),(0,o.Y)(nr.E,{"data-testid":"show-timeline-info-button",icon:(0,o.Y)(tV.m,{componentId:"shared.model-trace-explorer.show-timeline-info-tooltip",content:(0,o.Y)(c.sA,{id:"r5t1Je",defaultMessage:"Show execution timeline"}),children:(0,o.Y)(im.A,{})}),value:!0})]})]})]})},iS=e=>{let{active:r}=e,{theme:t}=(0,s.wn)(),n=r?t.colors.blue500:t.colors.border;return(0,o.Y)("div",{css:{position:"absolute",left:"100%",bottom:0,width:9,height:t.spacing.md,boxSizing:"border-box",borderTopRightRadius:t.borders.borderRadiusMd,borderTop:`1px solid ${n}`,borderRight:`1px solid ${n}`,zIndex:rF.LOW}})},iT=e=>{let{active:r}=e,{theme:t}=(0,s.wn)(),n=r?t.colors.blue500:t.colors.border;return(0,o.Y)("div",{css:{position:"absolute",left:"50%",top:0,width:8,height:t.spacing.md,boxSizing:"border-box",borderBottomLeftRadius:t.borders.borderRadiusMd,borderBottom:`1px solid ${n}`,borderLeft:`1px solid ${n}`,zIndex:r?rF.NORMAL:rF.LOW}})},iI=e=>{let{active:r}=e,{theme:t}=(0,s.wn)(),n=r?t.colors.blue500:t.colors.border;return(0,o.Y)("div",{css:{position:"absolute",width:8,left:"50%",height:32,borderLeft:`1px solid ${n}`,boxSizing:"border-box",zIndex:r?rF.NORMAL:rF.LOW}})},i_=e=>{let{isActiveSpan:r,isInActiveChain:t,linesToRender:n,hasChildren:i,isExpanded:a}=e;if(0===n.length)return(0,o.Y)("div",{css:{width:0,height:32,boxSizing:"border-box",position:"relative"},children:i&&(0,o.Y)(iS,{active:t&&!r})});return(0,o.Y)(o.FK,{children:n.map((e,s)=>{let{shouldRender:l,isActive:c}=e;return(0,o.FD)("div",{css:{width:16,height:32,boxSizing:"border-box",position:"relative"},children:[l&&(0,o.Y)(iI,{active:c}),s===n.length-1&&(0,o.FD)(o.FK,{children:[(0,o.Y)(iT,{active:t}),i&&a&&(0,o.Y)(iS,{active:t&&!r})]})]},s)})})},iA=e=>{var r;let{span:t,children:n}=e,{theme:i}=(0,s.wn)(),a=eO(null!=(r=t.type)?r:ef.UNKNOWN),l=i.isDarkMode?i.colors.grey800:i.colors.grey100,d=i.isDarkMode?i.colors.grey500:i.colors.grey350;return(0,o.Y)(tV.m,{componentId:"shared.model-trace-explorer.timeline-tree-node-tooltip",hideWhenDetached:!1,content:(0,o.FD)("div",{css:{display:"flex",flexDirection:"column"},children:[(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",gap:i.spacing.xs,alignItems:"center",overflow:"hidden",wordBreak:"break-all"},children:[(0,o.Y)(eD,{type:a,isInTooltip:!0}),(0,o.Y)("span",{css:{color:l},children:t.title}),(0,o.Y)("span",{css:{marginLeft:i.spacing.xs,color:d,fontSize:i.typography.fontSizeSm},children:rG(t.end-t.start)})]}),(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",color:l},children:[(0,o.Y)(c.sA,{id:"YV6xFB",defaultMessage:"Start:"})," ",rG(t.start)," | ",(0,o.Y)(c.sA,{id:"q90jVU",defaultMessage:"End:"})," ",rG(t.end)]})]}),side:"right",maxWidth:700,children:n})},iR=e=>{var r,t;let{node:n,selectedKey:i,expandedKeys:a,setExpandedKeys:l,traceStartTime:c,traceEndTime:d,onSelect:u,linesToRender:p}=e,g=a.has(n.key),{theme:m}=(0,s.wn)(),f=(null!=(t=n.children)?t:[]).length>0,{setAssessmentsPaneExpanded:h}=rZ(),E=i===n.key,v=r$(n,String(i)),y=e6(n)>0,b=E?m.colors.actionDefaultBackgroundHover:"transparent";return(0,o.FD)(o.FK,{children:[(0,o.Y)(iA,{span:n,children:(0,o.Y)("div",{"data-testid":`timeline-tree-node-${n.key}`,css:{display:"flex",flexDirection:"column",width:"100%",cursor:"pointer",boxSizing:"border-box",backgroundColor:b,":hover":{backgroundColor:m.colors.actionDefaultBackgroundHover},":active":{backgroundColor:m.colors.actionDefaultBackgroundPress}},onClick:()=>{null==u||u(n)},children:(0,o.Y)("div",{css:{display:"flex",flexDirection:"row",alignItems:"center",padding:`0px ${m.spacing.sm}px`,justifyContent:"space-between",overflow:"hidden",flex:1},children:(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",alignItems:"center",overflow:"hidden",flex:1},children:[f?(0,o.Y)(rO.$n,{size:"small","data-testid":`toggle-span-expanded-${n.key}`,css:{flexShrink:0,marginRight:m.spacing.xs},icon:g?(0,o.Y)(rL.A,{}):(0,o.Y)(t$.A,{}),onClick:e=>{e.stopPropagation();let r=new Set(a);g?r.delete(n.key):r.add(n.key),l(r)},componentId:"shared.model-trace-explorer.toggle-span"}):(0,o.Y)("div",{css:{width:24,marginRight:m.spacing.xs}}),(0,o.Y)(i_,{isActiveSpan:E,isInActiveChain:v>-1,linesToRender:p,hasChildren:f,isExpanded:g}),(0,o.Y)("span",{css:{flexShrink:0,marginRight:m.spacing.xs,borderRadius:m.borders.borderRadiusSm,border:`1px solid ${v>-1?m.colors.blue500:m.colors.backgroundSecondary}`,zIndex:rF.NORMAL},children:n.icon}),(0,o.Y)(rD.o.Text,{color:y?"error":"primary",css:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",flex:1},children:n.title}),n.assessments.length>0&&(0,o.FD)(r2.v,{color:"indigo","data-testid":`assessment-tag-${n.key}`,componentId:"shared.model-trace-explorer.assessment-count",css:{margin:0,borderRadius:m.borders.borderRadiusSm},onClick:()=>null==h?void 0:h(!0),children:[(0,o.Y)(nd.A,{}),(0,o.Y)(rD.o.Text,{css:{marginLeft:m.spacing.xs},children:n.assessments.length})]})]})})})}),g&&(null==(r=n.children)?void 0:r.map((e,r)=>{var t,s;return(0,o.Y)(iR,{node:e,expandedKeys:a,setExpandedKeys:l,selectedKey:i,traceStartTime:c,traceEndTime:d,onSelect:u,linesToRender:p.concat({shouldRender:r<(null!=(s=null==(t=n.children)?void 0:t.length)?s:0)-1,isActive:r<v})},e.key)}))]})},iw=e=>{var r;let{node:t,selectedKey:n,leftOffset:a,width:l,onSelect:c,expandedKeys:d,setExpandedKeys:u}=e,{theme:p}=(0,s.wn)(),g=(0,i.useRef)(null),m=(0,i.useRef)(null),f=n===t.key?p.colors.actionDefaultBackgroundHover:"transparent",h=(null!=(r=t.children)?r:[]).length>0,E=d.has(t.key);return(0,i.useLayoutEffect)(()=>{if(!g.current||!m.current)return;Math.max(g.current.offsetWidth,m.current.offsetWidth)<l-p.spacing.sm?(g.current.style.display="inline",m.current.style.display="none"):(g.current.style.display="none",m.current.style.display="inline")},[p.spacing.sm,l]),(0,o.Y)(iA,{span:t,children:(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",cursor:"pointer",boxSizing:"border-box",paddingLeft:p.spacing.xs,paddingRight:p.spacing.sm,paddingTop:p.spacing.xs,paddingBottom:p.spacing.xs,backgroundColor:f,alignItems:"center",":hover":{backgroundColor:p.colors.actionDefaultBackgroundHover},":active":{backgroundColor:p.colors.actionDefaultBackgroundPress},zIndex:rF.NORMAL},onClick:()=>null==c?void 0:c(t),children:[h?(0,o.Y)(rO.$n,{size:"small","data-testid":`toggle-timeline-span-expanded-${t.key}`,css:{flexShrink:0,marginRight:p.spacing.xs},icon:E?(0,o.Y)(rL.A,{}):(0,o.Y)(t$.A,{}),onClick:e=>{e.stopPropagation();let r=new Set(d);E?r.delete(t.key):r.add(t.key),u(r)},componentId:"shared.model-trace-explorer.toggle-timeline-span"}):(0,o.Y)("div",{css:{width:24,marginRight:p.spacing.xs}}),(0,o.Y)("div",{css:{width:a,flexShrink:0}}),(0,o.Y)("div",{css:{position:"relative",width:l,height:p.typography.lineHeightBase,backgroundColor:p.colors.blue600,borderRadius:p.borders.borderRadiusSm,flexShrink:0},children:(0,o.Y)(rD.o.Text,{children:(0,o.Y)("span",{ref:g,css:{marginLeft:p.spacing.xs,color:p.colors.white,display:"none"},children:t.title})})}),(0,o.FD)("div",{css:{flex:1,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:[(0,o.Y)(rD.o.Text,{children:(0,o.Y)("span",{ref:m,css:{marginLeft:p.spacing.xs,color:p.colors.textPrimary},children:t.title})}),(0,o.Y)(rD.o.Text,{css:{marginLeft:p.spacing.xs},color:"secondary",children:rG(t.end-t.start)})]})]},t.key)})},iN=e=>{var r,t;let{nodes:n,selectedKey:a,onSelect:l,traceStartTime:c,traceEndTime:d,expandedKeys:u,setExpandedKeys:p}=e,{theme:g}=(0,s.wn)(),m=(0,i.useRef)(null),f=null!=(t=null==(r=rN({ref:m}))?void 0:r.width)?t:0,h=(0,i.useMemo)(()=>(function(e,r,t){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:60,o=r-e;if(o<=0||t<=0)return[];let i=Math.floor(t/n);if(i<1)return[];let a=o/i,s=Math.pow(10,Math.floor(Math.log10(a))),l=a/s,c=(l<=1?1:l<=2?2:l<=5?5:10)*s,d=r+2*c,u=Math.ceil(e/c)*c,p=[];for(let e=u;e<=d;e+=c)p.push(Number(e.toFixed(10)));return p})(c,d,f),[d,c,f]),E=Math.min(...h),v=(h[h.length-1]+h[h.length-2])/2,y=h.slice(0,-1),b=e=>(e-E)/(v-E)*f;return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",position:"relative",boxSizing:"border-box"},children:[(0,o.Y)("div",{ref:m,css:{display:"flex",width:"100%",flexDirection:"row",height:g.typography.lineHeightBase,paddingLeft:32,paddingRight:g.spacing.lg,boxSizing:"border-box",position:"sticky",top:0,backgroundColor:g.colors.backgroundPrimary,zIndex:rF.HIGH},children:(0,o.Y)("div",{"data-testid":"time-marker-area",css:{position:"relative"},children:y.map(e=>(0,o.Y)(rD.o.Text,{css:{position:"absolute",transform:"translateX(-50%)",left:b(e),whiteSpace:"nowrap"},children:rG(e)},e))})}),(0,o.Y)("div",{css:{flex:1,pointerEvents:"none",zIndex:rF.LOW},children:(0,o.Y)("div",{css:{position:"absolute",height:"100%",width:"100%"},children:y.map(e=>(0,o.Y)("div",{css:{position:"absolute",left:b(e)+32,borderRight:`1px solid ${g.colors.border}`,height:"100%"}},e))})}),n.map(e=>{let r=b(e.start),t=b(e.end)-r;return(0,o.Y)(iw,{selectedKey:a,onSelect:l,node:e,leftOffset:r,width:t,expandedKeys:u,setExpandedKeys:p},e.key)})]})},iY=e=>{let{rootNodes:r,selectedNode:t,setSelectedNode:n,traceStartTime:a,traceEndTime:l,expandedKeys:d,setExpandedKeys:u,spanFilterState:p,setSpanFilterState:g,className:m}=e,{theme:f}=(0,s.wn)(),h=V(),E=en(),v=(0,i.useCallback)(e=>{O(h,E,{eventType:"component_click",eventEntity:{entityType:"component",entitySubType:"div",entityId:`shared.model-trace-explorer.${e.type}-span-click`},eventPayload:{interactionSubject:!0}})},[h,E]),y=(0,i.useCallback)(e=>{null==n||n(e),v(e)},[v,n]),{showTimelineTreeGantt:b,setShowTimelineTreeGantt:x}=rZ(),S=(0,i.useMemo)(()=>rB(r,d),[r,d]),T=(0,i.useMemo)(()=>{var e;return(0,o.Y)("div",{css:{flex:1,overflow:"auto",minHeight:"100%",boxSizing:"border-box",display:"flex",flexDirection:"column"},children:b?(0,o.Y)(iN,{nodes:S,selectedKey:null!=(e=null==t?void 0:t.key)?e:"",onSelect:y,traceStartTime:a,traceEndTime:l,expandedKeys:d,setExpandedKeys:u}):r.map(e=>{var r;return(0,o.Y)(iR,{node:e,expandedKeys:d,setExpandedKeys:u,selectedKey:null!=(r=null==t?void 0:t.key)?r:"",traceStartTime:a,traceEndTime:l,onSelect:y,linesToRender:[]},e.key)})})},[b,S,null==t?void 0:t.key,y,a,l,r,d,u]);return(0,o.Y)("div",{css:{height:"100%",borderRadius:f.legacyBorders.borderRadiusMd,overflow:"hidden",display:"flex"},className:m,children:(0,o.Y)("div",{css:{overflow:"hidden",display:"flex",flexDirection:"column",flex:1},children:(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,o.Y)(ix,{showTimelineInfo:b,setShowTimelineInfo:x,spanFilterState:p,setSpanFilterState:g}),r.length>0?(0,o.Y)("div",{css:{flex:1,overflowY:"auto",display:"flex"},children:T}):(0,o.Y)("div",{css:{flex:1,display:"flex",justifyContent:"center",padding:f.spacing.md,paddingTop:f.spacing.lg},children:(0,o.Y)(c.sA,{id:"4pXg9j",defaultMessage:"No results found. Try using a different search term."})})]})})})},iC=()=>{if(window.innerWidth<=768)return .33;return .25},iM=e=>{var r,t;let{modelTrace:n,className:a,selectedSpanId:l,onSelectSpan:c}=e,{theme:d}=(0,s.wn)(),u=iC(),p=(0,i.useRef)(null),[g,m]=(0,i.useState)(500),{rootNode:f,selectedNode:h,setSelectedNode:E,activeTab:v,setActiveTab:y}=rZ(),{expandedKeys:b,setExpandedKeys:x}=rz({rootNodes:f?[f]:[],initialExpandDepth:rU}),{matchData:S,searchFilter:T,setSearchFilter:I,spanFilterState:_,setSpanFilterState:A,filteredTreeNodes:R,handleNextSearchMatch:w,handlePreviousSearchMatch:N}=rQ({treeNode:f,selectedNode:h,setSelectedNode:E,setActiveTab:y,setExpandedKeys:x,modelTraceInfo:null==n?void 0:n.info});(0,i.useLayoutEffect)(()=>{x(new Set((0,Z.values)(rj(R,rU)).map(e=>e.key)))},[R,x]);let Y=(0,i.useMemo)(()=>Math.max(275,16*Math.max(...R.map(rK))+7*d.spacing.lg),[R,d.spacing.lg]);return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",flex:1,minHeight:0},className:a,children:[(0,o.Y)("div",{css:{padding:d.spacing.xs,borderBottom:`1px solid ${d.colors.border}`},children:(0,o.Y)(rP,{searchFilter:T,setSearchFilter:I,matchData:S,handleNextSearchMatch:w,handlePreviousSearchMatch:N})}),(0,o.Y)(rY,{ref:p,initialRatio:u,paneWidth:g,setPaneWidth:m,leftChild:(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",flex:1,minWidth:Y},children:(0,o.Y)(iY,{rootNodes:R,selectedNode:h,traceStartTime:null!=(r=null==f?void 0:f.start)?r:0,traceEndTime:null!=(t=null==f?void 0:f.end)?t:0,setSelectedNode:e=>{E(e),y((null==e?void 0:e.chatMessages)?"chat":"content"),(0,Z.isString)(null==e?void 0:e.key)&&(null==c||c(null==e?void 0:e.key))},css:{flex:1},expandedKeys:b,setExpandedKeys:x,spanFilterState:_,setSpanFilterState:A})}),leftMinWidth:Y,rightChild:(0,o.Y)(ip,{activeSpan:h,searchFilter:T,activeMatch:S.match,activeTab:v,setActiveTab:y}),rightMinWidth:500})]})};var iD=t(47133),iO=t(88671),ik=t(91757),iL=t(10986),iP=t(65816),iU=t(21826),iF=t(74281);class iB extends Error{constructor(e){super(e),this.name="ReactQueryAppError"}}let iW=e=>{if(e instanceof iB)return!1;return oS(e)};function ij(e,r,t){m.iT.sev2IfThrows(f.Es.Navigation,"reactQuery-error-handling-failure",()=>{if(e||iW(t)){let n=t;if(t instanceof Error){let e=Error(`queryKey: ${r} ${t.message}`);e.name=t.name,e.stack=t.stack,e.cause=t.cause,n=e}else n={error:t,queryKey:r};m.iT.sev2BurnRate(f.Es.Navigation,"reactQuery-query-cache",nG.i1.P999,nG.Ip.Min10,e,n)}})}function iz(e,r){m.iT.sev2IfThrows(f.Es.Navigation,"reactQuery-error-handling-failure",()=>{if(e)m.iT.sev2BurnRate(f.Es.Navigation,"reactQuery-mutation-cache",nG.i1.P999,nG.Ip.Min10,!0);else iW(r)&&((r instanceof Error||m.iT.isStringRecord(r))&&"string"==typeof r.message&&(0,oi.o)(r.message,(0,d.W)("databricks.fe.wexp.uncaughtReactQueryMutationExceptionsToIgnore","[]"),f.Es.Navigation)?m.iT.log("reactQuery-mutation-cache-preexisting",f.Es.Navigation,r):m.iT.sev2BurnRate(f.Es.Navigation,"reactQuery-mutation-cache",nG.i1.P999,nG.Ip.Min10,!1,r))})}new ik.E({...{defaultOptions:{queries:{retry:(e,r)=>(function(e,r){if(ob(r)&&429===r.response.status&&e<=5)return(0,G.y)("clientsideEvent",{eventType:"SharedQueryClientRetry",eventName:"RetryAttempt",retryCount:e}),!0;return!1})(e,r)}}},queryCache:new iL.$(function(){let{onError:e,onSuccess:r,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...t,onError:(r,t)=>{ij(!1,t.queryKey,r);let n=t.meta;return(null==n?void 0:n.__panelBoundaryLogger)&&n.__panelBoundaryLogger(r),null==e?void 0:e(r,t)},onSuccess:(e,t)=>(ij(!0,t.queryKey),null==r?void 0:r(e,t))}}()),mutationCache:new iP.q(function(){let{onError:e,onSuccess:r,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...t,onError:(r,t,n,o)=>(iz(!1,r),null==e?void 0:e(r,t,n,o)),onSuccess:(e,t,n,o)=>(iz(!0),null==r?void 0:r(e,t,n,o))}}()),logger:{log:console.log,warn:console.warn,error:()=>{}}});let iG=j(()=>(0,d.W)("databricks.fe.infra.enableUseQueryReactQueryWrapper",!1),iF.I,function(e,r,t){let n=(0,i.useMemo)(()=>(0,iU.vh)(e,r,t),[e,r,t]),o=function(){let{esComponent:e,errorBoundaryId:r}=E(),{UNSAFE_logErrorInPanelBoundary:t}=(0,i.useContext)(v),n={esComponent:e,errorBoundaryId:r,UNSAFE_logErrorInPanelBoundary:t,recordProto:en()},o=(0,i.useRef)(n);return o.current=n,o}(),a=(0,i.useCallback)(e=>{let r=o.current;if((null==r?void 0:r.UNSAFE_logErrorInPanelBoundary)&&(null==r?void 0:r.recordProto)&&!n.useErrorBoundary){let t=nN(e);r.UNSAFE_logErrorInPanelBoundary(t,r.recordProto)}},[o,n.useErrorBoundary]),s=(0,i.useMemo)(()=>({...n.meta,__panelBoundaryLogger:a}),[n.meta,a]);return(0,iF.I)({...n,meta:s})}),i$=e=>{let{traceId:r,setModelTrace:t,setAssessmentsPaneEnabled:n}=e;return iG({queryFn:()=>oY({traceId:r}),onSuccess:e=>{t(r=>{var t,n;return{data:r.data,info:null!=(n=null==e||null==(t=e.trace)?void 0:t.trace_info)?n:{}}}),n(!0)},onError:()=>{n(!1)}})},iK=e=>{let{title:r,tools:t}=e,{theme:n}=(0,s.wn)();return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:n.spacing.sm,padding:n.spacing.sm,border:`1px solid ${n.colors.border}`,borderRadius:n.borders.borderRadiusSm},children:[r&&(0,o.Y)(rD.o.Text,{css:{marginLeft:n.spacing.xs},bold:!0,children:r}),t.map(e=>(0,o.Y)(tH,{tool:e},e.function.name))]})},iH=e=>{let{title:r,documents:t}=e,{theme:n}=(0,s.wn)();return(0,o.FD)("div",{css:{backgroundColor:n.colors.backgroundPrimary,borderRadius:n.borders.borderRadiusSm,border:`1px solid ${n.colors.border}`},children:[r&&(0,o.Y)("div",{css:{padding:`${n.spacing.xs}px ${n.spacing.sm}px`,borderBottom:`1px solid ${n.colors.border}`},children:(0,o.Y)(rD.o.Text,{bold:!0,children:r})}),t.map((e,r)=>(0,o.Y)("div",{css:{borderBottom:r!==t.length-1?`1px solid ${n.colors.border}`:""},children:(0,o.Y)(ne,{text:e.page_content,metadata:e.metadata},r)},r))]})},iV=e=>{let{title:r,value:t}=e,{theme:n}=(0,s.wn)(),[a,l]=(0,i.useState)(!1),d=t.length>400,u=!a&&t.length>400?t.slice(0,400)+"...":t,p=d?{":hover":{backgroundColor:n.colors.actionIconBackgroundHover,cursor:"pointer"}}:{};return(0,o.FD)("div",{css:{border:`1px solid ${n.colors.border}`,borderRadius:n.borders.borderRadiusSm},children:[r&&(0,o.FD)("div",{role:"button",css:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:`${n.spacing.sm}px ${n.spacing.sm+n.spacing.xs}px`,...p},onClick:()=>l(!a),children:[(0,o.Y)(rD.o.Text,{bold:!0,children:r}),d&&(a?(0,o.Y)(rL.A,{}):(0,o.Y)(t$.A,{}))]}),(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",gap:n.spacing.sm,paddingLeft:n.spacing.sm+n.spacing.xs,paddingRight:n.spacing.sm+n.spacing.xs,paddingTop:r?0:n.spacing.sm,paddingBottom:n.spacing.sm,"& > div:last-of-type":{marginBottom:0}},children:[(0,o.Y)(tM,{children:u}),d&&(0,o.Y)(rD.o.Link,{onClick:()=>l(!a),componentId:"shared.model-trace-explorer.text-field-see-more-link",children:a?(0,o.Y)(c.sA,{id:"Y5Rr5k",defaultMessage:"See less"}):(0,o.Y)(c.sA,{id:"Hyv8Go",defaultMessage:"See more"})})]})]})},iZ=e=>{let{title:r,data:t,renderMode:n}=e,a=(0,i.useMemo)(()=>{try{return JSON.parse(t)}catch(e){return t}},[t]),s=(0,Z.isString)(a),l=rg(a),c=Array.isArray(a)&&a.length>0&&(0,Z.every)(a,rr),d=Array.isArray(a)&&a.length>0&&(0,Z.every)(a,e3);if("json"===n)return(0,o.Y)(tz,{title:r,data:t,initialRenderMode:ev.JSON});if("text"===n)return(0,o.Y)(tz,{title:r,data:t,initialRenderMode:ev.TEXT});if(s)return(0,o.Y)(iV,{title:r,value:a});if(l&&l.length>0)return(0,o.Y)(t2,{messages:l});if(c)return(0,o.Y)(iK,{title:r,tools:a});if(d)return(0,o.Y)(iH,{title:r,documents:a});return(0,o.Y)(tz,{title:r,data:t})},iq=e=>{var r;let{node:t}=e,{theme:n}=(0,s.wn)(),i=e7(t),a=!t.parentId,l=i[0];if(!l)return null;return(0,o.Y)(t3,{css:{marginBottom:a?n.spacing.sm:0},withBorder:a,sectionKey:l.name,title:(0,o.FD)("div",{css:{display:"flex",alignItems:"center",gap:n.spacing.sm},children:[(0,o.Y)(ns.A,{color:"danger"}),(0,o.Y)(rD.o.Text,{color:"error",bold:!0,children:"Exception"})]}),children:(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:n.spacing.sm,paddingBottom:n.spacing.sm,paddingLeft:a?0:n.spacing.lg},children:Object.entries(null!=(r=l.attributes)?r:{}).map(e=>{let[r,t]=e;return(0,o.Y)(iZ,{title:r,data:JSON.stringify(t,null,2),renderMode:"text"},r)})})},l.name)},iJ=e=>{let{node:r,renderMode:t}=e,{theme:n}=(0,s.wn)(),[a,l]=(0,i.useState)(!1),d=(0,i.useMemo)(()=>e1(r.inputs),[r]),u=(0,i.useMemo)(()=>e1(r.outputs),[r]),p=e7(r).length>0,g=d.length>0,m=u.length>0,{setSelectedNode:f,setActiveView:h,setShowTimelineTreeGantt:E}=rZ();return(0,o.FD)("div",{css:{display:"flex",flexDirection:"row",minHeight:48,flexShrink:0},children:[(0,o.Y)("div",{css:{height:48,display:"flex",alignItems:"center"},children:(0,o.Y)(rO.$n,{size:"small","data-testid":`toggle-span-expanded-${r.key}`,css:{flexShrink:0,marginRight:n.spacing.xs},icon:a?(0,o.Y)(rL.A,{}):(0,o.Y)(t$.A,{}),onClick:()=>l(!a),componentId:"shared.model-trace-explorer.toggle-span"})}),(0,o.Y)("div",{css:{position:"relative",boxSizing:"border-box",height:"100%",borderLeft:`2px solid ${n.colors.border}`,width:12},children:(0,o.Y)("div",{css:{position:"absolute",left:-2,top:14,height:12,width:12,boxSizing:"border-box",borderBottomLeftRadius:n.borders.borderRadiusMd,borderBottom:`2px solid ${n.colors.border}`,borderLeft:`2px solid ${n.colors.border}`}})}),(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",flex:1,minWidth:0},children:[(0,o.FD)("div",{css:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,o.Y)(rD.o.Text,{color:"secondary",css:{display:"inline-flex",alignItems:"center",height:48},children:(0,o.Y)(c.sA,{id:"SbMdmm",defaultMessage:"{spanName} was called",values:{spanName:(0,o.Y)(oX,{node:r})}})}),(0,o.Y)("span",{onClick:()=>{f(r),h("detail"),E(!0)},children:(0,o.Y)(rD.o.Text,{css:{"&:hover":{textDecoration:"underline",cursor:"pointer"}},color:"secondary",children:rG(r.end-r.start)})})]}),a&&(0,o.FD)("div",{children:[p&&(0,o.Y)(iq,{node:r}),g&&(0,o.Y)(t3,{sectionKey:"input",title:(0,o.Y)(c.sA,{id:"/TX1Az",defaultMessage:"Inputs"}),children:(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:n.spacing.sm,paddingLeft:n.spacing.lg,marginBottom:m?0:n.spacing.sm},children:d.map((e,r)=>{let{key:n,value:i}=e;return(0,o.Y)(iZ,{title:n,data:i,renderMode:t},n||r)})})}),m&&(0,o.Y)(t3,{sectionKey:"output",title:(0,o.Y)(c.sA,{id:"ZstVNI",defaultMessage:"Outputs"}),children:(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:n.spacing.sm,paddingLeft:n.spacing.lg,marginBottom:n.spacing.sm},children:u.map(e=>{let{key:r,value:n}=e;return(0,o.Y)(iZ,{title:r,data:n,renderMode:t},r)})})})]})]})]})},iX=e=>{let{rootNode:r,intermediateNodes:t}=e,{theme:n}=(0,s.wn)(),[a,l]=(0,i.useState)("default"),d=r.inputs,u=r.outputs,p=e7(r),g=t.length>0,m=p.length>0,f=e1(d),h=e1(u);return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",flex:1,minHeight:0,padding:n.spacing.md,paddingTop:n.spacing.sm,overflow:"auto",minWidth:400},children:[(0,o.Y)("div",{css:{display:"flex",flexDirection:"row",justifyContent:"flex-end",marginBottom:n.spacing.sm},children:(0,o.FD)("div",{css:{display:"flex",gap:n.spacing.sm},children:[(0,o.FD)(nr.d,{name:"render-mode",componentId:"shared.model-trace-explorer.summary-view.render-mode",value:a,size:"small",onChange:e=>l(e.target.value),children:[(0,o.Y)(nr.E,{value:"default",children:(0,o.Y)(c.sA,{id:"uYkbr+",defaultMessage:"Default"})}),(0,o.Y)(nr.E,{value:"json",children:(0,o.Y)(c.sA,{id:"XC1Pro",defaultMessage:"JSON"})})]}),(0,o.Y)(nu,{})]})}),m&&(0,o.Y)(iq,{node:r}),(0,o.Y)(t3,{withBorder:!0,title:(0,o.Y)(c.sA,{id:"/TX1Az",defaultMessage:"Inputs"}),css:{marginBottom:g?0:n.spacing.md},sectionKey:"summary-inputs",children:(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:n.spacing.sm},children:f.map((e,r)=>{let{key:t,value:n}=e;return(0,o.Y)(iZ,{title:t,data:n,renderMode:a},t||r)})})}),g&&t.map(e=>(0,o.Y)(iJ,{node:e,renderMode:a},e.key)),(0,o.Y)(t3,{withBorder:!0,title:(0,o.Y)(c.sA,{id:"ZstVNI",defaultMessage:"Outputs"}),sectionKey:"summary-outputs",children:(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",gap:n.spacing.sm},children:h.map((e,r)=>{let{key:t,value:n}=e;return(0,o.Y)(iZ,{title:t,data:n,renderMode:a},t||r)})})})]})},iQ=e=>{var r;if(!e.parentId)return!1;return[ef.AGENT,ef.RETRIEVER,ef.CHAT_MODEL,ef.TOOL,ef.LLM].includes(null!=(r=e.type)?r:ef.UNKNOWN)||e6(e)>0},i0=e=>{let{modelTrace:r}=e,{theme:t}=(0,s.wn)(),[n,a]=(0,i.useState)(500),{rootNode:l,nodeMap:d,assessmentsPaneEnabled:u,assessmentsPaneExpanded:p}=rZ(),g=(0,i.useMemo)(()=>Object.values(d).flatMap(e=>e.assessments),[d]),m=(0,i.useMemo)(()=>{if(!l)return[];return rW([l]).filter(iQ)},[l]);if(!l)return(0,o.Y)("div",{css:{marginTop:t.spacing.lg},children:(0,o.Y)(r0.S,{description:(0,o.Y)(c.sA,{id:"hm98EL",defaultMessage:"No span data to display"})})});return u&&p?(0,o.Y)(rY,{initialRatio:.75,paneWidth:n,setPaneWidth:a,leftChild:(0,o.Y)(iX,{rootNode:l,intermediateNodes:m}),rightChild:(0,o.Y)(iu,{assessments:g,traceId:l.traceId,activeSpanId:void 0}),leftMinWidth:400,rightMinWidth:250}):(0,o.Y)(iX,{rootNode:l,intermediateNodes:m})},i1=e=>{let{modelTrace:r,className:t,selectedSpanId:n,onSelectSpan:i}=e,{theme:a}=(0,s.wn)(),u=(0,d.W)("databricks.fe.traceExplorer.enableSummaryView",!1),{activeView:p,setActiveView:g}=rZ();if(!u)return(0,o.Y)("div",{css:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:(0,o.Y)(iM,{modelTrace:r,className:t,selectedSpanId:n,onSelectSpan:i})});return(0,o.FD)(l.Root,{componentId:"model-trace-explorer",value:p,onValueChange:e=>g(e),css:{"& > div:first-of-type":{marginBottom:0,flexShrink:0},display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[(0,o.FD)(l.List,{css:{paddingLeft:a.spacing.md,flexShrink:0},children:[(0,o.Y)(l.Trigger,{value:"summary",children:(0,o.Y)(c.sA,{id:"paolVF",defaultMessage:"Summary"})}),(0,o.Y)(l.Trigger,{value:"detail",children:(0,o.Y)(c.sA,{id:"Wh+aKq",defaultMessage:"Details & Timeline"})})]}),(0,o.Y)(l.Content,{value:"summary",css:{display:"flex",flexDirection:"column",flex:1,minHeight:0},children:(0,o.Y)(i0,{modelTrace:r})}),(0,o.Y)(l.Content,{value:"detail",css:{display:"flex",flexDirection:"column",flex:1,minHeight:0},children:(0,o.Y)(iM,{modelTrace:r,className:t,selectedSpanId:n,onSelectSpan:i})})]})},i2=e=>{let{modelTrace:r,className:t,initialActiveView:n="summary",selectedSpanId:a,onSelectSpan:s}=e,[l,c]=(0,i.useState)(r),[d,u]=(0,i.useState)(!0),p=eZ(r),{refetch:g}=i$({traceId:p,setModelTrace:c,setAssessmentsPaneEnabled:u}),m=(0,i.useMemo)(()=>({refetchTraceInfo:g}),[g]);return(0,i.useEffect)(()=>{c(r),g()},[p]),(0,o.Y)(oM.Provider,{value:m,children:(0,o.Y)(ec,{id:J.MLFLOW_CONTEXT,tags:{tagTracesRequestId:null!=p?p:""},children:(0,o.Y)(rq,{modelTrace:l,initialActiveView:n,selectedSpanIdOnRender:a,assessmentsPaneEnabled:d,children:(0,o.Y)(i1,{modelTrace:l,className:t,selectedSpanId:a,onSelectSpan:s})})})})};i2.Skeleton=e=>{let{label:r}=e,{theme:t}=(0,s.wn)();return(0,o.FD)("div",{css:{display:"flex",height:"100%"},children:[(0,o.FD)("div",{css:{flex:1},children:[(0,o.Y)("div",{css:{padding:t.spacing.sm,borderBottom:`1px solid ${t.colors.border}`},children:(0,o.Y)(iD.o,{label:r})}),(0,o.FD)("div",{css:{borderRadius:t.legacyBorders.borderRadiusMd,overflow:"hidden",display:"flex"},children:[(0,o.Y)("div",{css:{flex:1,padding:t.spacing.sm,borderRight:`1px solid ${t.colors.border}`},children:(0,o.Y)(iO.Q,{lines:5})}),(0,o.Y)("div",{css:{flex:2,padding:t.spacing.sm},children:(0,o.Y)(iO.Q,{lines:5})})]})]}),(0,o.Y)("div",{css:{padding:t.spacing.md,overflowY:"auto",flex:1},children:(0,o.Y)(iO.Q,{lines:12})})]})};var i3=t(67799);function i5(e,r,t,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){t(e);return}s.done?r(l):Promise.resolve(l).then(n,o)}function i4(e){var r;return(r=function*(){try{let r=yield fetch(`/ajax-api/2.0/mlflow/get-trace-artifact?request_id=${e}`),t=yield r.text(),n=JSON.parse(t);if(n.spans)return{info:{request_id:e},data:n};if(n.error_code)return n.message;return"Unknown error occurred"}catch(e){if(e instanceof Error)return e.message;if("string"==typeof e)return e;return"Unknown error occurred"}},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){i5(i,n,o,a,s,"next",e)}function s(e){i5(i,n,o,a,s,"throw",e)}a(void 0)})})()}function i7(e,r,t,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){t(e);return}s.done?r(l):Promise.resolve(l).then(n,o)}let i6=(e,r)=>{let t=new URLSearchParams;return t.append("selectedTraceId",e),t.append("compareRunsMode","TRACES"),`/#/experiments/${r}?${t.toString()}`},i9=()=>{let e=(0,i.useMemo)(()=>new URLSearchParams(window.location.search).getAll("trace_id"),[]),r=(0,i.useMemo)(()=>new URLSearchParams(window.location.search).getAll("experiment_id"),[]),[t,n]=(0,i.useState)(e.length>0?0:null),[a,l]=(0,i.useState)(null),[d,u]=(0,i.useState)(!0),[p,g]=(0,i.useState)(null),{theme:m}=(0,s.wn)();if((0,i.useEffect)(()=>{(()=>{var r;return(r=function*(){if(null===t)return;u(!0);let r=e[t],n=yield i4(r);"string"==typeof n?g(n):l(n),u(!1)},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){i7(i,n,o,a,s,"next",e)}function s(e){i7(i,n,o,a,s,"throw",e)}a(void 0)})})()})()},[t,e]),0===e.length||null===t)return null;if(d)return(0,o.Y)("div",{css:{width:"calc(100% - 2px)"},children:(0,o.Y)(rD.o.Text,{color:"secondary",children:(0,o.Y)(c.sA,{id:"JJFZ1V",defaultMessage:"Fetching trace data..."})})});if(!a)return(0,o.Y)("div",{css:{paddingTop:m.spacing.md,width:"calc(100% - 2px)"},children:(0,o.Y)(r0.S,{image:(0,o.Y)(o1.A,{}),description:(0,o.FD)(o.FK,{children:[(0,o.Y)(rD.o.Paragraph,{children:(0,o.Y)(c.sA,{id:"UD4Z+e",defaultMessage:"An error occurred while attempting to fetch trace data (ID: {traceId}). Please ensure that the MLflow tracking server is running, and that the trace data exists. Error details:",values:{traceId:e[t]}})}),p&&(0,o.Y)(rD.o.Paragraph,{children:p})]}),title:(0,o.Y)(c.sA,{id:"md81Lo",defaultMessage:"Error"})})});return(0,o.FD)("div",{css:{display:"flex",flexDirection:"column",border:`1px solid ${m.colors.border}`,height:"calc(100% - 2px)"},children:[(0,o.FD)("div",{css:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:`${m.spacing.xs}px ${m.spacing.md}px`},children:[(0,o.FD)("div",{css:{display:"flex",alignItems:"center",gap:m.spacing.sm},children:[(0,o.Y)(rD.o.Title,{level:4,withoutMargins:!0,children:"MLflow Trace UI"}),(0,o.Y)(iy.I,{componentId:"mlflow.notebook.trace-ui-info",iconTitle:"More information",maxWidth:400,content:(0,o.Y)(c.sA,{id:"LED2z5",defaultMessage:"To disable or enable this display, call {disableFunction} or {enableFunction} and re-run the cell",values:{disableFunction:(0,o.Y)("code",{children:"mlflow.tracing.disable_notebook_display()"}),enableFunction:(0,o.Y)("code",{children:"mlflow.tracing.enable_notebook_display()"})}})}),(0,o.Y)(rD.o.Link,{componentId:"mlflow.notebook.trace-ui-learn-more-link",href:"https://mlflow.org/docs/latest/llms/tracing/index.html?ref=jupyter-notebook-widget",openInNewTab:!0,title:"Learn More",children:(0,o.Y)(c.sA,{id:"uIY1qq",defaultMessage:"Learn More"})})]}),(0,o.Y)(rD.o.Link,{componentId:"mlflow.notebook.trace-ui-see-in-mlflow-link",href:i6(e[t],r[t]),openInNewTab:!0,title:"View in MLflow UI",children:(0,o.Y)(c.sA,{id:"4NyhOm",defaultMessage:"View in MLflow UI"})})]}),e.length>1&&(0,o.Y)(i3.dK,{componentId:"mlflow.notebook.pagination",currentPageIndex:t+1,dangerouslySetAntdProps:{showQuickJumper:!0},numTotal:e.length,onChange:e=>n(e-1),pageSize:1,style:{marginBottom:m.spacing.sm,paddingLeft:m.spacing.sm,paddingRight:m.spacing.sm}}),(0,o.Y)("div",{css:{flex:1,overflow:"hidden"},children:(0,o.Y)(i2,{modelTrace:a})})]})};var i8=t(61056),ae=function(e){return e[e.FORM_FEEDBACK=0]="FORM_FEEDBACK",e[e.FORM_ERROR_REPORT=1]="FORM_ERROR_REPORT",e[e.METADATA=2]="METADATA",e}({});let ar=(0,nv.fH)("Feedback::OpenDrawer"),at=e=>{let r=e||ar,[t,n]=(0,i.useState)(r.isAvailable());return(0,i.useEffect)(()=>{let e;if(t)return;r.isAvailable()&&n(!0);let o=500,i=()=>{r.isAvailable()?n(!0):((o*=2)>5e3&&(o=5e3),e=setTimeout(i,o))};return e=setTimeout(i,o),()=>clearTimeout(e)},[t,r]),t};function an(e){let{"aria-describedby":r,debugRpc:t,mode:n=ae.FORM_FEEDBACK,...i}=e;if(!at(t))return null;return(0,o.Y)(rO.$n,{componentId:"codegen_web-shared_src_fastfeedback_components_feedbacklink.tsx_54","aria-describedby":r,type:"link",icon:(0,o.Y)(i8.A,{}),onClick:()=>{(t||ar).call({...i,mode:n})},children:n===ae.FORM_ERROR_REPORT?(0,o.Y)(c.sA,{id:"URIk/E",defaultMessage:"Report error"}):(0,o.Y)(c.sA,{id:"W96Xb9",defaultMessage:"Send feedback"})})}var ao=function(e){return e.Ready="READY",e.LogError="LOG_ERROR",e.LogEvent="LOG_EVENT",e}({}),ai=function(e){return e.UpdateTrace="UPDATE_TRACE",e}({});let aa=JSON.parse('{"2":{"path":"/static/lib/ml-model-trace-renderer/2/index.html","commit":"a889743f4cb04a8134c72c5812ce564f30a7adeb"},"3":{"path":"/static/lib/ml-model-trace-renderer/3/index.html","commit":"a889743f4cb04a8134c72c5812ce564f30a7adeb"},"current":{"path":"/static/lib/ml-model-trace-renderer/index.html"},"oss":{"path":"/static/lib/ml-model-trace-renderer/oss/index.html","commit":"b5595f5c6263c1c8e3614d85eb1d233d28789bb9"}}'),as=e=>{var r,t,n,o,i;if(ez(null==e?void 0:e.info))return null!=(o=eQ(null==e||null==(n=e.info)?void 0:n.trace_metadata))?o:"2";let a=eQ(null==e||null==(r=e.info)?void 0:r.request_metadata);if(a)return a;return null!=(i=eQ(null==e||null==(t=e.info)?void 0:t.tags))?i:"2"},al=e=>{var r,t;let{modelTrace:n,height:l=700,useLatestVersion:c=!1}=e,d=(0,i.useRef)(null),[u,p]=a().useState(!0),[g,h]=a().useState(!0),v=null!=(t=null==(r=aa[c?"current":as(n)])?void 0:r.path)?t:aa["2"].path,y=V(),b=en(),{startInteraction:x}=function(){let{esComponent:e,errorBoundaryId:r}=E(),{mergeTags:t}=H(),n=(0,i.useContext)(ei),o=ea();return(0,i.useMemo)(()=>({...n,startInteraction:(i,a,s,l)=>{let c=t({errorBoundaryId:r},{...l,esComponent:e});return n.startInteraction(i,a,s,c,{useRecordProtoFn:o})}}),[e,n,t,r,o])}(),{theme:S}=(0,s.wn)(),T=B({recordEvent:y,recordProto:b,startInteraction:x});return(0,i.useEffect)(()=>{let e=e=>{var r;let t=null==(r=d.current)?void 0:r.contentWindow;if(!t||e.source!==t)return;switch(e.data.type){case ao.Ready:p(!1);break;case ao.LogError:{let{error:r}=e.data||{};m.iT.sev2(f.Es.MlExperiments,"ModelTraceExplorerFrameRenderer/Error",r);break}case ao.LogEvent:{let r=e.data.payload.eventDefaultPrevented;T({...e.data.payload,skip:r})}}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[T]),(0,i.useEffect)(()=>{var e;let r=null==(e=d.current)?void 0:e.contentWindow;if(!r||u)return;r.postMessage({type:ai.UpdateTrace,traceData:n})},[n,u]),(0,o.FD)("div",{css:{height:g?l:36,borderTop:`1px solid ${S.colors.border}`},children:[(0,o.FD)("div",{css:{display:"flex",height:36,justifyContent:"space-between",padding:S.spacing.sm},children:[(0,o.FD)("div",{css:{display:"flex",alignItems:"center",gap:S.spacing.sm},children:[(0,o.Y)(rO.$n,{componentId:`mlflow.notebook.trace-ui-${g?"collapse":"expand"}`,icon:g?(0,o.Y)(rL.A,{}):(0,o.Y)(t$.A,{}),size:"small",onClick:()=>h(!g)}),(0,o.Y)(rD.o.Title,{level:4,withoutMargins:!0,children:"MLflow Trace UI"}),(0,o.Y)(rD.o.Link,{componentId:"mlflow.notebook.trace-ui-learn-more-link",href:"https://mlflow.org/docs/latest/llms/tracing/index.html",openInNewTab:!0,title:"Learn More",children:"Learn More"})]}),(0,o.Y)(an,{parentUi:f.Es.MlFlowOSS,origin:"mlflow-notebook-trace-ui"})]}),u&&(0,o.Y)("div",{css:{position:"absolute",width:"100%",height:l},children:(0,o.Y)(i2.Skeleton,{label:"Frame Skeleton"})}),(0,o.Y)("iframe",{title:"Model Trace Explorer",src:v,ref:d,css:{border:"none",width:"100%",height:"calc(100% - 36px)",display:g?"block":"none"}})]})},ac=(0,i.createContext)({onSelectRow:()=>{}}),ad=()=>(0,i.useContext)(ac),au=e=>{if((0,Z.isNil)(e))return null;if(e0(e))return e;try{var r;let t=null==(r=e.spans)?void 0:r.map(e=>({...e,attributes:JSON.parse(e.attributes)}));if((0,Z.isNil)(t))return null;return{data:{spans:t},info:{}}}catch(e){return null}},ap=e=>{let{children:r}=e,[t,n]=(0,i.useState)(null),a=au(t),{theme:l}=(0,s.wn)();return(0,o.FD)(ac.Provider,{value:{onSelectRow:n},children:[r,!(0,Z.isNil)(a)&&(0,o.Y)("div",{css:{borderTop:`1px solid ${l.colors.border}`},children:(0,o.Y)(al,{modelTrace:a})})]})}}}]);
//# sourceMappingURL=https://sourcemaps.dev.databricks.com/ml-model-trace-renderer/js/234.ae961a64.chunk.js.map